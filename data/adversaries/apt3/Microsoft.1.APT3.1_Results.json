{
    "PublicRelease": "\u00a92019 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 18-4019 ",
    "Techniques": [
        {
            "TechniqueId": "T1071",
            "TechniqueName": "Standard Application Layer Protocol",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "6.B.1",
                    "Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure, though telemetry showed a connection to port 80 (no detection showed HTTP specifically).",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-2.png",
                                    "ScreenshotCaption": "Alert\u00a0for C2 domain indicator of compromise"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"
                                },
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.B.1",
                    "Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over an encrypted channel (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert showed decoded command-line arguments to perform HTTPS connection to C2 domain.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-2.png",
                                    "ScreenshotCaption": "Alert\u00a0for C2 domain indicator of compromise"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"
                                },
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query)"
                                }
                            ]
                        },
                        {
                            "Note": "An Indicator of Compromise alert was generated on the C2 domain.[MS12]",
                            "Category": "Indicator of Compromise",
                            "Modifiers": [
                                "Configuration Change"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-2.png",
                                    "ScreenshotCaption": "Alert\u00a0for C2 domain indicator of compromise"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"
                                },
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query)"
                                }
                            ],
                            "Footnotes": [
                                " Vendor added detection for evaluation C2 domain using the standard customer-facing custom detection capabilities of the product."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.A.1",
                    "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed a decoded PowerShell script invoked that created a web request to the C2 server with related data showing the connection was made (tainted by alert on suspicious PowerShell command-line arguments).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-2.png",
                                    "ScreenshotCaption": "Alert\u00a0for C2 domain indicator of compromise"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"
                                },
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "1.C.1",
                    "Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry from showed DNS requests to freegoogleadsenseinfo.com (C2 domain).[MS3]",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Configuration Change"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-2.png",
                                    "ScreenshotCaption": "Alert\u00a0for C2 domain indicator of compromise"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"
                                },
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query)"
                                }
                            ],
                            "Footnotes": [
                                "The vendor stated that DNS telemetry is captured but it was not immediately visible in the portal. The vendor made changes to the portal during the test to enable by default the visibility of these events."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1088",
            "TechniqueName": "Bypass User Account Control",
            "Tactics": [
                {
                    "TacticName": "Privilege Escalation",
                    "TacticId": "TA0004"
                }
            ],
            "Steps": [
                {
                    "SubStep": "14.A.1",
                    "Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of powershell.exe executing \"Invoke-BypassUACTokenManipulation\" Empire cmdlet under the context of user Bob with medium integrity level, execution of svchost.exe with seclogon flag to use impersonation service with new high integrity powershell.exe process as SYSTEM, and subsequent context adjustment of powershell.exe to user Bob (tainted by the parent alert for suspicious sequence of exploration activities).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-14.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing high integrity powershell.exe process as SYSTEM"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing high integrity powershell.exe process as Bob"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-5.png",
                                    "ScreenshotCaption": "Parent alert for \\\"Suspicious sequence of exploration activities\\\" showing powershell.exe process tainting this event"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing medium integrity powershell.exe process executing Invoke-BypassUACTokenManipulation as user Bob"
                                },
                                {
                                    "ScreenshotName": "MS-3.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing rundll32.exe running as medium integrity as user Debbie"
                                },
                                {
                                    "ScreenshotName": "MS-3.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe running as high integrity as SYSTEM"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "3.A.1",
                    "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed rundll32.exe as a medium integrity process as user Debbie and subsequent execution of powershell.exe as a high integrity process as SYSTEM as part of the UAC bypass (tainted by alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-14.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing high integrity powershell.exe process as SYSTEM"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing high integrity powershell.exe process as Bob"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-5.png",
                                    "ScreenshotCaption": "Parent alert for \\\"Suspicious sequence of exploration activities\\\" showing powershell.exe process tainting this event"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing medium integrity powershell.exe process executing Invoke-BypassUACTokenManipulation as user Bob"
                                },
                                {
                                    "ScreenshotName": "MS-3.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing rundll32.exe running as medium integrity as user Debbie"
                                },
                                {
                                    "ScreenshotName": "MS-3.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe running as high integrity as SYSTEM"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1136",
            "TechniqueName": "Create Account",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.A.1",
                    "Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed data for account Jesse creation after configuration change to enable collection of event ID 4720.[MS7]",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Configuration Change"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-7.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing creation of user account Jesse"
                                }
                            ],
                            "Footnotes": [
                                " Visibility of account creation data was verified in retesting at the end of the evaluation after vendor adjusted data collection configuration and visibility of account creation."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1078",
            "TechniqueName": "Valid Accounts",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "10.B.1",
                    "Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the new local user account Jesse logging into Conficker.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.D.1-2.png",
                                    "ScreenshotCaption": "Telemetry from query showing successful Kmitnick logon event for Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing user Kmitnick login activity on 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing 10.0.1.5 (CodeRed) system accessed resources on 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-10.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing local user account Jesse first and last seen logons on Conficker"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.D.1",
                    "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ on 10.0.0.4 (Creeper) using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed that the logon event for Kmitnick on Creeper was successful.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.D.1-2.png",
                                    "ScreenshotCaption": "Telemetry from query showing successful Kmitnick logon event for Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing user Kmitnick login activity on 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing 10.0.1.5 (CodeRed) system accessed resources on 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-10.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing local user account Jesse first and last seen logons on Conficker"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.B.1",
                    "Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed a logon attempt via net.exe with command-line arguments to connect using the valid credentials of user Kmitnick (tainted by parent alert on PowerShell script with suspicious content). Telemetry showed Kmitnick login event on 10.0.0.5 (Conficker) and that 10.0.1.5 (CodeRed) accessed resources on 10.0.0.5 (Conficker).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.D.1-2.png",
                                    "ScreenshotCaption": "Telemetry from query showing successful Kmitnick logon event for Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing user Kmitnick login activity on 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing 10.0.1.5 (CodeRed) system accessed resources on 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-10.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing local user account Jesse first and last seen logons on Conficker"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1056",
            "TechniqueName": "Input Capture",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.C.1",
                    "Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed Specific Behavior alert was generated on \"Possible keylogging activity\" against explorer.exe.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-8.C.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing explorer.exe reading user keystrokes"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Possible keylogging activity\\\" against explorer.exe"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing keylogger events"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of Get-Keystrokes cmdlet"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-5.png",
                                    "ScreenshotCaption": "Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert for keylogging activity from powershell.exe"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed events indicating \"explorer.exe is reading user keystrokes.\"",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Configuration Change"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-8.C.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing explorer.exe reading user keystrokes"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Possible keylogging activity\\\" against explorer.exe"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing keylogger events"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of Get-Keystrokes cmdlet"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-5.png",
                                    "ScreenshotCaption": "Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert for keylogging activity from powershell.exe"
                                }
                            ],
                            "Footnotes": [
                                "The vendor stated that Input Capture telemetry is captured but it was not immediately visible in the user portal. The vendor made changes to the portal during the test to enable the visibility of these events.",
                                "Telemetry also showed cmd.exe injecting into explorer.exe to facilitate the keylogging, but this did not identify input capture specifically so was not counted as a detection."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "15.A.1",
                    "Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed powershell.exe making API calls consistent with keylogger behavior. Telemetry also showed execution of Get-Keystrokes Empire PowerShell cmdlet (tainted by alert on PowerShell script with suspicious content).[MS15]",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-8.C.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing explorer.exe reading user keystrokes"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Possible keylogging activity\\\" against explorer.exe"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing keylogger events"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of Get-Keystrokes cmdlet"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-5.png",
                                    "ScreenshotCaption": "Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert for keylogging activity from powershell.exe"
                                }
                            ],
                            "Footnotes": [
                                " Vendor stated that Input Capture telemetry is captured but it was not immediately visible in the portal. Vendor made changes to the portal during the test to enable by default the visibility of these events."
                            ]
                        },
                        {
                            "Note": "A delayed Specific Behavior alert was generated on keylogging activity in powershell.exe.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-8.C.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing explorer.exe reading user keystrokes"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing cmd.exe injecting into explorer.exe (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-8.C.1-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Possible keylogging activity\\\" against explorer.exe"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing keylogger events"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of Get-Keystrokes cmdlet"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-5.png",
                                    "ScreenshotCaption": "Parent alert showing process tree view showing tainted relationship (specific instance of this technique not shown in the alert)"
                                },
                                {
                                    "ScreenshotName": "MS-15.A.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert for keylogging activity from powershell.exe"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1059",
            "TechniqueName": "Command-Line Interface",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "16.F.1",
                    "Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00ef\u00bf\u00bd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed cmd.exe executing autoupdate.vbs via wscript.exe as user Kmitnick. The execution generated three new PowerShell related alerts for the initial execution sequence of Empire that tainted this event, but were not counted as separate detections for this technique.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.D.1-3.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell with suspicious command-line tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-5.png",
                                    "ScreenshotCaption": "Parent alert for malicious PowerShell cmdlet tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing cmd.exe executing autoupdate.vbs as user Kmitnick (tainted by parent PowerShell alerts)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1069",
            "TechniqueName": "Permission Groups Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.E.1.2",
                    "Procedure": "Empire: WinEnum module included enumeration of AD group memberships",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.F.1",
                    "Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.F.2",
                    "Procedure": "Cobalt Strike: 'net localgroup administrators -domain' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.F.3",
                    "Procedure": "Cobalt Strike: 'net group \"Domain Admins\" -domain' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.F.1",
                    "Procedure": "Empire: 'net group \"Domain Admins\" -domain' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.F.2",
                    "Procedure": "Empire: 'net\u00ef\u00bf\u00bdlocalgroup\u00ef\u00bf\u00bdadministrators' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-2.png",
                                    "ScreenshotCaption": "Telemetry showing domain admins group discovery by Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.3-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.F.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1032",
            "TechniqueName": "Standard Cryptographic Protocol",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "11.B.1",
                    "Procedure": "Empire: Encrypted C2 channel established using HTTPS",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over an encrypted channel (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert showed decoded command-line arguments to perform HTTPS connection to C2 domain.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server) over an encrypted channel"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing HTTPS"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1016",
            "TechniqueName": "System Network Configuration Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.A.1",
                    "Procedure": "Empire: 'route print' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing route.exe with command-line arguments. The telemetry was tainted by previous \"Suspicious sequence of exploration activities\" and suspicious PowerShell cmdlet alerts.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.A.2",
                    "Procedure": "Empire: 'ipconfig -all' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing ipconfig.exe with command-line arguments. The telemetry was tainted by previous \"Suspicious sequence of exploration activities\" and suspicious PowerShell cmdlet alerts.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.A.1",
                    "Procedure": "Cobalt Strike: 'ipconfig -all' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration commands that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing ipconfig.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.A.2",
                    "Procedure": "Cobalt Strike: 'arp -a' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing arp.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.11",
                    "Procedure": "Empire: WinEnum module included enumeration of network adapters",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed invocation of the PowerShell cmdlet Get-NetInfo.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.B.1",
                    "Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing netsh.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for arp.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing arp.exe"
                                },
                                {
                                    "ScreenshotName": "MS-4.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netsh.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netsh.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing route.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for ipconfig.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1035",
            "TechniqueName": "Service Execution",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "16.L.1",
                    "Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry from CodeRed showed the sc.exe remote service start to execute the AdobeUpdater service on Creeper (tainted by parent alert on PowerShell script with suspicious content). Telemetry from Creeper showed the execution sequence of Empire and command and control connections.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.L.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)"
                                },
                                {
                                    "ScreenshotName": "MS-16.L.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.L.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper"
                                }
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated for a successful AdobeUpdater remote service execution attempt on Creeper.",
                            "Category": "Specific Behavior",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.L.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing service execution on Creeper and new Empire connection to www.freegoogleadsenseinfo.com (C2 domain) (C2 alert rule for BORON domain was added by the vendor earlier in Step 11)"
                                },
                                {
                                    "ScreenshotName": "MS-16.L.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing successful remote AdobeUpdater service execution attempt from CodeRed to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.L.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service start for AdobeUpdater on Creeper"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1015",
            "TechniqueName": "Accessibility Features",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "17.C.1",
                    "Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed powershell.exe overwriting magnify.exe with the new file containing the same hash for cmd.exe. Reputation metadata confirms magnify.exe is cmd.exe under the file names observed.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-17.C.1-2.png",
                                    "ScreenshotCaption": "Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing overwrite of magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing sequence of magnify.exe executing from utilman.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack of magnify.exe"
                                }
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated for overwrite of magnify.exe indicating a sticky keys binary hijack for persistence was detected.",
                            "Category": "Specific Behavior",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-17.C.1-2.png",
                                    "ScreenshotCaption": "Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing overwrite of magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing sequence of magnify.exe executing from utilman.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack of magnify.exe"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "20.A.1",
                    "Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of magnify.exe from utilman.exe.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-17.C.1-2.png",
                                    "ScreenshotCaption": "Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing overwrite of magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing sequence of magnify.exe executing from utilman.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack of magnify.exe"
                                }
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated on a successful sticky keys binary hijack because magnify.exe was executing as cmd.exe.",
                            "Category": "Specific Behavior",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-17.C.1-2.png",
                                    "ScreenshotCaption": "Binary metadata and reputation information showing magnify.exe is cmd.exe due to names observed and common hash"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing overwrite of magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack for persistence when magnify.exe was overwritten"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing sequence of magnify.exe executing from utilman.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Specific Behavior alert on sticky keys binary hijack of magnify.exe"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1010",
            "TechniqueName": "Application Window Discovery",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.C.1",
                    "Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                },
                {
                    "SubStep": "15.A.1",
                    "Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1018",
            "TechniqueName": "Remote System Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "13.A.1",
                    "Procedure": "Empire: 'net group \"Domain Computers\" -domain' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of net.exe with command-line arguments (tainted by parent PowerShell malicious cmdlet alert).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.A.1",
                    "Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" -domain' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.A.2",
                    "Procedure": "Cobalt Strike: 'net group \"Domain Computers\" -domain' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific net.exe command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1007",
            "TechniqueName": "System Service Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.D.1",
                    "Procedure": "Empire: 'net start' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a previous suspicious PowerShell cmdlet alert.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.D.1",
                    "Procedure": "Cobalt Strike: 'sc query' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing sc.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.D.2",
                    "Procedure": "Cobalt Strike: 'net start' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing net.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.8",
                    "Procedure": "Empire: WinEnum module included enumeration of services",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed invocation of the PowerShell cmdlet Get-Service.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.H.1",
                    "Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry from CodeRed showed sc.exe command remotely querying services on Creeper (tainted by parent alert on PowerShell script with suspicious content).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.J.1",
                    "Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry from CodeRed showed sc.exe remote service query on Creeper for the AdobeUpdater service (tainted by parent alert on PowerShell script with suspicious content).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "17.A.1",
                    "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed reg.exe executing with command-line arguments indicating a check to see if terminal services was enabled (tainted by prior alert on suspicious PowerShell command-line).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert description for \\\"Suspicious sequence of discovery activities\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-2.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of discovery activities\\\" alert context with net.exe command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-Service invocation"
                                },
                                {
                                    "ScreenshotName": "MS-16.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query to Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.J.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe service query for AdobeUpdater on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe query for terminal server setting"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for sc.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing sc.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.D.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1033",
            "TechniqueName": "System Owner/User Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "20.B.1",
                    "Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed whoami.exe executing from magnify.exe (tainted by sticky keys binary hijack alert).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing whoami.exe executing from magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-5.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command"
                                },
                                {
                                    "ScreenshotName": "MS-2.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for echo with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.B.1",
                    "Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing echo with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing whoami.exe executing from magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-5.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command"
                                },
                                {
                                    "ScreenshotName": "MS-2.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for echo with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.B.1",
                    "Procedure": "Empire: 'whoami -all -fo list' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing whoami.exe with command-line arguments. The telemetry was tainted by previous \\\"Suspicious sequence of exploration activities\\\" and suspicious PowerShell cmdlet alerts.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing whoami.exe executing from magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-5.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command"
                                },
                                {
                                    "ScreenshotName": "MS-2.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for echo with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.1",
                    "Procedure": "Empire: WinEnum module included enumeration of user information",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-20.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of sticky keys binary hijack alert showing tainted relationship to whoami.exe"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing whoami.exe executing from magnify.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing whoami.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-5.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing echo command"
                                },
                                {
                                    "ScreenshotName": "MS-2.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for echo with command-line arguments"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1201",
            "TechniqueName": "Password Policy Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.E.1.3",
                    "Procedure": "Empire: WinEnum module included enumeration of password policy information",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1053",
            "TechniqueName": "Scheduled Task",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "10.A.2",
                    "Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\\"-k netsvcs -p -s Schedule\\\".",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-7.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"
                                },
                                {
                                    "ScreenshotName": "MS-7.C.1-2.png",
                                    "ScreenshotCaption": "Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task"
                                },
                                {
                                    "ScreenshotName": "MS-10.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "7.C.1",
                    "Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed Specific Behavior alert was generated on a low-reputation DLL persisting through a scheduled task.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-7.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"
                                },
                                {
                                    "ScreenshotName": "MS-7.C.1-2.png",
                                    "ScreenshotCaption": "Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task"
                                },
                                {
                                    "ScreenshotName": "MS-10.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed cmd.exe registering the \"Resume Viewer Update Checker\" scheduled task.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-7.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing schtasks.exe with command-line arguments scheduling a task for persistence"
                                },
                                {
                                    "ScreenshotName": "MS-7.C.1-2.png",
                                    "ScreenshotCaption": "Alert for low-reputation DLL persisting through rundll32.exe as a scheduled task"
                                },
                                {
                                    "ScreenshotName": "MS-10.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1048",
            "TechniqueName": "Exfiltration Over Alternative Protocol",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "19.C.1",
                    "Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution sequence for ftp.exe with command-line arguments including ftp.txt (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts). Telemetry also showed connections to 192.168.0.4 (C2 server) on ports 20 and 21 for the FTP connection.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.C.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing powreshell.exe running ftp.exe and the subsequent connection to 192.168.0.4 (C2 server) on port 21"
                                },
                                {
                                    "ScreenshotName": "MS-19.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powreshell.exe running ftp.exe and the subsequent connection to 192.168.0.4 (C2 server) on port 20"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1043",
            "TechniqueName": "Commonly Used Port",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "11.B.1",
                    "Procedure": "Empire: C2 channel established using port 443",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed powershell.exe checking an SSL certificate and then communicating to 192.168.0.5 (C2 server) over port 443 (tainted by relationship to alert on PowerShell script with suspicious content). Telemetry within an alert also showed decoded command-line arguments containing port 443.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for rundll32.exe opening network connection"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-2.png",
                                    "ScreenshotCaption": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-9.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing port 443\u00a0and tainted relationship to the powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.A.1",
                    "Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed a connection to 192.168.0.5 (C2 server) on port 8080 was made (tainted by alert on suspicious PowerShell command-line arguments).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for rundll32.exe opening network connection"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-2.png",
                                    "ScreenshotCaption": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-9.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing port 443\u00a0and tainted relationship to the powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "6.B.1",
                    "Procedure": "Cobalt Strike: C2 channel modified to use port 80",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for rundll32.exe opening a connection to 192.186.0.4 (C2 server) over port 80. The telemetry was tainted by the relationship to the previous alert on unexpected behavior originating from rundll32.exe.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for rundll32.exe opening network connection"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-2.png",
                                    "ScreenshotCaption": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-9.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing port 443\u00a0and tainted relationship to the powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "1.C.1",
                    "Procedure": "Cobalt Strike: C2 channel established using port 53",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.[MS99]",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-1.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing DNS requests to the C2 domain (custom query) (does not count as a detection)"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for rundll32.exe opening network connection"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-2.png",
                                    "ScreenshotCaption": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-9.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating over TCP port 443"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe communicating to 192.168.0.5 (C2 server)"
                                },
                                {
                                    "ScreenshotName": "MS-11.B.1-4.png",
                                    "ScreenshotCaption": "Telemetry within alert showing decoded command-line arguments containing port 443\u00a0and tainted relationship to the powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "DNS requests were observed (no detection showed port 53 specifically)."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1050",
            "TechniqueName": "New Service",
            "Tactics": [
                {
                    "TacticName": "Privilege Escalation",
                    "TacticId": "TA0004"
                }
            ],
            "Steps": [
                {
                    "SubStep": "16.I.1",
                    "Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "A Specific Behavior alert was generated for the suspicious service registration of AdobeUpdater.",
                            "Category": "Specific Behavior",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.I.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing AdobeUpdater service registry information that was changed on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.I.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.I.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert on suspicious service registration on Creeper"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry from CodeRed showed sc.exe execution to remotely create the AdobeUpdater service with a binPath set to run cmd.exe with an argument to execute update.vbs on Creeper (tainted by parent alert on PowerShell script with suspicious content). Telemetry from Creeper shows the registry keys that were changed to add the new service",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.I.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing AdobeUpdater service registry information that was changed on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-16.I.1-1.png",
                                    "ScreenshotCaption": "Telemetry from CodeRed showing execution sequence of sc.exe AdobeUpdater remote service creation"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.I.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert on suspicious service registration on Creeper"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1026",
            "TechniqueName": "Multiband Communication",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "6.B.1",
                    "Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed an execution sequence for rundll32.exe opening a connection to 192.168.0.4 (C2 server) over port 80, and prior activity showed DNS traffic to the same C2 IP address, which could indicate multiband communication. The port 80 telemetry was tainted by the relationship to the previous alert on unexpected behavior originating from rundll32.exe.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-6.B.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing DNS traffic to C2 domain"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-2.png",
                                    "ScreenshotCaption": "Incident graph from \\\"Unexpected process behavior\\\" alert (resulting from rundll32.exe) showing tainted network connection"
                                },
                                {
                                    "ScreenshotName": "MS-6.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for rundll32.exe opening port 80 network connection"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1055",
            "TechniqueName": "Process Injection",
            "Tactics": [
                {
                    "TacticName": "Privilege Escalation",
                    "TacticId": "TA0004"
                }
            ],
            "Steps": [
                {
                    "SubStep": "5.A.1",
                    "Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed svchost.exe accessing lsass.exe and dumping credentials (tainted by parent alert on sensitive credential memory read for the first credential dump). Exploit Guard audited process open and credential extraction event.[MS30]",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-8.D.1-2.png",
                                    "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-1.png",
                                    "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                }
                            ],
                            "Footnotes": [
                                "Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode."
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated for process injection into lsass.exe.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-8.D.1-2.png",
                                    "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-1.png",
                                    "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "3.C.1",
                    "Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe",
                    "DetectionCategories": [
                        {
                            "Note": "The capability enriched data showing powershell.exe injecting into cmd.exe (tainted by alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).",
                            "Category": "Enrichment",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-8.D.1-2.png",
                                    "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-1.png",
                                    "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                }
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated for process injection.[MS5]",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-8.D.1-2.png",
                                    "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-1.png",
                                    "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                }
                            ],
                            "Footnotes": [
                                " Process Injection attempt was audited by Exploit Guard. Vendor states that the Exploit Guard audit events demonstrate that execution would have been prevented if Export Address Table (EAF) was enabled in blocking mode."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "5.A.2",
                    "Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe",
                    "DetectionCategories": [
                        {
                            "Note": "A Specific Behavior alert was generated for process injection into lsass.exe. The alert was rolled up under the prior lsass.exe process injection alert and the last activity seen field was updated.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-8.D.1-2.png",
                                    "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-1.png",
                                    "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed svchost.exe accessing lsass.exe and dumping credentials (tainted by parent alert on sensitive credential memory read for the first credential dump). Exploit Guard audited process open and credential extraction event.[MS30]",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-8.D.1-2.png",
                                    "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-1.png",
                                    "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                }
                            ],
                            "Footnotes": [
                                "Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "8.D.1",
                    "Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe",
                    "DetectionCategories": [
                        {
                            "Note": "The capability enriched the execution sequence for cmd.exe injecting into explorer.exe with the label \\\"Inject to process.\\\"",
                            "Category": "Enrichment",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on prior credential dump tainting svchost.exe process (process with syringe indicating process injection) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-8.D.1-2.png",
                                    "ScreenshotCaption": "Enrichment of execution sequence showing cmd.exe injecting into explorer.exe (labeled \\\"Inject to process\\\")"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe (subsequent powershell.exe is the injecting process)"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-1.png",
                                    "ScreenshotCaption": "Enrichment of powershell.exe injecting into cmd.exe"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-3.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing powershell.exe process injection"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing process injection activity audited by Exploit Guard"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Alert on credential dump showing injecting svchost.exe process (process with syringe) that was used to access lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert for process injection into lsass.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe accessing and extracting credentials from lsass.exe"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1083",
            "TechniqueName": "File and Directory Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.E.1.4.1",
                    "Procedure": "Empire: WinEnum module included enumeration of recently opened files",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.A.1-1.png",
                                    "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.4.2",
                    "Procedure": "Empire: WinEnum module included enumeration of interesting files",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.A.1-1.png",
                                    "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "8.A.1",
                    "Procedure": "Cobalt Strike: 'dir -s -b \"\\\\conficker\\wormshare\"' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for cmd.exe executing dir with command-line arguments. The telemetry was tainted by a prior alert on rundll32.exe being executed without command-line arguments.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.A.1-1.png",
                                    "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "8.A.2",
                    "Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for cmd.exe executing tree.com with command-line arguments. The telemetry was tainted by a prior alert on rundll32.exe being executed without command-line arguments.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.A.1-1.png",
                                    "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.K.1",
                    "Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.A.1-1.png",
                                    "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.A.1",
                    "Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.A.1-1.png",
                                    "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "18.A.1",
                    "Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the decoded PowerShell script that was executed to recursively search for .vsdx files on Conficker's remote file share.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.A.1-1.png",
                                    "ScreenshotCaption": "Query showing .vsdx PowerShell file search script that was executed"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing dir with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted tree (tree command not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of cmd.exe executing tree.com with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-8.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of rundll32.exe \\\"Unexpected behavior from process run with no command-line arguments\\\" alert that tainted dir (dir command not shown)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1132",
            "TechniqueName": "Data Encoding",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.C.1",
                    "Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1049",
            "TechniqueName": "System Network Connections Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "13.B.1",
                    "Procedure": "Empire: 'net use' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of net.exe with command-line arguments (tainted by parent PowerShell malicious cmdlet alert).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.B.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-4.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.B.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-4.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "13.B.2",
                    "Procedure": "Empire: 'netstat -ano' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.B.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-4.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.B.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-4.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.12",
                    "Procedure": "Empire: WinEnum module included enumeration of established network connections",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed invocation of the PowerShell cmdlet Get-NetInfo and subsequent execution of netstat.exe with command-line arguments from powershell.exe. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.B.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-4.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.B.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-4.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "4.C.1",
                    "Procedure": "Cobalt Strike: 'netstat -ano' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing netstat.exe with command-line arguments (tainted by the alert on suspicious process injection alert association with rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-13.B.2-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific netstat.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of netstat.exe (tainted by parent PowerShell malicious cmdlet alert)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.A.1-3.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-13.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-NetInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-4.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for netstat.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-4.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of prior suspicious process injection alert showing tainted powershell.exe child cmd.exe process performing this action (specific netstat.exe command not shown)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1012",
            "TechniqueName": "Query Registry",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "6.A.1",
                    "Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of reg.exe executing with command-line arguments. The telemetry was tainted by the relationship to prior rundll32.exe activity based on process injection alert context.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.H.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.7",
                    "Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.H.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.H.1",
                    "Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running reg.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.H.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "17.A.1",
                    "Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed reg.exe executing with command-line arguments (tainted by prior alert on suspicious PowerShell command line).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.H.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "13.C.1",
                    "Procedure": "Empire:\u00ef\u00bf\u00bd'reg query' via PowerShell to enumerate a specific Registry key",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of reg.exe with command-line arguments (tainted by suspicious sequence of exploration activities alert).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.H.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.H.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of discovery techniques (showing tainted reg.exe query command)"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for reg.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-6.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious process injection alert on lsass.exe showing tainted relationship to reg.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of reg.exe and command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-13.C.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert showing tainted relationship to reg.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing reg.exe executing with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1060",
            "TechniqueName": "Registry Run Keys / Startup Folder",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "10.A.1",
                    "Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing autoupdate.bat from the Startup folder to start update.dat.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-10.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing Startup folder execution sequence for autoupdate.bat on user logon"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing write of autoupdate.bat to startup folder"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "1.B.1",
                    "Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for Resume Viewer.exe writing autoupdate.bat to Debbie's Startup folder to establish persistence.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-10.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing Startup folder execution sequence for autoupdate.bat on user logon"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing write of autoupdate.bat to startup folder"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1105",
            "TechniqueName": "Remote File Copy",
            "Tactics": [
                {
                    "TacticName": "Command and Control",
                    "TacticId": "TA0011"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.B.1",
                    "Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed cmd.exe writing updater.dll to disk.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-7.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file write of updater.dll"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.E.1",
                    "Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed powershell.exe creating autoupdate.vbs (tainted by parent alert on PowerShell script with suspicious content).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-7.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file write of updater.dll"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.G.1",
                    "Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed creation of update.vbs on 10.0.0.4 (Creeper) and the remote file copy action from 10.0.1.5 (CodeRed) (the remote file copy event on CodeRed was tainted by parent PowerShell alerts).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-7.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file write of updater.dll"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "14.A.1",
                    "Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed network connection to 192.168.0.5 (C2 server) over port 8080 as well as decoded PowerShell making a connection over port 8080 with a HTTP request to download wdbypass payload. (tainted by alert on suspicious PowerShell command-line arguments).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-7.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file write of updater.dll"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "19.A.1",
                    "Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed powershell.exe creating recycler.exe file (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing for remote creation of update.vbs on 10.0.0.4 (Creeper) from 10.0.1.5 (CodeRed)"
                                },
                                {
                                    "ScreenshotName": "MS-16.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of update.vbs on 10.0.0.4 (Creeper)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing autoupdate.vbs creation (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing decoded PowerShell script with download HTTP request of wdbypass over port 8080 and tainted relationship to alert on suspicious PowerShell command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-14.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing network connection to 192.168.0.5 (C2 server) over port 8080"
                                },
                                {
                                    "ScreenshotName": "MS-7.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file write of updater.dll"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1003",
            "TechniqueName": "Credential Dumping",
            "Tactics": [
                {
                    "TacticName": "Credential Access",
                    "TacticId": "TA0006"
                }
            ],
            "Steps": [
                {
                    "SubStep": "5.A.2",
                    "Procedure": "Cobalt Strike: Built-in hash dump capability executed",
                    "DetectionCategories": [
                        {
                            "Note": "The capability enriched data showing a svchost.exe process opening lsass.exe with a description that it was accessing credentials (tainted by parent process injection event that occurred from svchost.exe). Exploit Guard audited the process open and credential extraction event.[MS6]",
                            "Category": "Enrichment",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Alert for process injection into lsass.exe tainting this event (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Process tree for sensitive credential memory read alert"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert description for sensitive credential memory read"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"
                                }
                            ],
                            "Footnotes": [
                                "Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode. Vendor stated that Credential Guard can also mitigate this attack if enabled."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "5.A.1",
                    "Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed",
                    "DetectionCategories": [
                        {
                            "Note": "A Specific Behavior alert was generated on credential memory access.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Alert for process injection into lsass.exe tainting this event (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Process tree for sensitive credential memory read alert"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert description for sensitive credential memory read"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"
                                }
                            ]
                        },
                        {
                            "Note": "The capability enriched data showing a svchost.exe process opening lsass.exe with a description that it was accessing credentials (tainted by parent process injection event that occurred from svchost.exe). Exploit Guard audited the process open and credential extraction event.[MS6]",
                            "Category": "Enrichment",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing svchost.exe (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-2.png",
                                    "ScreenshotCaption": "Alert for process injection into lsass.exe tainting this event (inner failure message in screenshot not relevant to tested functionality)"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.2-1.png",
                                    "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-1.png",
                                    "ScreenshotCaption": "Process tree for sensitive credential memory read alert"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert description for sensitive credential memory read"
                                },
                                {
                                    "ScreenshotName": "MS-5.A.1-3.png",
                                    "ScreenshotCaption": "Enrichment showing Exploit Guard audit of svchost.exe extracting credentials from lsass.exe"
                                }
                            ],
                            "Footnotes": [
                                "Vendor stated the Exploit Guard audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode. Vendor stated that Credential Guard can also mitigate this attack if enabled."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1061",
            "TechniqueName": "Graphical User Interface",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.A.1",
                    "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in).",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1077",
            "TechniqueName": "Windows Admin Shares",
            "Tactics": [
                {
                    "TacticName": "Credential Access",
                    "TacticId": "TA0006"
                }
            ],
            "Steps": [
                {
                    "SubStep": "16.B.1",
                    "Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00ef\u00bf\u00bd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS17]",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ],
                            "Footnotes": [
                                "The alert spans multiple login attempts."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.D.1",
                    "Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed a logon attempt via net.exe with command-line arguments targeting C$ using valid credentials for user Kmitnick (tainted by parent alert on PowerShell script with suspicious content).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.A.1",
                    "Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS16]",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ],
                            "Footnotes": [
                                "The alert spans multiple login attempts."
                            ]
                        },
                        {
                            "Note": "Telemetry showed repeated logon attempts to ADMIN$ via net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed failed authorization attempts due to bad passwords as indicated by a fallback request over WebDAV to port 80 on the C2 server, but did not indicate the two failed access attempts on Morris and Conficker that were due to the accounts having insufficient access on the systems.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to C$ on 10.0.0.4 (Creeper) with valid credentials for the account Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1082",
            "TechniqueName": "System Information Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "2.E.2",
                    "Procedure": "Cobalt Strike: 'net config workstation' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments (tainted by the alert on suspicious sequence of exploration activities from child processes of rundll32.exe).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.E.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-SysInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-HotFix invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.6.1",
                    "Procedure": "Empire: WinEnum module included enumeration of system information",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed invocation of the PowerShell cmdlet Get-SysInfo.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.E.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-SysInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-HotFix invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.6.2",
                    "Procedure": "Empire: WinEnum module included enumeration of Windows update information",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed invocation of the PowerShell cmdlet Get-HotFix.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.E.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-SysInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-HotFix invocation"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.E.1",
                    "Procedure": "Cobalt Strike: 'systeminfo' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running systeminfo.exe.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.E.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-SysInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-HotFix invocation"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.E.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing systeminfo.exe"
                                },
                                {
                                    "ScreenshotName": "MS-2.E.2-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious sequence of exploration activities alert with tainted rundll32.exe child processes showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-SysInfo invocation"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing Get-HotFix invocation"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1113",
            "TechniqueName": "Screen Capture",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "8.D.1",
                    "Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie",
                    "DetectionCategories": [
                        {
                            "Note": "The capability enriched an explorer.exe process with ScreenshotTaken.[MS31]",
                            "Category": "Enrichment",
                            "Modifiers": [
                                "Configuration Change"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-8.D.1-1.png",
                                    "ScreenshotCaption": "Enrichment of explorer.exe with ScreenshotTaken"
                                }
                            ],
                            "Footnotes": [
                                "The vendor stated that screen capture telemetry is captured but it was not immediately visible in the portal. The vendor made changes to the portal during the test to enable by default the visibility of these events, so this detection is identified as a configuration change."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1107",
            "TechniqueName": "File Deletion",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "19.D.1",
                    "Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure, though data showed execution sequence for the PowerShell \"Remove-Item\" cmdlet (no arguments were available to indicate what was deleted).",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell executing the Remove-Item cmdlet (does not count as a detection)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "19.D.2",
                    "Procedure": "Empire: 'del recycler.exe'",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.D.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell executing the Remove-Item cmdlet (does not count as a detection)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1081",
            "TechniqueName": "Credentials in Files",
            "Tactics": [
                {
                    "TacticName": "Credential Access",
                    "TacticId": "TA0006"
                }
            ],
            "Steps": [
                {
                    "SubStep": "15.B.1",
                    "Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure, though telemetry was available that showed execution of Get-Content PowerShell cmdlet. Data does not show what file the cmdlet was executed on.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-15.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing \"Get-Content\" cmdlet (does not count as a detection)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1135",
            "TechniqueName": "Network Share Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.E.1.9.1",
                    "Procedure": "Empire: WinEnum module included enumeration of available shares",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.9.2",
                    "Procedure": "Empire: WinEnum module included enumeration of mapped network drives",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1039",
            "TechniqueName": "Data from Network Shared Drive",
            "Tactics": [
                {
                    "TacticName": "Exfiltration",
                    "TacticId": "TA0010"
                }
            ],
            "Steps": [
                {
                    "SubStep": "18.B.1",
                    "Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure, though data showed PowerShell Copy-Item cmdlet execution (no information available about what file is being copied or where the data is coming from).[MS50]",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.B.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)"
                                }
                            ],
                            "Footnotes": [
                                " Vendor states that by default WDATP monitors activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of test."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "9.B.1",
                    "Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.[MS32]",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.B.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)"
                                }
                            ],
                            "Footnotes": [
                                "The vendor stated that by default WDATP monitored activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of the evaluation. Subsequently, the vendor made changes to enable the visibility of .vsdx events by default, which is now available in WDATP."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1022",
            "TechniqueName": "Data Encrypted",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "19.B.1",
                    "Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution sequence for recycler.exe with WinRAR command-line arguments, including the -hp flag, for data encryption and compression (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1076",
            "TechniqueName": "Remote Desktop Protocol",
            "Tactics": [
                {
                    "TacticName": "Lateral Movement",
                    "TacticId": "TA0008"
                }
            ],
            "Steps": [
                {
                    "SubStep": "6.C.1",
                    "Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for cmd.exe establishing an outbound RDP connection over port 3389 to 10.0.0.5 (Conficker). Logon activity over the last 30 days on Conficker shows George with a logon type 10 RemoteInteractive logon event. Telemetry also showed George logged into Conficker and displayed a movement graph of activity from user account Debbie to George.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-6.C.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing user logon activity on 10.0.0.5 (Conficker) showing George with a logon type 10 RemoteInteractive logon event"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for cmd.exe connection over RDP to 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence on 10.0.0.5 (Conficker) showing George logon"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-4.png",
                                    "ScreenshotCaption": "Graph showing movement from Debbie account to George"
                                },
                                {
                                    "ScreenshotName": "MS-10.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing successful port 3389 connection to Conficker (10.0.0.5)"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe starting terminal service session on Creeper from CodeRed (10.0.1.5)"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing Kmitnick RDP logon from CodeRed to Creeper"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "10.B.1",
                    "Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed\u00a0a successful connection to Conficker (10.0.0.5) over port 3389 from rundll32.exe.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-6.C.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing user logon activity on 10.0.0.5 (Conficker) showing George with a logon type 10 RemoteInteractive logon event"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for cmd.exe connection over RDP to 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence on 10.0.0.5 (Conficker) showing George logon"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-4.png",
                                    "ScreenshotCaption": "Graph showing movement from Debbie account to George"
                                },
                                {
                                    "ScreenshotName": "MS-10.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing successful port 3389 connection to Conficker (10.0.0.5)"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe starting terminal service session on Creeper from CodeRed (10.0.1.5)"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing Kmitnick RDP logon from CodeRed to Creeper"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "20.A.1",
                    "Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed creation of a terminal services session on Creeper from CodeRed with corresponding logon by Kmitnick.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-6.C.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing user logon activity on 10.0.0.5 (Conficker) showing George with a logon type 10 RemoteInteractive logon event"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for cmd.exe connection over RDP to 10.0.0.5 (Conficker)"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence on 10.0.0.5 (Conficker) showing George logon"
                                },
                                {
                                    "ScreenshotName": "MS-6.C.1-4.png",
                                    "ScreenshotCaption": "Graph showing movement from Debbie account to George"
                                },
                                {
                                    "ScreenshotName": "MS-10.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing successful port 3389 connection to Conficker (10.0.0.5)"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe starting terminal service session on Creeper from CodeRed (10.0.1.5)"
                                },
                                {
                                    "ScreenshotName": "MS-20.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing Kmitnick RDP logon from CodeRed to Creeper"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1041",
            "TechniqueName": "Exfiltration Over Command and Control Channel",
            "Tactics": [
                {
                    "TacticName": "Exfiltration",
                    "TacticId": "TA0010"
                }
            ],
            "Steps": [
                {
                    "SubStep": "9.B.1",
                    "Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1115",
            "TechniqueName": "Clipboard Data",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.E.1.5",
                    "Procedure": "Empire: WinEnum module included enumeration of clipboard contents",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1222",
            "TechniqueName": "File and Directory Permissions Modification",
            "Tactics": [
                {
                    "TacticName": "Persistence",
                    "TacticId": "TA0003"
                }
            ],
            "Steps": [
                {
                    "SubStep": "17.B.1",
                    "Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed takeown.exe execution to change the file permissions on magnify.exe (tainted by prior alert on suspicious PowerShell command-line).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-17.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing takeown.exe execution with magnify.exe in command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to takeown.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing icacls.exe execution with magnify.exe in command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "17.B.2",
                    "Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed icacls.exe execution to change permissions on magnify.exe granting discretionary access to SYSTEM (tainted by prior alert on suspicious PowerShell command-line).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-17.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing takeown.exe execution with magnify.exe in command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to takeown.exe"
                                },
                                {
                                    "ScreenshotName": "MS-17.B.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing icacls.exe execution with magnify.exe in command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-17.A.1-2.png",
                                    "ScreenshotCaption": "Process tree view of suspicious PowerShell command-line alert showing tainted relationship to reg.exe query"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1134",
            "TechniqueName": "Access Token Manipulation",
            "Tactics": [
                {
                    "TacticName": "Privilege Escalation",
                    "TacticId": "TA0004"
                }
            ],
            "Steps": [
                {
                    "SubStep": "3.A.1",
                    "Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed svchost.exe executed with the seclogon command-line argument and a subsequent elevated powershell.exe process, indicating token manipulation (tainted by parent alert on a suspicious PowerShell command-line generated for the svchost.exe invocation of powershell.exe with an encoded script).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-3.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe execution with seclogon command-line argument then subsequent powershell.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe invocation with seclogon flag subsequently running cmd.exe as SYSTEM"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing resulting cmd.exe running as user George"
                                },
                                {
                                    "ScreenshotName": "MS-5.B.1-4.png",
                                    "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing subsequent cmd.exe processes (inner failure message in screenshot not relevant to tested functionality)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "5.B.1",
                    "Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed svchost.exe as a high integrity process from SYSTEM and subsequent cmd.exe process running as user George (tainted by the parent alert on suspicious process injection into lsass.exe). Svchost.exe was executed with seclogon command-line argument indicating token manipulation.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-3.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe execution with seclogon command-line argument then subsequent powershell.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing svchost.exe invocation with seclogon flag subsequently running cmd.exe as SYSTEM"
                                },
                                {
                                    "ScreenshotName": "MS-3.C.1-2.png",
                                    "ScreenshotCaption": "Alert for 'Suspicious PowerShell command-line' showing tainted association via a process tree containing svchost.exe and elevated powershell.exe"
                                },
                                {
                                    "ScreenshotName": "MS-5.B.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing resulting cmd.exe running as user George"
                                },
                                {
                                    "ScreenshotName": "MS-5.B.1-4.png",
                                    "ScreenshotCaption": "Alert for suspicious process injection showing tainted association via a process tree containing subsequent cmd.exe processes (inner failure message in screenshot not relevant to tested functionality)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1085",
            "TechniqueName": "Rundll32",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.A.1",
                    "Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert was generated for a low-reputation DLL loaded by a signed executable due to rundll32.exe execution of update.dat.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-1.A.1-13.png",
                                    "ScreenshotCaption": "General Behavior alert on low-reputation DLL load by signed executable"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-10.png",
                                    "ScreenshotCaption": "Telemetry showing rundll32.exe process injection sequence"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence for rundll32.exe running update.dat.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-1.A.1-13.png",
                                    "ScreenshotCaption": "General Behavior alert on low-reputation DLL load by signed executable"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-10.png",
                                    "ScreenshotCaption": "Telemetry showing rundll32.exe process injection sequence"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1036",
            "TechniqueName": "Masquerading",
            "Tactics": [
                {
                    "TacticName": "Privilege Escalation",
                    "TacticId": "TA0004"
                }
            ],
            "Steps": [
                {
                    "SubStep": "16.I.1",
                    "Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry from CodeRed showed sc.exe service creation command for the AdobeUpdater service with a binPath set to run update.vbs with cmd.exe on startup on Creeper (tainted by parent alert on PowerShell script with suspicious content).\u00a0Telemetry also showed the sc.exe command to set the service description, but a screenshot was not available. An analyst can use this information to determine AdobeUpdater is masquerading.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.I.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of sc.exe AdobeUpdater remote service creation"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-2.png",
                                    "ScreenshotCaption": "Binary reputation and metadata for recycler.exe showing WinRAR information"
                                },
                                {
                                    "ScreenshotName": "MS-19.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression indicating it is WinRAR"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "19.A.1",
                    "Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed file creation of recycler.exe on CodeRed. Binary reputation and metadata for recycler.exe shows hash and publisher signature as win.rar GmbH indicating the file is actually the WinRAR utility.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.I.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of sc.exe AdobeUpdater remote service creation"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-2.png",
                                    "ScreenshotCaption": "Binary reputation and metadata for recycler.exe showing WinRAR information"
                                },
                                {
                                    "ScreenshotName": "MS-19.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression indicating it is WinRAR"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "19.B.1",
                    "Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution sequence for recycler.exe with RAR command-line arguments, including the -hp flag, for data encryption and compression indicating it was actually WinRAR masquerading as a different file (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.I.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of sc.exe AdobeUpdater remote service creation"
                                },
                                {
                                    "ScreenshotName": "MS-16.D.1-4.png",
                                    "ScreenshotCaption": "Parent alert for PowerShell script with suspicious content tainting powershell.exe on CodeRed (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-2.png",
                                    "ScreenshotCaption": "Binary reputation and metadata for recycler.exe showing WinRAR information"
                                },
                                {
                                    "ScreenshotName": "MS-19.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression indicating it is WinRAR"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing file creation of recycler.exe by powershell.exe showing hash and signer information as win.rar GmbH"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1057",
            "TechniqueName": "Process Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.C.1",
                    "Procedure": "Empire: 'qprocess *' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing qprocess.exe with command-line arguments. The telemetry was tainted by previous \\\"Suspicious sequence of exploration activities\\\" and suspicious PowerShell cmdlet alerts.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.C.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-12.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.C.1",
                    "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.C.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-12.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.C.2 ",
                    "Procedure": "Cobalt Strike: 'tasklist -v' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.C.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-12.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe executing tasklist.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.C.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-12.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "8.B.1",
                    "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.C.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-12.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "3.B.1",
                    "Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-2.C.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for tasklist.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-12.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence of powershell.exe executing qprocess.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing tasklist.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of powershell.exe with malicious cmdlets alert showing tainted powershell.exe process"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1064",
            "TechniqueName": "Scripting",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.A.1",
                    "Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry within a process tree showed the child cmd.exe process running the script pdfhelper.cmd.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.A.1-8.png",
                                    "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-7.png",
                                    "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-6.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution of wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "11.A.1",
                    "Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed Specific Behavior alert was generated for suspicious PowerShell command-line arguments.",
                            "Category": "Specific Behavior",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.A.1-8.png",
                                    "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-7.png",
                                    "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-6.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution of wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed explorer.exe running autoupdate.vbs through wscript.exe and subsequent execution of PowerShell script and cmdlets.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.A.1-8.png",
                                    "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-7.png",
                                    "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-6.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution of wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"
                                }
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated for PowerShell script with suspicious content detected through Antimalware Scan Interface extracted content.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.A.1-8.png",
                                    "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-7.png",
                                    "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-6.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution of wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"
                                }
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated for PowerShell script with malicious cmdlets related to Empire.",
                            "Category": "Specific Behavior",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.A.1-8.png",
                                    "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-7.png",
                                    "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-6.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution of wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1",
                    "Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques",
                    "DetectionCategories": [
                        {
                            "Note": "A Specific Behavior alert was generated for \"A malicious PowerShell Cmdlet was invoked on the machine.\"",
                            "Category": "Specific Behavior",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.A.1-8.png",
                                    "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-7.png",
                                    "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-6.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution of wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"
                                }
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence from PowerShell with several activities from the WinEnum cmdlet. The telemetry was tainted by the previous \\\"Suspicious sequence of exploration activities\\\" alert.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-11.A.1-8.png",
                                    "ScreenshotCaption": "Process tree of alert showing containing malicious PowerShell cmdlets related to Empire"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-7.png",
                                    "ScreenshotCaption": "Specific Behavior alert for PowerShell script with malicious cmdlets"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-6.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"PowerShell script with suspicious content\\\" detected through Antimalware Scan Interface extracted content"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"Suspicious PowerShell command-line\\\""
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-2.png",
                                    "ScreenshotCaption": "Additional telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing powershell.exe execution sequence resulting from WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing execution of PowerShell cmdlets from wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing PowerShell script metadata and decoded command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree under alert \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\" showing Invoke-Empire and Invoke-WinEnum"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-5.png",
                                    "ScreenshotCaption": "Specific Behavior alert for \\\"A malicious PowerShell Cmdlet was invoked on the machine\\\""
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of autoupdate.vbs script"
                                },
                                {
                                    "ScreenshotName": "MS-11.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing execution of wscript.exe"
                                },
                                {
                                    "ScreenshotName": "MS-12.A.1-4.png",
                                    "ScreenshotCaption": "Process tree view of \\\"Suspicious sequence of exploration activities\\\" alert showing tainted powershell.exe process"
                                },
                                {
                                    "ScreenshotName": "MS-1.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry within the process tree showing the child cmd.exe process running the script pdfhelper.cmd"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1126",
            "TechniqueName": "Network Share Connection Removal",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "16.C.1",
                    "Procedure": "Empire: 'net use -delete' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.C.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe with command-line arguments (tainted by parent alert on PowerShell script with suspicious content)"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1087",
            "TechniqueName": "Account Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "7.A.1",
                    "Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.G.1",
                    "Procedure": "Cobalt Strike: 'net user -domain' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration commands that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "2.G.2",
                    "Procedure": "Cobalt Strike: 'net user george -domain' via cmd",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the execution sequence of cmd.exe running net.exe with command-line arguments.",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed General Behavior alert occurred due to a sequence of exploration activities that was classified as suspicious.",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.G.1",
                    "Procedure": "Empire: 'net user' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "12.G.2",
                    "Procedure": "Empire: 'net user -domain' via PowerShell",
                    "DetectionCategories": [
                        {
                            "Note": "A delayed General Behavior alert was generated for \"Suspicious sequence of exploration activities\".",
                            "Category": "General Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "Alert is based on the correlation of a chain of related behaviors across multiple steps."
                            ]
                        },
                        {
                            "Note": "A delayed Specific Behavior alert called \"Reconnaissance using directory services queries\" was generated for domain user enumeration.",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ],
                            "Footnotes": [
                                "The vendor noted this was an Azure Advanced Threat Protection alert."
                            ]
                        },
                        {
                            "Note": "Telemetry showed the execution sequence for powershell.exe executing net.exe with command-line arguments. The telemetry was tainted by a prior suspicious PowerShell cmdlet alert.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-12.G.2-2.png",
                                    "ScreenshotCaption": "Specific Behavior alert showing domain user enumeration from Bob on CodeRed against Domain Controller on Creeper"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on \\\"Suspicious sequence of exploration activities\\\" showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-12.E.1-4.png",
                                    "ScreenshotCaption": "Process tree view of PowerShell script with malicious cmdlets alert showing tainted powershell.exe process (specific net.exe instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-12.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry of execution sequence showing powershell.exe executing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-7.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing mmc.exe running lusrmgr.msc"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-2.png",
                                    "ScreenshotCaption": "Telemetry showing discovery of George permissions by Debbie from Nimda at the domain controller"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-3.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.2-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-2.png",
                                    "ScreenshotCaption": "Process tree view of General Behavior alert on suspicious sequence of exploration activities showing net.exe with command-line arguments"
                                },
                                {
                                    "ScreenshotName": "MS-2.A.1-3.png",
                                    "ScreenshotCaption": "General Behavior alert on suspicious sequence of exploration activities"
                                },
                                {
                                    "ScreenshotName": "MS-2.G.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution sequence for net.exe with command-line arguments"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1063",
            "TechniqueName": "Security Software Discovery",
            "Tactics": [
                {
                    "TacticName": "Discovery",
                    "TacticId": "TA0007"
                }
            ],
            "Steps": [
                {
                    "SubStep": "12.E.1.10.1",
                    "Procedure": "Empire: WinEnum module included enumeration of AV solutions",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                },
                {
                    "SubStep": "12.E.1.10.2",
                    "Procedure": "Empire: WinEnum module included enumeration of firewall rules",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure.",
                            "Category": "None"
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1074",
            "TechniqueName": "Data Staged",
            "Tactics": [
                {
                    "TacticName": "Collection",
                    "TacticId": "TA0009"
                }
            ],
            "Steps": [
                {
                    "SubStep": "18.B.1",
                    "Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)",
                    "DetectionCategories": [
                        {
                            "Note": "No detection capability demonstrated for this procedure, though data showed PowerShell Copy-Item cmdlet execution (no information available about what file is being copied or where the data is coming from).[MS50]",
                            "Category": "None",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-18.B.1-1.png",
                                    "ScreenshotCaption": "Execution sequence showing PowerShell Copy-Item cmdlet execution (does not count as a detection)"
                                }
                            ],
                            "Footnotes": [
                                " Vendor states that by default WDATP monitors activities around all the most used documents (doc, xls, ppt pdf, etc) at the time of test."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1110",
            "TechniqueName": "Brute Force",
            "Tactics": [
                {
                    "TacticName": "Credential Access",
                    "TacticId": "TA0006"
                }
            ],
            "Steps": [
                {
                    "SubStep": "16.B.1",
                    "Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying, eventually resulting in a successful logon (tainted by parent alert on PowerShell script with suspicious content).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-5.png",
                                    "ScreenshotCaption": "System access history from CodeRed to Nimda and Morris"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                }
                            ]
                        },
                        {
                            "Note": "A Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS17]",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-5.png",
                                    "ScreenshotCaption": "System access history from CodeRed to Nimda and Morris"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                }
                            ],
                            "Footnotes": [
                                "The alert spans multiple login attempts."
                            ]
                        }
                    ]
                },
                {
                    "SubStep": "16.A.1",
                    "Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00ef\u00bf\u00bdKmitnick, Bob, and Frieda",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed repeated logon attempts via net.exe with command-line arguments indicative of password spraying (tainted by parent alert on PowerShell script with suspicious content). Telemetry also showed failed authorization attempts due to bad passwords as indicated by a fallback request over WebDAV to port 80 on the C2 server, but did not indicate the two failed access attempts on Morris and Conficker that were due to the accounts having insufficient access on the systems.",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-5.png",
                                    "ScreenshotCaption": "System access history from CodeRed to Nimda and Morris"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                }
                            ]
                        },
                        {
                            "Note": "A delayed Specific Behavior alert was generated based on brute force attempt by accessing remote SMB shares with different accounts.[MS16]",
                            "Category": "Specific Behavior",
                            "Modifiers": [
                                "Delayed"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.4 (Morris) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.1.6 (Nimda) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-4.png",
                                    "ScreenshotCaption": "Execution sequence showing net.exe logon failure to Morris due to WebDAV fallback authentication attempt over port 80 to the C2 server"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-5.png",
                                    "ScreenshotCaption": "System access history from CodeRed to Nimda and Morris"
                                },
                                {
                                    "ScreenshotName": "MS-16.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing net.exe logon attempt to ADMIN$ on 10.0.0.5 (Conficker) with user Kmitnick (tainted by parent alert on PowerShell script with suspicious content)"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-1.png",
                                    "ScreenshotCaption": "Specific Behavior alert for brute force attempt to remote SMB shares"
                                },
                                {
                                    "ScreenshotName": "MS-16.A.1-6.png",
                                    "ScreenshotCaption": "Process tree view of alert on a PowerShell script with suspicious content showing tainted parent powershell.exe process (alert was generated on many PowerShell script executions throughout the day, specific instance of this procedure not shown in this alert)"
                                }
                            ],
                            "Footnotes": [
                                "The alert spans multiple login attempts."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1204",
            "TechniqueName": "User Execution",
            "Tactics": [
                {
                    "TacticName": "Execution",
                    "TacticId": "TA0002"
                }
            ],
            "Steps": [
                {
                    "SubStep": "1.A.1",
                    "Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed the user execution sequence of Resume Viewer.exe with multiple files written and subsequently executed.[MS1]",
                            "Category": "Telemetry",
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-1.A.1-8.png",
                                    "ScreenshotCaption": "Exploit Guard audit of Resume Viewer.exe"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-5.png",
                                    "ScreenshotCaption": "Telemetry showing execution of decoy PDF by MicrosoftPdfReader.exe"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-4.png",
                                    "ScreenshotCaption": "Telemetry showing execution of pdfhelper.cmd and update.dat"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-3.png",
                                    "ScreenshotCaption": "Telemetry showing write of autoupdate.bat"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of Resume Viewer.exe from explorer.exe and dropping pdfhelper.cmd and autoupdate.bat"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-2.png",
                                    "ScreenshotCaption": "Telemetry showing write of pdfhelper.cmd"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-7.png",
                                    "ScreenshotCaption": "Telemetry showing Resume Viewer.exe binary reputation"
                                },
                                {
                                    "ScreenshotName": "MS-1.A.1-6.png",
                                    "ScreenshotCaption": "Telemetry showing Resume Viewer.exe binary and process metadata"
                                }
                            ],
                            "Footnotes": [
                                "Resume Viewer.exe was audited by Exploit Guard and the vendor stated that the audit events demonstrate that execution would have been prevented if Attack Surface Reduction (ASR) was enabled in blocking mode."
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "TechniqueId": "T1002",
            "TechniqueName": "Data Compressed",
            "Tactics": [
                {
                    "TacticName": "Defense Evasion",
                    "TacticId": "TA0005"
                }
            ],
            "Steps": [
                {
                    "SubStep": "19.B.1",
                    "Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file",
                    "DetectionCategories": [
                        {
                            "Note": "Telemetry showed execution sequence for recycler.exe with WinRAR command-line arguments, including the -hp flag, for data encryption and compression (tainted by alert on\u00a0PowerShell script with a suspicious command-line was generated by numerous scripts).",
                            "Category": "Telemetry",
                            "Modifiers": [
                                "Tainted"
                            ],
                            "Screenshots": [
                                {
                                    "ScreenshotName": "MS-19.A.1-3.png",
                                    "ScreenshotCaption": "Alert description for PowerShell script with a suspicious command-line that tainted this event (alert specific to this instance not shown)"
                                },
                                {
                                    "ScreenshotName": "MS-19.B.1-1.png",
                                    "ScreenshotCaption": "Telemetry showing execution of recycler.exe with command-line arguments for file encryption and compression"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}