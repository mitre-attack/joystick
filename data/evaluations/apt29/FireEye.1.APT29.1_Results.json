{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection called \"Rundll32 Execution\" was generated due to the execution of rundll32.exe on kxwn.lock.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11664.png", "ScreenshotCaption": "20.A.1 - Rundll32 execution on kxwn.lock (top)"}, {"ScreenshotName": "FireEye-APT29-11665.png", "ScreenshotCaption": "20.A.1 - Rundll32 execution on kxwn.lock (bottom)"}]}, {"DetectionNote": "A Technique alert detection called \"Rundll32 Not Running DLL\" was generated due to rundll32.exe executing kxwn.lock, which did not have a .dll extension.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11662.png", "ScreenshotCaption": "20.A.1 - Rundll32 not running file with a .dll extension (top)"}, {"ScreenshotName": "FireEye-APT29-11663.png", "ScreenshotCaption": "20.A.1 - Rundll32 not running file with a .dll extension (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred for rundll32.exe executing kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13054.png", "ScreenshotCaption": "MSSP - 20.A"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "A General alert detection called \"User Directory File Write\" was generated due to the file monkey.png being written to the user's desktop.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11729.png", "ScreenshotCaption": "CC - 3.A.1 - User Directory File Write for monkey.png"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred containing evidence of rcs.3aka3.doc creating the monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12981.png", "ScreenshotCaption": "MSSP - 3.A"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10900.png", "ScreenshotCaption": "3.A.1 - rcs.3aka3.doc creating monkey.png"}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A General alert detection was generated for a ZIP archive being written to disk. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10943.png", "ScreenshotCaption": "4.A.1 - Zip Archive Created for SysinternalsSuite.zip (top)"}, {"ScreenshotName": "FireEye-APT29-10944.png", "ScreenshotCaption": "4.A.1 - Zip Archive Created for SysinternalsSuite.zip (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of  file write of the ZIP by PowerShell. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12987.png", "ScreenshotCaption": "MSSP - 4.A"}]}, {"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for a PowerShell process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11001.png", "ScreenshotCaption": "4.A.1 - Triage view of PowerShell creating SysinternalsSuite.zip"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "A Technique alert detection called \"File Write to Network Share\" was generated due to a file write event for python.exe to a remote network share.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11170.png", "ScreenshotCaption": "8.B.1 - File Write to Network Share for python.exe"}]}, {"DetectionNote": "A Technique alert detection called \"WebDav Network Request\" was generated due to a WebDav user-agent used to GET python.exe from a WebDav network share.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11169.png", "ScreenshotCaption": "8.B.1 - WebDav Network Request to GET python.exe"}]}, {"DetectionNote": "A General alert detection was generated for classifying python.exe as malware, which also showed it was written by PowerShell to a remote network share.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11177.png", "ScreenshotCaption": "8.B.1 - Malware detection for python.exe (bottom)"}, {"ScreenshotName": "FireEye-APT29-11178.png", "ScreenshotCaption": "8.B.1 - Malware detection for python.exe (top)"}]}, {"DetectionNote": "An MSSP detection showed the file write event of python.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13006.png", "ScreenshotCaption": "MSSP - 8.B"}]}, {"DetectionNote": "Telemetry showed the file write event of python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11172.png", "ScreenshotCaption": "8.B.1 - Triage view of PowerShell writing python.exe over a network share"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "A General alert detection called \"Temp Directory PE Write\" was generated due to python.exe writing rar.exe to C:\\Windows\\Temp.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11742.png", "ScreenshotCaption": "CC - 9.A.1 - Temp Directory PE Write for Rar.exe"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred for python.exe creating rar.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13014.png", "ScreenshotCaption": "MSSP - 9.A"}]}, {"DetectionNote": "Telemetry showed file write event for python.exe creating rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11206.png", "ScreenshotCaption": "9.A - python.exe file writes for Rar.exe and sdelete64.exe"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "A General alert detection called \"Temp Directory PE Write\" was generated due to python.exe writing sdelete64.exe to C:\\Windows\\Temp.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11743.png", "ScreenshotCaption": "CC - 9.A.2 - Temp Directory PE Write for sdelete64.exe"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "A MSSP detection occurred for python.exe creating sdelete64.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13014.png", "ScreenshotCaption": "MSSP - 9.A"}]}, {"DetectionNote": "Telemetry showed File Write event for python.exe creating sdelete64.exe", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11206.png", "ScreenshotCaption": "9.A - python.exe file writes for Rar.exe and sdelete64.exe"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell File Write\" was generated for PowerShell writing m.exe to disk.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11484.png", "ScreenshotCaption": "14.B.3 - PowerShell File Write for m.exe (top)"}, {"ScreenshotName": "FireEye-APT29-11485.png", "ScreenshotCaption": "14.B.3 - PowerShell File Write for m.exe (bottom)"}]}, {"DetectionNote": "A Technique alert detection called \"PowerShell URL Request\" was generated due to a URL request from PowerShell for m.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11473.png", "ScreenshotCaption": "14.B.3 - PowerShell URL Request for m.exe"}]}, {"DetectionNote": "A Technique alert detection was generated for suspicious PowerShell usage with encoded commands associated with download cradles.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11463.png", "ScreenshotCaption": "14.B.1 - PowerShell Encoded Remote Download (bottom)"}, {"ScreenshotName": "FireEye-APT29-11462.png", "ScreenshotCaption": "14.B.1 - PowerShell Encoded Remote Download (top)"}]}, {"DetectionNote": "An MSSP detection contained evidence of the creation of m.exe in the System32 folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13035.png", "ScreenshotCaption": "MSSP - 14.B"}]}, {"DetectionNote": "Telemetry showed the PowerShell command to download m.exe. Telemetry also showed the file write event for m.exe into the System32 folder.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the write of m.exe to the System32 directory by wsmprovhost.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13042.png", "ScreenshotCaption": "MSSP - 16.D"}]}, {"DetectionNote": "Telemetry showed the file write of m.exe to System32 directory by wsmprovhost.exe. The detection was correlated to parent alert on the wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11575.png", "ScreenshotCaption": "16.D.1 - Triage view of the m.exe file write"}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "A MSSP detection occurred for the Deletion of the registry value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12986.png", "ScreenshotCaption": "MSSP - 3.C"}]}, {"DetectionNote": "Telemetry showed the deletion of the command subkey. This was correlated with a prior detection of the PowerShell parent process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10960.png", "ScreenshotCaption": "3.C.1 - Triage view of Remove-Item"}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "An MSSP detection occurred for the deletion of the command subkey Registry value. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13033.png", "ScreenshotCaption": "MSSP - 14.A"}]}, {"DetectionNote": "Telemetry showed PowerShell command to delete the Registry value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11456.png", "ScreenshotCaption": "14.A.3 - Script block for Remove-Item on Registry"}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell Execution\" was generated due to powershell.exe spawning from cmd.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10853.png", "ScreenshotCaption": "1.B.2 - PowerShell Execution from parent cmd.exe"}]}, {"DetectionNote": "A General alert detection was generated for cmd.exe spawning a child process.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10860.png", "ScreenshotCaption": "1.B.2 - CMD Child Process of powershell.exe (bottom)"}, {"ScreenshotName": "FireEye-APT29-10859.png", "ScreenshotCaption": "1.B.2 - CMD Child Process of powershell.exe (top)"}]}, {"DetectionNote": "An MSSP detection occurred for powershell.exe spawning from cmd.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12978.png", "ScreenshotCaption": "MSSP - 1.B"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell Execution\" was generated due to the execution of powershell.exe, which was used to execute powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10946.png", "ScreenshotCaption": "4.A.2 - PowerShell Execution of powershell.exe"}]}, {"DetectionNote": "A General alert detection for PowerShell child process was generated for powershell.exe spawning a child process.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10947.png", "ScreenshotCaption": "4.A.2 - PowerShell Child Process of powershell.exe"}]}, {"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell Execution\" was generated due to python.exe spawning powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11207.png", "ScreenshotCaption": "9.B.1 - PowerShell Execution for python.exe spawning powershell.exe"}]}, {"DetectionNote": "A MSSP detection occurred for python.exe executing powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13015.png", "ScreenshotCaption": "MSSP - 9.B"}]}, {"DetectionNote": "Telemetery showed python.exe executing powershell.exe. This event was correlated to prior detection for the python.exe process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11222.png", "ScreenshotCaption": "9.B - Triage view with python.exe executing powershell.exe"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection called \"POWERSHELL.EXE IEX ENCODED COMMAND (METHODOLOGY)\" was generated due to encoded PowerShell IEX execution.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11346.png", "ScreenshotCaption": "11.A - PowerShell Get-Content Command with schemas IEX"}, {"ScreenshotName": "FireEye-APT29-11359.png", "ScreenshotCaption": "11.A.12 - PowerShell IEX Encoded Command (top)"}, {"ScreenshotName": "FireEye-APT29-11360.png", "ScreenshotCaption": "11.A.12 - PowerShell IEX Encoded Command (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred for the PowerShell stager executing (IEX) from schemas.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell Network Connection\" was generated due to the SYSTEM level PowerShell spawned from wmiprvse.exe making a network connection.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11667.png", "ScreenshotCaption": "20.A.3 - PowerShell Network Connection for the SYSTEM level PowerShell spawned from wmiprvse.exe (bottom)"}, {"ScreenshotName": "FireEye-APT29-11666.png", "ScreenshotCaption": "20.A.3 - PowerShell Network Connection for the SYSTEM level PowerShell spawned from wmiprvse.exe (top)"}]}, {"DetectionNote": "An MSSP detection occurred for a SYSTEM-level PowerShell spawned from the WindowsParentalControlMigration WMI event subscription.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13054.png", "ScreenshotCaption": "MSSP - 20.A"}]}, {"DetectionNote": "Telemetry showed SYSTEM-level PowerShell spawned from wmiprvse.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11668.png", "ScreenshotCaption": "20.A.3 - Triage view of wmiprvse.exe spawning SYSTEM level PowerShell callbacks"}, {"ScreenshotName": "FireEye-APT29-11670.png", "ScreenshotCaption": "20.A.3 - Triage view of network connections made by those SYSTEM level callbacks"}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"PsExec Execution\" was generated due to PSEXESVC.exe spawning the child process python.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11196.png", "ScreenshotCaption": "8.C.3 - PSEXESVC.exe executing python.exe"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of python.exe being spawned by PSEXESVC.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13008.png", "ScreenshotCaption": "MSSP - 8.C"}, {"ScreenshotName": "FireEye-APT29-13013.png", "ScreenshotCaption": "MSSP - 8.C"}]}, {"DetectionNote": "Telemetry showed python.exe spawned by PSEXESVC.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "A Technique alert detection called \"Web Service C2\" was generated due to an abnormal application making requests for common web services.", "DetectionType": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11761.png", "ScreenshotCaption": "CC - 18.A.1 - Web Service C2 from net.exe"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "A General alert detection was generated for execution of the \"net use\" command.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11610.png", "ScreenshotCaption": "18.A - Net Use Command Execution"}]}, {"DetectionNote": "A General alert detection was generated for WebDav activity when mapping the OneDrive URL.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11611.png", "ScreenshotCaption": "18.A - WebDav activity to OneDrive"}]}, {"DetectionNote": "An MSSP detection occurred for net.exe connecting to a OneDrive URL.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13047.png", "ScreenshotCaption": "MSSP - 18.A"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. This detection was correlated to a parent alert for a PowerShell process than ran net.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11623.png", "ScreenshotCaption": "18.A.1 - Triage view of net.exe making connections to public IPs on port 443"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "A General alert detection was generated for LDAP connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) over port 389.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11146.png", "ScreenshotCaption": "8.A.1 - LDAP Network Connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) (top)"}, {"ScreenshotName": "FireEye-APT29-11145.png", "ScreenshotCaption": "8.A.1 - LDAP Network Connection from Nashua (10.0.1.6) to NewYork (10.0.0.4) (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred for PowerShell being used to enumerate Active Directory hosts.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13003.png", "ScreenshotCaption": "MSSP - 8.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over TCP port 389. ", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell making a LDAP network connections over port 389 to the domain controller NewYork (10.0.0.4)", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11531.png", "ScreenshotCaption": "16.A.1 - LDAP Network Connection (bottom)"}, {"ScreenshotName": "FireEye-APT29-11530.png", "ScreenshotCaption": "16.A.1 - LDAP Network Connection (top)"}]}, {"DetectionNote": "Telemetry showed PowerShell making a network connection over port 389 to the domain controller NewYork (10.0.0.4). ", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the successful logon of Pam on Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13013.png", "ScreenshotCaption": "MSSP - 8.C"}, {"ScreenshotName": "FireEye-APT29-13008.png", "ScreenshotCaption": "MSSP - 8.C"}]}, {"DetectionNote": "Telemetry showed an account logged on to Scranton (10.0.1.4) as user Pam.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11202.png", "ScreenshotCaption": "8.C.1 - Account logged on to Scranton (10.0.1.4) as user Pam."}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of the successful logon of MScott on NewYork (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13040.png", "ScreenshotCaption": "MSSP - 16.C"}]}, {"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11549.png", "ScreenshotCaption": "16.C.2 - Logon Tracker showing the mscott logon to NewYork (10.0.0.4)"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A Technique alert detection called \"RTL OVERRIDE ATTACK (METHODOLOGY)\" was generated due to rcs.3aka3.doc containing a RTLO character with an MZ header value.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10835.png", "ScreenshotCaption": "1.A.2 - RTL Override alert on rcs.3aka3.doc"}]}, {"DetectionNote": "A General alert detection was generated for Generic.Exploit.Shellcode on rcs.3aka3.doc.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10832.png", "ScreenshotCaption": "1.A.2 - Generic Exploit Shellcode on rcs.3aka3.doc"}]}, {"DetectionNote": "A MSSP detection occurred for the RTLO character in rcs.3aka.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12976.png", "ScreenshotCaption": "MSSP - 1.A"}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sysinternals Masquerade\" was generated due to the process accesschk.exe executing without accepting the EULA.", "DetectionType": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11728.png", "ScreenshotCaption": "CC - 6.A.3 - Sysinternal Masquerade alert for accesschk.exe"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred indicating that accesschk.exe is not the legitimate Sysinternals tool.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12996.png", "ScreenshotCaption": "MSSP - 6.A"}]}, {"DetectionNote": "Telemetry showed hash of accesschk.exe which can be used to verify it is not the legitimate Sysinternals tool.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11079.png", "ScreenshotCaption": "6.A.3 - PowerShell Child Process for accseschk.exe execution showing hash (bottom)"}, {"ScreenshotName": "FireEye-APT29-11067.png", "ScreenshotCaption": "6.A.3 - PowerShell Child Process for accseschk.exe execution (top)"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "An MSSP detection occurred for the rcs.3aka3.doc process using rc4 encryption for network communication.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12976.png", "ScreenshotCaption": "MSSP - 1.A"}]}, {"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11720.png", "ScreenshotCaption": "CC - 1.A.4 - Cryptographic Library Load (top)"}, {"ScreenshotName": "FireEye-APT29-11707.png", "ScreenshotCaption": "1.A.4 - rcs.3aka3.doc loading bcrypt.dll, crypt32.dll, cryptbase.dll"}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS.", "DetectionType": "None", "Modifiers": ["Residual Artifact"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10929.png", "ScreenshotCaption": "3.B - Parsing strings in process memory for HTTPS reference"}]}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A Technique alert detection called \"Startup Folder Persistence\" was generated due to the creation of a file in the Start Menu Startup folder.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13986.png", "ScreenshotCaption": "5.B.1 - Startup Folder Persistence (bottom)"}, {"ScreenshotName": "FireEye-APT29-13984.png", "ScreenshotCaption": "5.B.1 - Startup Folder Persistence (top)"}]}, {"DetectionNote": "A General alert detection was generated due to a suspicious LNK file. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11056.png", "ScreenshotCaption": "5.B.1 - Suspicious LNK File for hostui.lnk (bottom)"}, {"ScreenshotName": "FireEye-APT29-11054.png", "ScreenshotCaption": "5.B.1 - Suspicious LNK File for hostui.lnk (top)"}]}, {"DetectionNote": "An MSSP detection occurred for the creation of the hostui.lnk file in the Startup folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12994.png", "ScreenshotCaption": "MSSP - 5.B"}]}, {"DetectionNote": "Telemetry showed PowerShell creating the hostui.lnk file in the Startup folder. The event was correlated to a parent detection for PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11062.png", "ScreenshotCaption": "5.B.1 - Triage view of the file write of hostui.lnk to the startup folder"}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11284.png", "ScreenshotCaption": "10.B.1 - Audit Viewer for explorer.exe spawning cmd.exe to run hostui.bat"}, {"ScreenshotName": "FireEye-APT29-11259.png", "ScreenshotCaption": "10.B.1 - explorer.exe spawning cmd.exe to run hostui.bat"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique alert detection called \"Run Key Persistence\" was generated due to the modification of \"run\" Registry persistence keys.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11352.png", "ScreenshotCaption": "11.A.11 - Run Key Persistence for Webcache subkey (top)"}, {"ScreenshotName": "FireEye-APT29-11353.png", "ScreenshotCaption": "11.A.11 - Run Key Persistence for Webcache subkey (bottom)"}]}, {"DetectionNote": "An MSSP detection contained evidence of the Webcache subkey added to the Registry to establish persistence.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13025.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "An MSSP detection was generated containing evidence of observed UPX packing on a Python payload.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13006.png", "ScreenshotCaption": "MSSP - 8.B"}]}, {"DetectionNote": "Telemetry showed that python.exe had entropy, indicating the file was packed.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11174.png", "ScreenshotCaption": "8.B.2 - Entropy value near 1 suggests python.exe is packed"}]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "An MSSP detection occurred for the addition of the DelegateExecute Registry Value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12984.png", "ScreenshotCaption": "MSSP - 3.B"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10928.png", "ScreenshotCaption": "3.B.1 - Addition of the DelegateExecute Registry Value"}]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": " An MSSP detection occurred for the addition of the DelegateExecute Registry value.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13032.png", "ScreenshotCaption": "MSSP - 14.A"}]}, {"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11455.png", "ScreenshotCaption": "14.A.1 - Script block for bypass function (bottom), DelegateExecute value above Remote-Item highlight"}, {"ScreenshotName": "FireEye-APT29-11452.png", "ScreenshotCaption": "14.A.1 - Script block for bypass function (top)"}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"Execution from User Directory\" was generated due to the rcs.3aka3.doc process executing from a user's desktop.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10838.png", "ScreenshotCaption": "1.A.1 - explorer.exe executing rcs.3aka3.doc"}]}, {"DetectionNote": "A General alert detection was generated for a new application in AppCompat, indicating an application executing for the first time.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11717.png", "ScreenshotCaption": "CC - 1.A.1 - New App in AppCompat alert for rcs.3aka3.doc. Indicating rcs.3aka3.doc is an application that has not been run on the system before."}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred for user Pam executing rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12976.png", "ScreenshotCaption": "MSSP - 1.A"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10846.png", "ScreenshotCaption": "Another of explorer.exe with PRS to doc file, indicates presence. PRS  is related to the RTLO, that this process generated a presence based IOC alert"}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "An MSSP detection was generated containing evidence user Oscar executed 37486-the-shockingtruth-about-election-rigging-in-america.rtf.lnk.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11346.png", "ScreenshotCaption": "11.A - PowerShell Get-Content Command with schemas IEX"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "A Technique alert detection called \"Service Persistence\" was generated due to the modification of Windows service Registry keys when the javamtsup service was created.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11043.png", "ScreenshotCaption": "5.A.1 - Service Persistence for javamtsup (bottom)"}, {"ScreenshotName": "FireEye-APT29-11041.png", "ScreenshotCaption": "5.A.1 - Service Persistence for javamtsup (top)"}]}, {"DetectionNote": "A General alert detection was generated for javamtsup.exe being classified as malware.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11077.png", "ScreenshotCaption": "5.A.1 - Malware signature detection on javamtsup.exe"}]}, {"DetectionNote": "An MSSP detection occurred for the creation of the javamtsup service.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12993.png", "ScreenshotCaption": "MSSP - 5.A"}]}, {"DetectionNote": "Telemetry showed PowerShell created the new service javamtsup.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell System.Drawing Load\" was generated due to powershell.exe loading System.Drawing.ni.dll, indicating possible Screen Capture.", "DetectionType": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11725.png", "ScreenshotCaption": "CC - 7.A.1 - PowerShell System.Drawing Load"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Invoke-ScreenCapture to capture screen shots.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13000.png", "ScreenshotCaption": "MSSP - 7.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing CopyFromScreen from System.Drawing.dll.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11113.png", "ScreenshotCaption": "7.A.1 - Script block for CopyFromScreen"}, {"ScreenshotName": "FireEye-APT29-11112.png", "ScreenshotCaption": "7.A.1 - powershell.exe loading System.Drawing.ni.dll"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "A Technique alert detection called \"CMD Execution\" was generated due to cmd.exe spawning from rcs.3aka3.doc.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10857.png", "ScreenshotCaption": "1.B.1 - CMD Execution from parent rcs.3aka3.doc (bottom)"}, {"ScreenshotName": "FireEye-APT29-10856.png", "ScreenshotCaption": "1.B.1 - CMD Execution from parent rcs.3aka3.doc (top)"}]}, {"DetectionNote": "An MSSP detection occurred for cmd.exe spawning from rcs.3aka3.doc\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12978.png", "ScreenshotCaption": "MSSP - 1.B"}]}, {"DetectionNote": "Telemetry showed rcs.3aka3.doc spawning from cmd.exe\u200b. This was correlated to a parent alert on rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10861.png", "ScreenshotCaption": "1.B.1 - Triage view of cmd.exe from rcs.3aka3.doc"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Clipboard.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13000.png", "ScreenshotCaption": "MSSP - 7.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11103.png", "ScreenshotCaption": "7.A.2 - Script block for Get-Clipboard"}]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:USERDOMAIN.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERDOMAIN.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11018.png", "ScreenshotCaption": "4.C.4 - Script block for $env:USERDOMAIN"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}, {"ScreenshotName": "FireEye-APT29-13024.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11389.png", "ScreenshotCaption": "11.A - gwmi query for Win32_ComputerSystem"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell loading netapi32.dll, which contains functions for user and group discovery, including NetWkstaGetInfo.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11754.png", "ScreenshotCaption": "CC - 13.B.1 - PowerShell loading netapi32.dll"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11431.png", "ScreenshotCaption": "13.B.1 - Script block for NetWkstaGetInfo API"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence Invoke-Exfil was used to compress and encrypt data for exfiltration.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13001.png", "ScreenshotCaption": "MSSP - 7.B"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11139.png", "ScreenshotCaption": "7.B.3 - Script block for Compress-7Zip ... lolol"}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "A Technique alert detection called \"Encrypted RAR Archive Command\" \"T1022\" was generated when rar.exe used \"-hp\" command-line arguments.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11214.png", "ScreenshotCaption": "9.B.6 - Encrypted RAR Archive Command"}]}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to encrypt working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13017.png", "ScreenshotCaption": "MSSP - 9.B"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "A General alert detection was generated for a non-standard process loading the Windows credential management library vaultcli.dll.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11685.png", "ScreenshotCaption": "20.B.1 - PowerShell loading vaultcli.dll (bottom)"}, {"ScreenshotName": "FireEye-APT29-11684.png", "ScreenshotCaption": "20.B.1 - PowerShell loading vaultcli.dll (top)"}]}, {"DetectionNote": "An MSSP detection occurred for Invoke-Mimikatz (kerberos::golden) to create and inject a golden ticket into the current session.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13055.png", "ScreenshotCaption": "MSSP - 20.B"}]}, {"DetectionNote": "Telemetry showed the contents of the Invoke-Mimikatz script along with PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11701.png", "ScreenshotCaption": "20.B.1 - Script block for Mimikatz use of kerberos::golden to create a golden ticket"}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A General detection was generated for PowerShell making a network connection.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10917.png", "ScreenshotCaption": "3.B.3 - PowerShell Network Connection"}]}, {"DetectionNote": "An MSSP detection occurred for powershell.exe connecting to 192.168.0.5 on TCP 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12985.png", "ScreenshotCaption": "MSSP - 3.B"}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell making a network connection.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11386.png", "ScreenshotCaption": "11.A.13 - PowerShell Network Connection, with port 443"}]}, {"DetectionNote": "An MSSP detection occurred for PowerShell making network connection to C2 (192.168.0.4) over port 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13022.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over TCP port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection called \"WinRM Network Connection\" was generated due to a connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11153.png", "ScreenshotCaption": "8.A.2 - WinRM Network Connection to Scranton (10.0.1.4)"}]}, {"DetectionNote": "A General alert detection was generated for PowerShell making a URL request, which contained indications the network connection was using WinRM.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11156.png", "ScreenshotCaption": "8.A.2 - PowerShell URL Request containing WinRM information"}]}, {"DetectionNote": "An MSSP detection occurred for the WinRM connection to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13004.png", "ScreenshotCaption": "MSSP - 8.A"}, {"ScreenshotName": "FireEye-APT29-13003.png", "ScreenshotCaption": "MSSP - 8.A"}]}, {"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection called \"WinRM Network Connection\" was generated for powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11555.png", "ScreenshotCaption": "16.C.1 - WinRM Network Connection to NewYork (10.0.0.4)"}]}, {"DetectionNote": "A General alert detection was generated for a PowerShell URL request to NewYork (10.0.0.4) on port 5895.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11556.png", "ScreenshotCaption": "16.C.1 - PowerShell URL Request to NewYork (10.0.0.4)"}]}, {"DetectionNote": "An MSSP detection contained evidence of a WinRM connection on NewYork (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13040.png", "ScreenshotCaption": "MSSP - 16.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection called \"WinRM Network Connection\" was generated for PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11688.png", "ScreenshotCaption": "20.B.2 - WinRM Network Connection for the WinRM connection to Scranton (10.0.1.4) over port 5985"}]}, {"DetectionNote": "A General alert detection was generated for PowerShell making a URL request when the WinRM connection was made to Scranton (10.0.1.4) over port 5985.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11687.png", "ScreenshotCaption": "20.B.2 - PowerShell URL Request for the WinRM connection"}]}, {"DetectionNote": "An MSSP detection occurred for the WinRM session to remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13057.png", "ScreenshotCaption": "MSSP - 20.B"}]}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "An MSSP detection occurred for accesschk.exe making Windows API call: CryptUnprotectedData.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12996.png", "ScreenshotCaption": "MSSP - 6.A"}]}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A General detection in Process Guard Watcher was generated due to powershell.exe injecting into lsass.exe. ", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11716.png", "ScreenshotCaption": "6.C.1 - Shows agent ID corresponds to Nashua"}, {"ScreenshotName": "FireEye-APT29-11715.png", "ScreenshotCaption": "6.C.1 - Process Guard Watcher showing powershell.exe accessing lsass.exe"}]}, {"DetectionNote": "An MSSP detection identified PowerShell injecting into the LSASS process. This activity was labeled as credential harvesting.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12999.png", "ScreenshotCaption": "MSSP - 6.C - Analysis based on Process Guard Watcher detection"}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection called \"MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)\" was generated for the execution of m.exe executing with command-line arguments indicative of Mimikatz credential dumping.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11474.png", "ScreenshotCaption": "14.B.4 - Process arguments indicating Mimikatz"}]}, {"DetectionNote": "A General alert detection called \"Vaultcli.dll Load\" was generated due to a non-standard process, m.exe, loading vaultcli.dll.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11482.png", "ScreenshotCaption": "14.B.4 - Vaultcli.dll load by m.exe (top)"}, {"ScreenshotName": "FireEye-APT29-11483.png", "ScreenshotCaption": "14.B.4 - Vaultcli.dll load by m.exe (bottom)"}]}, {"DetectionNote": "A General alert detection was generated for m.exe being Mimikatz malware.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11491.png", "ScreenshotCaption": "14.B.4 - Mimikatz malware alert for m.exe"}]}, {"DetectionNote": "An MSSP detection contained evidence of Mimikatz dumping credentials.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13036.png", "ScreenshotCaption": "MSSP - 14.B"}, {"ScreenshotName": "FireEye-APT29-13035.png", "ScreenshotCaption": "MSSP - 14.B"}]}, {"DetectionNote": "Telemetry showed a process access into lsass.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11489.png", "ScreenshotCaption": "14.B.4 - Process Guard Watcher for m.exe access to lsass.exe"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection called \"MIMIKATZ SUSPICIOUS PROCESS ARGUMENTS A (METHODOLOGY)\" was generated due to command line arguments indicating the use of Mimikatz.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11562.png", "ScreenshotCaption": "16.D.2 - Mimikatz detection via process arguments"}]}, {"DetectionNote": "A Technique alert detection called \"Vaultcli.dll Load\" was generated due to a non-standard process, m.exe, loading a Windows credential management library (vaultcli.dll).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11564.png", "ScreenshotCaption": "16.D.2 - m.exe loading vaultcli.dll (bottom)"}, {"ScreenshotName": "FireEye-APT29-11563.png", "ScreenshotCaption": "16.D.2 - m.exe loading vaultcli.dll (top)"}]}, {"DetectionNote": "A General alert detection was generated for m.exe being identified as Mimikatz malware.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11568.png", "ScreenshotCaption": "16.D.2 - Mimikatz malware alert, with signature information (bottom)"}, {"ScreenshotName": "FireEye-APT29-11567.png", "ScreenshotCaption": "16.D.2 - Mimikatz malware alert (top)"}]}, {"DetectionNote": "An MSSP detection occurred for Mimikatz usage to dump credentials for the krbtgt account.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13042.png", "ScreenshotCaption": "MSSP - 16.D"}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}, {"ScreenshotName": "FireEye-APT29-13024.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_BIOS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11343.png", "ScreenshotCaption": "11.A - gwmi query for Win32_BIOS"}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though process memory for the PowerShell process indicated the data exchange was over HTTPS.", "DetectionType": "None", "Modifiers": ["Residual Artifact"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10929.png", "ScreenshotCaption": "3.B - Parsing strings in process memory for HTTPS reference"}]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}, {"ScreenshotName": "FireEye-APT29-12992.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Get-WmiObject ...\u200b -Class AntiVirusProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11025.png", "ScreenshotCaption": "4.C.7 - Script block for Get-WmiObject ...\u200b -Class AntiVirusProduct"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12992.png", "ScreenshotCaption": "MSSP - 4.C"}, {"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: Get-WmiObject ...\u200b\u200b -Class FireWallProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11023.png", "ScreenshotCaption": "4.C.8 - Script block for Get-WmiObject ...\u200b\u200b -Class FireWallProduct"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "An MSSP detection occurred containing PowerShell gwmi query for AntiVirusProduct.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13028.png", "ScreenshotCaption": "MSSP - 12.B"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for AntiVirusProduct.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11421.png", "ScreenshotCaption": "12.B.1 - gwmi query for AntiVirusProduct"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing the NetUserGetGroups API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12992.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetGroups API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11031.png", "ScreenshotCaption": "4.C.9 - Script block for NetUserGetGroups"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing the NetUserGetLocalGroups API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12992.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11037.png", "ScreenshotCaption": "4.C.11 - Script block for NetUserGetLocalGroups"}]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell loading Netapi32.dll.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11722.png", "ScreenshotCaption": "CC - 4.C.10- PowerShell loading Netapi32.dll"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "A MSSP detection occurred for the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12992.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed the NetUserGetGroups API function loaded into PowerShell from Netapi32.dll.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11030.png", "ScreenshotCaption": "4.C - Script block showing the load of Netapi32.dll"}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell loading Netapi32.dll.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11723.png", "ScreenshotCaption": "CC - 4.C.12 - PowerShell loading Netapi32.dll"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "A MSSP detection occurred for the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12992.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed the NetUserGetLocalGroups API function loaded into PowerShell from Netapi32.dll.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11030.png", "ScreenshotCaption": "4.C - Script block showing the load of Netapi32.dll"}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure. ", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell Loading Advapi32.dll\" was generated for PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "DetectionType": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11757.png", "ScreenshotCaption": "CC - 16.B.2 - PowerShell Loading Advapi32.dll"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred for the ConvertSidToStringSid API function loaded into PowerShell from Advapi32.dll.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13039.png", "ScreenshotCaption": "MSSP - 16.B"}]}, {"DetectionNote": "Telemetry showed PowerShell reflectively loading Advapi32.dll inorder to execute the ConvertSidToStringSid API function.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11546.png", "ScreenshotCaption": "16.B.2 - Script block for PowerShell loading advapi32.dll"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "A Technique alert detection called \"WebDav Network Request\" was generated due to a WebDav user-agent being used to PUT OfficeSupplies.7z on a WebDav network share.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11125.png", "ScreenshotCaption": "7.B.4 - WebDav Network Request to PUT OfficeSupplies.7z"}]}, {"DetectionNote": "A General alert detection was generated for the file write of OfficeSupplies.7z to a remote adversary WebDav network share (192.168.0.4).", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11127.png", "ScreenshotCaption": "7.B.4 - File write of OfficeSupplies.7z to the WebDav network share "}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being uploaded to 192.168.0.4 using WebDav.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13002.png", "ScreenshotCaption": "MSSP - 7.B"}]}, {"DetectionNote": "Telemetry showed PoweShell Copy-Item to a remote adversary WebDav network share (192.168.0.4).", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "A General detection alert was generated for a file write to a network share.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11618.png", "ScreenshotCaption": "18.A.2 - File Write to Network Share for WindowsParentalControlMigration.tmp (top)"}, {"ScreenshotName": "FireEye-APT29-11619.png", "ScreenshotCaption": "18.A.2 - File Write to Network Share for WindowsParentalControlMigration.tmp (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred for the WindowsParentalControlMigration.tmp file being written to the mapped OneDrive network share.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13047.png", "ScreenshotCaption": "MSSP - 18.A"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent alert on the PowerShell process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11622.png", "ScreenshotCaption": "18.A.2 - Triage view of PowerShell copying WindowsParentalControlMigration.tmp to the Y drive"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection occurred for file timestamp modification on the kxwn.lock file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13027.png", "ScreenshotCaption": "MSSP - 12.A"}]}, {"DetectionNote": "Telemetry showed modification of creation, last access, and last write times of kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11415.png", "ScreenshotCaption": "12.A.2 - Modification of timestamp values on kxwn.lock"}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "A Technique alert detection called \"Private Key - T1145\" was generated due to the creation of the $RandomFileName.pfx file. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11091.png", "ScreenshotCaption": "6.B.1 - Private Key alert with the pfx file creation"}]}, {"DetectionNote": "An MSSP detection was generated for the creation of the $RandomFileName.pfx file. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12998.png", "ScreenshotCaption": "MSSP - 6.B"}]}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "A Technique alert detection called \"ADS Code Exec (Methodology)\" was generated due to PowerShell's use of command-line arguments associated with executing alternate data streams.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11347.png", "ScreenshotCaption": "11.A.2 - ADS Code Exec for schemas stream"}]}, {"DetectionNote": "A General alert detection was generated for suspicious usage of PowerShell's Get-Content command.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11346.png", "ScreenshotCaption": "11.A - PowerShell Get-Content Command with schemas IEX"}]}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell executing schemas ADS via Get-Content and IEX.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13020.png", "ScreenshotCaption": "MSSP - 11.A"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13029.png", "ScreenshotCaption": "MSSP - 12.C"}]}, {"DetectionNote": "Telemetry showed scriptblock with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11423.png", "ScreenshotCaption": "12.C.1 - Script block for registry query"}]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the registry query for installed software.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13029.png", "ScreenshotCaption": "MSSP - 12.C"}]}, {"DetectionNote": "Telemetry showed script block with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11422.png", "ScreenshotCaption": "12.C.2 - Script block for registry query"}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "A Technique alert detection called \"ZIP Archive Created - T1002\" was generated due to Draft.zip being identified as compressed.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10871.png", "ScreenshotCaption": "2.A.5 - ZIP Archive Created for Draft.zip (bottom)"}, {"ScreenshotName": "FireEye-APT29-10870.png", "ScreenshotCaption": "2.A.5 - ZIP Archive Created for Draft.zip (top)"}]}, {"DetectionNote": "An MSSP detection occurred for powershell.exe compressing via Compress-Archive.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12979.png", "ScreenshotCaption": "MSSP - 2.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10884.png", "ScreenshotCaption": "2.A.4 - PowerShell executing Compress-Archive in script block"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "A Technique alert detection called \"7-Zip Archive Created\" was generated due a 7-Zip file being written to disk.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11129.png", "ScreenshotCaption": "7.B.2 - 7-Zip Archive Created for OfficeSupplies.7z"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of the file create of OfficeSupplies.7z.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13002.png", "ScreenshotCaption": "MSSP - 7.B"}, {"ScreenshotName": "FireEye-APT29-13001.png", "ScreenshotCaption": "MSSP - 7.B"}]}, {"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z. This detection was correlated to a parent alert on the parent PowerShell process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11138.png", "ScreenshotCaption": "7.B.2 - Triage view for file creation of OfficeSupplies.7z"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"Rar Execution\" \"T1002\" was generated when powershell.exe executed rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11212.png", "ScreenshotCaption": "9.B.7 - Rar used to compress data"}]}, {"DetectionNote": "An MSSP detection contained evidence of execution of rar.exe with command line arguments to compress working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13017.png", "ScreenshotCaption": "MSSP - 9.B"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "A Technique alert detection called \"Zip Archive Created\" was generated due to the creation of the ZIP archive WindowsParentalControlMigration.tmp on disk.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11591.png", "ScreenshotCaption": "17.C.1 - Zip Archive Creation (bottom)"}, {"ScreenshotName": "FireEye-APT29-11590.png", "ScreenshotCaption": "17.C.1 - Zip Archive Creation (top)"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of data compression.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13046.png", "ScreenshotCaption": "MSSP - 17.C"}]}, {"DetectionNote": "Telemetry showed PowerShell compressing collection via the ZipFile.CreateFromDirectory .NET method.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11602.png", "ScreenshotCaption": "17.C.1 - Script block for the \"zip\" function"}]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12989.png", "ScreenshotCaption": "MSSP - 4.B"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10999.png", "ScreenshotCaption": "4.B.1 - Script block log showing the execution of Get-Process"}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $PID.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: $PID.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11019.png", "ScreenshotCaption": "4.C.5 - Script block for $PID"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13003.png", "ScreenshotCaption": "MSSP - 8.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11163.png", "ScreenshotCaption": "8.A.3 - Script block for Get-Process"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}, {"ScreenshotName": "FireEye-APT29-13024.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11391.png", "ScreenshotCaption": "11.A.8 - gwmi query for Win32_Process"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11436.png", "ScreenshotCaption": "13.D.1 - Script block for CreateToolhelp32Snapshot API"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell executing Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13036.png", "ScreenshotCaption": "MSSP - 14.B"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11500.png", "ScreenshotCaption": "14.B.2 - Script block for Get-Process"}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "A General alert detection called \"PowerShell Loading User32.dll\" was generated due to powershell.exe loading user32.dll, indicating possible Input Capture.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11727.png", "ScreenshotCaption": "CC - 7.A.3 - PowerShell Loading User32.dll"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred containing evidence of keylogging.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13000.png", "ScreenshotCaption": "MSSP - 7.A"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11106.png", "ScreenshotCaption": "7.A.3 - Script block for GetAsyncKeyState"}]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:USERNAME.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:USERNAME.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11016.png", "ScreenshotCaption": "4.C.2 - Script block for $env:USERNAME"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13024.png", "ScreenshotCaption": "MSSP - 11.A"}, {"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11389.png", "ScreenshotCaption": "11.A - gwmi query for Win32_ComputerSystem"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11433.png", "ScreenshotCaption": "13.C.1 - Script block for GetUserNameEx API"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "A MSSP detection occurred for PowerShell executing $env:UserName.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13037.png", "ScreenshotCaption": "MSSP - 15.A"}]}, {"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11510.png", "ScreenshotCaption": "15.A.1 - Script block for PowerShell executing $env:UserName"}]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing the ConvertSidToStringSid API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13039.png", "ScreenshotCaption": "MSSP - 16.B"}]}, {"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11544.png", "ScreenshotCaption": "16.B.1 - Script block for the ConvertSidToStringSid API"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12979.png", "ScreenshotCaption": "MSSP - 2.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10881.png", "ScreenshotCaption": "2.A - Get-ChildItem from PowerShell"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:TEMP.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:TEMP.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11015.png", "ScreenshotCaption": "4.C.1 - Script block for $env:TEMP"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13017.png", "ScreenshotCaption": "MSSP - 9.B"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11224.png", "ScreenshotCaption": "9.B.2/3 - Script block for ChildItem"}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell query for current path: (Get-Item -Path \".\\\" -Verbose).FullName.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13024.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed PowerShell executing Get-Item for the current path.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11393.png", "ScreenshotCaption": "11.A.9 - Script block for Get-Item -Path \".\\\" -Verbose).FullName"}]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell enumeration of System32.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13027.png", "ScreenshotCaption": "MSSP - 12.A"}]}, {"DetectionNote": "Telemetry showed the PowerShell enumeration of System32.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11408.png", "ScreenshotCaption": "12.A.1 - Script block for gci enumeration of System32"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete rcs.3aka3.doc.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10994.png", "ScreenshotCaption": "4.B.2 - Sdelete Command Execution on rcs.3aka3.doc"}]}, {"DetectionNote": "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10988.png", "ScreenshotCaption": "4.B - PowerShell Child Process of sdelete64.exe (top)"}, {"ScreenshotName": "FireEye-APT29-10992.png", "ScreenshotCaption": "4.B.2 - PowerShell Child Process for sdelete64.exe on rcs.3aka3.doc (bottom)"}]}, {"DetectionNote": "A General alert detection was generated for the execution of a Sysinternals utility.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10986.png", "ScreenshotCaption": "4.B.2 - Sysinternals Utility Execution for rcs.3aka3.doc"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting the file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12990.png", "ScreenshotCaption": "MSSP - 4.B"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11005.png", "ScreenshotCaption": "4.B.2 - Alphabetic rollovers from SDelete of rcs.3aka3.doc"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete Draft.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10995.png", "ScreenshotCaption": "4.B.3 - Sdelete Command Execution on Draft.zip"}]}, {"DetectionNote": "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10991.png", "ScreenshotCaption": "4.B.3 -  PowerShell Child Process for sdelete64.exe on Draft.zip (bottom)"}, {"ScreenshotName": "FireEye-APT29-10988.png", "ScreenshotCaption": "4.B - PowerShell Child Process of sdelete64.exe (top)"}]}, {"DetectionNote": "A General alert detection was generated for the execution of a Sysinternals utility.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10985.png", "ScreenshotCaption": "4.B.3 - Sysinternals Utility Execution for Draft.zip"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting Draft.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12990.png", "ScreenshotCaption": "MSSP - 4.B"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11009.png", "ScreenshotCaption": "4.B.3 - Alphabetic rollovers from SDelete of Draft.zip"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution\" was generated due to the execution of sdelete64.exe to delete SysinternalsSuite.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10996.png", "ScreenshotCaption": "4.B.4 - Sdelete Command Execution on SysinternalsSuite.zip"}]}, {"DetectionNote": "A General alert detection was generated for powershell.exe creating the sdelete64.exe child process.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10990.png", "ScreenshotCaption": "4.B.4 - PowerShell Child Process for sdelete64.exe on SysinternalsSuite.zip (bottom)"}, {"ScreenshotName": "FireEye-APT29-10988.png", "ScreenshotCaption": "4.B - PowerShell Child Process of sdelete64.exe (top)"}]}, {"DetectionNote": "A General alert detection was generated for the execution of a Sysinternals utility.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10982.png", "ScreenshotCaption": "4.B.4 - Sysinternals Utility Execution for SysinternalsSuite.zip"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12990.png", "ScreenshotCaption": "MSSP - 4.B"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11007.png", "ScreenshotCaption": "4.B.4 - Alphabetic rollovers from SDelete of SysinternalsSuite.zip"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13995.png", "ScreenshotCaption": "9.C.1 - Sdelete Command Execution for Rar.exe"}]}, {"DetectionNote": "A MSSP detection occurred for the file deletion of rar.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13019.png", "ScreenshotCaption": "MSSP - 9.C"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11232.png", "ScreenshotCaption": "9.C.2 - Sdelete Command Execution for C:\\Users\\pam\\Desktop\\working.zip"}]}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Desktop\\working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13019.png", "ScreenshotCaption": "MSSP - 9.C"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdelete Command Execution T1107\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13996.png", "ScreenshotCaption": "9.C.3 - Sdelete Command Execution for C:\\Users\\pam\\AppData\\Roaming\\working.zip"}]}, {"DetectionNote": "A MSSP detection occurred for the file deletion of Roaming\\working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13019.png", "ScreenshotCaption": "MSSP - 9.C"}]}, {"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. This event was correlated to a prior detection on the python.exe parent process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11241.png", "ScreenshotCaption": "9.C.3 - Triage view of sdelete64.exe deleting C:\\Users\\pam\\AppData\\Roaming\\working.zip and associated alphabetical rollovers"}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "A General alert detection called \"Unusual Outlook Parent Process\" was generated due to Outlook being launched by a process other than explorer.exe.", "DetectionType": "General", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11760.png", "ScreenshotCaption": "CC - 17.A.1 - Unusual Outlook Parent Process"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection contained evidence of PowerShell collected email information from Outlook.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13045.png", "ScreenshotCaption": "MSSP - 17.A"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11581.png", "ScreenshotCaption": "17.A.1 - outlook.exe with parent process svchost.exe"}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell file write.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10957.png", "ScreenshotCaption": "4.A.3 - Example write for Bginfo64.exe (bottom)"}, {"ScreenshotName": "FireEye-APT29-10949.png", "ScreenshotCaption": "4.A.3 - PowerShell File Write for extraction (top)"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe decompressing files via Expand-Archive. ", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12987.png", "ScreenshotCaption": "MSSP - 4.A"}]}, {"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The detection was correlated to a parent alert for a PowerShell process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10966.png", "ScreenshotCaption": "4.A.3 - Triage view indicating the alerts for PowerShell File Write"}, {"ScreenshotName": "FireEye-APT29-10970.png", "ScreenshotCaption": "4.A.3 - Script block logging for Expand-Archive"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection called \"Certutil Decode\" was generated due to the use of certutil to decode file content.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11349.png", "ScreenshotCaption": "11.A.10 - Certutil Decode on blob to kxwn.lock"}]}, {"DetectionNote": "A Technique alert detection was generated for certutil.exe writing a fake certificate identified as an encoded binary.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11374.png", "ScreenshotCaption": "CERTUTIL with fake cert with encoded header"}]}, {"DetectionNote": "A MSSP detection occurred for certutil.exe decoding kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13026.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell Get-WmiInstance reading encoded content from Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13036.png", "ScreenshotCaption": "MSSP - 14.B"}]}, {"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11508.png", "ScreenshotCaption": "14.B.6 - Script block for Get-WmiObject"}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection called \"Net User Add\" was generated for net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11694.png", "ScreenshotCaption": "20.B.3 - Net User Add for net user add with password redacted"}]}, {"DetectionNote": "A General alert detection called WinRM process activity was generated for for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11693.png", "ScreenshotCaption": "20.B.3 - WinRM Process Activity for net user add with password redacted"}]}, {"DetectionNote": "An MSSP detection occurred for the creation of the user Toby on Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13057.png", "ScreenshotCaption": "MSSP - 20.B"}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "A General alert detection was generated for file creation of Draft.zip", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10869.png", "ScreenshotCaption": "2.A.5 - PowerShell File Write for Draft.zip (bottom)"}, {"ScreenshotName": "FireEye-APT29-10868.png", "ScreenshotCaption": "2.A.5 - PowerShell File Write for Draft.zip (top)"}]}, {"DetectionNote": "An MSSP detection occurred for the file creation of Draft.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12979.png", "ScreenshotCaption": "MSSP - 2.A"}]}, {"DetectionNote": "Telemetry showed file creation of Draft.zip. This was correlated to prior a detection of the parent PowerShell process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10873.png", "ScreenshotCaption": "2.A.5 - Triage view of powershell.exe writing Draft.zip with first bytes of the file displayed"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "A Technique alert detection called \"ZIP Archive Created\" \"T1074\" was generated due to the file creation of the ZIP file working.zip.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11209.png", "ScreenshotCaption": "9.B.5 - ZIP Archive Created for working.zip (bottom)"}, {"ScreenshotName": "FireEye-APT29-11208.png", "ScreenshotCaption": "9.B.5 - ZIP Archive Created for working.zip (top)"}]}, {"DetectionNote": "A MSSP detection occurred for file create of working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13017.png", "ScreenshotCaption": "MSSP - 9.B"}]}, {"DetectionNote": "Telemetry showed a file create event for working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell writing the MITRE-ATTACK-EVALS.HTML file to disk.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11585.png", "ScreenshotCaption": "17.B.2 - PowerShell File Write for MITRE-ATTACK-EVALS.HTML (top)"}, {"ScreenshotName": "FireEye-APT29-11584.png", "ScreenshotCaption": "17.B.2 - PowerShell File Write for MITRE-ATTACK-EVALS.HTML (bottom)"}]}, {"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML. This event was correlated to parent alerts relating to the PowerShell process that carried out the file write.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11589.png", "ScreenshotCaption": "17.B.2 - Triage view of the file write for MITRE-ATTACK-EVALS.HTML"}]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "An MSSP detection contained evidence of WMI persistence established for user Oscar.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13037.png", "ScreenshotCaption": "MSSP - 15.A"}]}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11512.png", "ScreenshotCaption": "15.A.2 - Script block for the WMI event filter"}, {"ScreenshotName": "FireEye-APT29-11513.png", "ScreenshotCaption": "15.A.2 - Script block for the WMI event consumer"}, {"ScreenshotName": "FireEye-APT29-11514.png", "ScreenshotCaption": "15.A.2 - Script block for the binding"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"WMI Process Creation\" was generated due to wmiprvse.exe executing the PowerShell stager as a child process.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11645.png", "ScreenshotCaption": "20.A.2 - WMI Process Creation for the PowerShell stager (top)"}, {"ScreenshotName": "FireEye-APT29-11646.png", "ScreenshotCaption": "20.A.2 - WMI Process Creation for the PowerShell stager (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred for the WMI event subscription WindowsParentalControlMigration executing PowerShell upon user logon.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13054.png", "ScreenshotCaption": "MSSP - 20.A"}]}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing: $env:COMPUTERNAME.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing: $env:COMPUTERNAME.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11017.png", "ScreenshotCaption": "4.C.3 - Script block for $env:COMPUTERNAME"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12992.png", "ScreenshotCaption": "MSSP - 4.C"}, {"ScreenshotName": "FireEye-APT29-12991.png", "ScreenshotCaption": "MSSP - 4.C"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing:\u200b Gwmi Win32_OperatingSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11021.png", "ScreenshotCaption": "4.C.6 - Script block for Gwmi Win32_OperatingSystem"}]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}, {"ScreenshotName": "FireEye-APT29-13024.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi queries for Win32_BIOS and Win32_ComputerSystem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11389.png", "ScreenshotCaption": "11.A - gwmi query for Win32_ComputerSystem"}, {"ScreenshotName": "FireEye-APT29-11343.png", "ScreenshotCaption": "11.A - gwmi query for Win32_BIOS"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of PowerShell executing the GetComputerNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13031.png", "ScreenshotCaption": "MSSP - 13.A"}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11429.png", "ScreenshotCaption": "13.A.1 - Script block for GetComputerNameEx API"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "A General alert detection was generated for network traffic from Nashua (10.0.1.6) to Scranton (10.0.1.4) over a port associated with DCOM RPC traffic.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11184.png", "ScreenshotCaption": "8.C.2 - DCOM RPC network traffic (top)"}, {"ScreenshotName": "FireEye-APT29-11185.png", "ScreenshotCaption": "8.C.2 - DCOM RPC network traffic (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13008.png", "ScreenshotCaption": "MSSP - 8.C"}]}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"PowerShell WMI Activity\" was generated for WmiPrvSE.exe executing powershell.exe. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11470.png", "ScreenshotCaption": "14.B.1 - PowerShell WMI Activity"}]}, {"DetectionNote": "A Technique alert detection called \"WMI Process Creation\" was generated due to a process being started by WMI.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11467.png", "ScreenshotCaption": "14.B.1 - WMI Process Creation of powershell.exe"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe", "DetectionType": "Telemetry", "Modifiers": [], "Footnotes": ["Though no image was captured, MITRE confirmed that the vendor has the capability to show available telemetry in a separate view."]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdclt Child Process\" was generated due to sdclt.exe spawning control.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10908.png", "ScreenshotCaption": "3.B.2 - Sdclt Child Process for sdclt.exe spawning control.exe"}]}, {"DetectionNote": "A MSSP detection occurred for a new high integrity PowerShell callback spawned from control.exe\u200b\u200b.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12984.png", "ScreenshotCaption": "MSSP - 3.B"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection called \"Sdclt Child Process\" was generated due to sdclt.exe spawning control.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11441.png", "ScreenshotCaption": "14.A.2 - Sdclt Child Process of control.exe"}]}, {"DetectionNote": "An MSSP detection contained evidence of High Integrity PowerShell process spawned from control.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13033.png", "ScreenshotCaption": "MSSP - 14.A"}, {"ScreenshotName": "FireEye-APT29-13032.png", "ScreenshotCaption": "MSSP - 14.A"}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of the PowerShell script contained within monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12983.png", "ScreenshotCaption": "MSSP - 3.A"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10933.png", "ScreenshotCaption": "3.A.2 - PowerShell extraction and execution on monkey.png"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "An MSSP detection occurred for PowerShell Set-WmiInstance writing encoded content to Win32_AuditCode.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13035.png", "ScreenshotCaption": "MSSP - 14.B"}]}, {"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11505.png", "ScreenshotCaption": "14.B.5 - Script block for Set-WmiInstance"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "A General alert detection was generated for PowerShell writing the WindowsParentalControlMigration.tmp file to disk with the GIF89a header present in the textAtLowestOffset field.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11592.png", "ScreenshotCaption": "17.C.2 - PowerShell File Write for WindowsParentalControlMigration.tmp (top)"}, {"ScreenshotName": "FireEye-APT29-11596.png", "ScreenshotCaption": "17.C.2 - PowerShell File Write for WindowsParentalControlMigration.tmp (bottom)"}]}, {"DetectionNote": "An MSSP detection occurred contained evidence that WindowsParentalControlMigration.tmp was a zip archive that had its file header modified to begin with a GIF image header.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13046.png", "ScreenshotCaption": "MSSP - 17.C"}]}, {"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11601.png", "ScreenshotCaption": "17.C.2 - Script block for set-content on header bytes"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "A Technique alert detection called \"Uncommon Port Connection\" was generated due to  rcs.3aka3.doc connecting to remote port 1234.", "DetectionType": "Technique", "Modifiers": ["Alert", "Configuration Change (Detections)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11721.png", "ScreenshotCaption": "CC - 1.A.3 - Uncommon Port Connection for 1234"}], "Footnotes": ["The logic for this detection was enabled after the start of the evaluation so the detection is identified as a Detection Configuration Change."]}, {"DetectionNote": "An MSSP detection occurred for the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12976.png", "ScreenshotCaption": "MSSP - 1.A"}]}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10843.png", "ScreenshotCaption": "1.A.3 - Network connection to 192.168.0.5:1234"}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "An MSSP detection occurred for the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13024.png", "ScreenshotCaption": "MSSP - 11.A"}, {"ScreenshotName": "FireEye-APT29-13023.png", "ScreenshotCaption": "MSSP - 11.A"}]}, {"DetectionNote": "Telemetry showed the PowerShell gwmi query for Win32_PnPEntity.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11390.png", "ScreenshotCaption": "11.A.5 - gwmi query for Win32_PnPEntity"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection occurred for powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-12979.png", "ScreenshotCaption": "MSSP - 2.A"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-10881.png", "ScreenshotCaption": "2.A - Get-ChildItem from PowerShell"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A MSSP detection occurred for powershell.exe executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "FireEye-APT29-13017.png", "ScreenshotCaption": "MSSP - 9.B"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "FireEye-APT29-11224.png", "ScreenshotCaption": "9.B.2/3 - Script block for ChildItem"}]}]}]}]}