{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10738.png", "ScreenshotCaption": "Telemetry showing rundll32.exe executing kxwn.lock."}]}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc reading file monkey.png. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10256.png", "ScreenshotCaption": "Telemetry showing a file read operation for the monkey.png by rcs.3aka3.doc."}]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10291.png", "ScreenshotCaption": "Telemetry showing ZipFileWritten (file creation) for the zip file SysinternalsSuite.zip."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "Telemetry showed a file write event of python.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10457.png", "ScreenshotCaption": "Telemetry showing a PeFileWritten and NewExecutableWritten events on Scranton for python.exe."}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed an executable file write event for python.exe creating rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10487.png", "ScreenshotCaption": "Telemetry showing python.exe writing Rar.exe and sdelete64.exe."}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed Executable File Write event for python.exe creating sdelete64.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10487.png", "ScreenshotCaption": "Telemetry showing python.exe writing Rar.exe and sdelete64.exe."}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A General detection called \"NewExecutableWritten\" was generated was generated for the PowerShell command to download m.exe.", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-15003.png", "ScreenshotCaption": "14b3-new vendor screenshot"}]}, {"DetectionNote": "Telemetry showed the file write event for m.exe into the System32 folder. The detection was correlated to a parent alert for Execution via Powershell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10634.png", "ScreenshotCaption": "Telemetry showing powershell.exe with an executable write and a file written event for m.exe."}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "Telemetry showed a file write of m.exe to System32 directory by wsmprovhost.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10683.png", "ScreenshotCaption": "Telemetry showing powershell.exe copied m.exe to winrm session."}, {"ScreenshotName": "CrowdStrike-APT29-10689.png", "ScreenshotCaption": "Telemetry showing a file write of m.exe to System32 directory by wsmprovhost.exe."}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "Telemetry showed the deletion of the command subkey. The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10282.png", "ScreenshotCaption": "Telemetry showing powershell.exe deleting the command subkey."}]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "Telemetry showed the deletion of the Registry value.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10619.png", "ScreenshotCaption": "Telemetry showing powershell.exe calling the bypass function."}, {"ScreenshotName": "CrowdStrike-APT29-10627.png", "ScreenshotCaption": "Telemetry showing the powershell script block for the bypass function."}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A General alert detection (yellow indicator) was generated when powershell.exe spawned from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "DetectionType": "General", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10204.png", "ScreenshotCaption": "A general detection showing powershell.exe spawning from cmd.exe."}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10204.png", "ScreenshotCaption": "A general detection showing powershell.exe spawning from cmd.exe."}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed a new powershell.exe spawning from powershell.exe. The detection was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10290.png", "ScreenshotCaption": "Telemetry showing a Powershell.exe process spawning from a powershell.exe process.  Telemetry showing file read operations for the zip file contents."}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "Telemetry showed Python.exe executing powershell.exe\u200b.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10489.png", "ScreenshotCaption": "Telemetry showing Python.exe executing powershell.exe\u200b."}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cPowerShell\u201d was generated for the executed PowerShell stager matching existing malware characteristics. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10588.png", "ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process."}, {"ScreenshotName": "CrowdStrike-APT29-10582.png", "ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process."}]}, {"DetectionNote": "A Technique alert detection (yellow indicator) called \u201cPowerShell\u201d was generated for powershell.exe run with a hidden window and encoded commands.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10587.png", "ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process."}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10582.png", "ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d on the powershell.exe process."}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique alert detection (yellow unique icon) called \u201cPowerShell\u201d was generated when powershell was executed with a hidden window and encoded commands. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10735.png", "ScreenshotCaption": "A Technique detection called \u201cPowerShell\u201d for WmiPrvSE.exe executing powershell with a hidden window and encoded commands."}]}, {"DetectionNote": "A Technique detection called \u201cPShellExploitKit2\u201d was generated by wmiprvse.exe executing powershell.exe as SYSTEM.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10740.png", "ScreenshotCaption": "A General detection called \u201cPShellExploitKit2\u201d for wmiprvse.exe executing powershell.exe as SYSTEM."}]}, {"DetectionNote": "Telemetry showed a SYSTEM-level PowerShell spawning from wmiprvse.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10739.png", "ScreenshotCaption": "Telemetry showing WmiPrvSE.exe executing powershell.exe. Telemetry showing a SYSTEM-level PowerShell spawned from wmiprvse.exe."}]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Technique detection for \"ServiceExecOnSMBFile\" was generated due to PsExec running a python.exe remotely. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-15006.png", "ScreenshotCaption": "8c3 - new vendor screenshot"}]}, {"DetectionNote": "Telemetry showed python.exe spawned from PSEXESVC.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10474.png", "ScreenshotCaption": "Telemetry showing python.exe spawned by PSEXESVC.exe."}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443. The detection was correlated to a parent technique detection for PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10709.png", "ScreenshotCaption": "Telemetry showing net.exe making network connections to public IP over port 443."}, {"ScreenshotName": "CrowdStrike-APT29-10708.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe with command line arguments."}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe establishing a connection to NewYork (10.0.0.4) over port 389. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10454.png", "ScreenshotCaption": "Telemetry showing powershell.exe establishing network connections over port 5985 and port 389."}, {"ScreenshotName": "CrowdStrike-APT29-10451.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Command and Ad-Search.  (no execution on the Scranton host yet?)"}]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "Telemetry showed the System.DirectoryServices.dll module loaded by powershell.exe as well as powershell.exe executing the Get-NetDomainController cmdlet. The detection was correlated to a parent alert on PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10659.png", "ScreenshotCaption": "Telemetry showing Powershell.exe executed get-netdomaincontrollers script."}, {"ScreenshotName": "CrowdStrike-APT29-10664.png", "ScreenshotCaption": "Telemetry showing network connections from Utica to NewYork on port 135."}, {"ScreenshotName": "CrowdStrike-APT29-10662.png", "ScreenshotCaption": "Telemetry showing System.DirectoryServices.dll module loaded by powershell.exe."}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "Telemetry showed a valid logon on Scranton (10.0.1.4) as user Pam.\t", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10476.png", "ScreenshotCaption": "Telemetry showing valid logon on Scranton (10.0.1.4) as user Pam."}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "Telemetry showed a successful logon on NewYork (10.0.0.4) as user MScott. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10679.png", "ScreenshotCaption": "Telemetry showing powershell connecting to NewYork (10.0.0.4) on port 5985. Telemetry showing a successful logon on NewYork as MScott."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Masquerading\" was generated when an executable ran containing a RTLO character.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10177.png", "ScreenshotCaption": "1.A.2 on both write and execution for masquerading"}]}, {"DetectionNote": "An MSSP detection was received that included details of the file rcs.3aka3.doc and identified it as an portable executable.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10183.png", "ScreenshotCaption": "MSSP Alert showing explorer.exe executing the rcs.3aka3.doc file."}, {"ScreenshotName": "CrowdStrike-APT29-10188.png", "ScreenshotCaption": "MSSP Alert for the rcs.3aka3.doc file."}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A General detection called \"HashPupAdwareCrowdStrikeSha256\" was generated when accesschk.exe matched known malicious payload hashes. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "DetectionType": "General", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10366.png", "ScreenshotCaption": "Technique detection showing  showing accesschk.exe matching HashPupAdwareCrowdStrikeSha256 event."}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed rcs.3aka3.doc loading cryptographic libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-15010.png", "ScreenshotCaption": "1a4- new vendor screenshot"}]}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "An MSSP alert showed outbound connection with Cryptographic API calls to C2 server.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10579.png", "ScreenshotCaption": "An MSSP alert showing outbound connection with Cryptographic API calls to c2 server."}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "Telemetry showed the file write of hostui.lnk in the Startup folder. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10347.png", "ScreenshotCaption": "Telemetry showing powershell.exe creating hostui.lnk in the start-up folder correlated to the process tree."}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "Telemetry showed hostui.lnk executing from the Startup Folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10552.png", "ScreenshotCaption": "Telemetry showing hostui.lnk executing from the startup folder and launch cmd to spawn hostui.bat."}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10574.png", "ScreenshotCaption": "Telemetry showing powershell.exe added a Webcache subkey added to Registry."}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \"Software Packing\" was generated when python.exe was written to disk. ", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10468.png", "ScreenshotCaption": "defense evasion via software packing"}]}, {"DetectionNote": "Telemetry showed a packed executable written event for python.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10458.png", "ScreenshotCaption": "Telemetry showing PackedExecutableWritten on Nashua matching the PeFileWritten on Scranton."}, {"ScreenshotName": "CrowdStrike-APT29-10461.png", "ScreenshotCaption": "Telemetry showing the FileSubType_decimal is 4 (UPX) for python.exe."}], "Footnotes": ["A FileSubType_decimal value of 4 is a PE_PACKER_UPX reference in documentation."]}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10257.png", "ScreenshotCaption": "Telemetry showing the  registry modification adding the new delegrate execute value"}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10619.png", "ScreenshotCaption": "Telemetry showing powershell.exe calling the bypass function."}, {"ScreenshotName": "CrowdStrike-APT29-10627.png", "ScreenshotCaption": "Telemetry showing the powershell script block for the bypass function."}]}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection (yellow indicator) was generated for a suspicious file meeting the sensor's low-confidence threshold for a malicious file.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10176.png", "ScreenshotCaption": "A general detection showing explorer.exe executing rcs.3aka.doc."}]}, {"DetectionNote": "An MSSP detection for the suspicious execution of the rcs.3aka3.doc file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10184.png", "ScreenshotCaption": "MSSP Alert for the rcs.3aka3.doc file."}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10179.png", "ScreenshotCaption": "A process tree showing explorer.exe executing rcs.3aka.doc."}]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10567.png", "ScreenshotCaption": "Telemetry showing explorer.exe executing powershell.exe."}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "Telemetry showed PowerShell command used to create the new service javamtsup. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10338.png", "ScreenshotCaption": "Telemetry showing the invoke-persistence step 1 and step 2 scriptblock contents."}, {"ScreenshotName": "CrowdStrike-APT29-10337.png", "ScreenshotCaption": "Telemetry showing the Invoke-Persistence -PersistStep 1 script executing."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe triggered a ScreenshotTakenETW event. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10405.png", "ScreenshotCaption": "Telemetry showing powershell.exe caused a ScreenshotTakenEtw event."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe spawning from rcs.3aka3.doc\u200b. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10196.png", "ScreenshotCaption": "Process tree showing rcs.3aka3.doc\u200b spawning cmd.exe."}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Clipboard. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10413.png", "ScreenshotCaption": "Telemetry showing Get-Clipboard and Get-Keystrokes executing."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERDOMAIN. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}, {"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the NetWkstaGetInfo API. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10611.png", "ScreenshotCaption": "Telemetry showed powershell.exe calling the domain function."}, {"ScreenshotName": "CrowdStrike-APT29-10612.png", "ScreenshotCaption": "Telemetry showed the powershell script block calling the NetWkstaGetInfo API."}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Compress-7Zip with arguments for encryption. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10426.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Exfil."}, {"ScreenshotName": "CrowdStrike-APT29-10427.png", "ScreenshotCaption": "Telemetry showing the Invoke-Exfil script block contents."}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments. The event was correlated to a parent Technique detection for Windows Admin Shares.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10493.png", "ScreenshotCaption": "A Technique detection showing powershell.exe creating the zip file using Rar.exe."}, {"ScreenshotName": "CrowdStrike-APT29-10491.png", "ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments."}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Invoke-Mimikatz to create and inject a golden ticket into current session.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10745.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing the Invoke-Mimikatz command through PowerShell Command Logging."}]}]}]}, {"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "An MSSP report showed sdclt.exe spawned a process that connected to 192.168.0.5 on port 443.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10285.png", "ScreenshotCaption": "Telemetry showing an overwatch alert for the outbound connection by powershell.exe."}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.  The event was correlated to a parent technique detection for Bypass User Account Control of control.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10275.png", "ScreenshotCaption": "Telemetry showing the powershell.exe processing opening and. closing a network connection to 192.168.0.5 on port 443."}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10575.png", "ScreenshotCaption": "11.a.13 - connection activity app view"}, {"ScreenshotName": "CrowdStrike-APT29-10585.png", "ScreenshotCaption": "Telemetry showing certutil.exe decoding kwxn.lock. Telemetry showing powershell.exe making a network connection to 192.168.0.4 to port 443."}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "Telemetry showed network connection to remote host Scranton (10.0.1.4) over port 5985. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10454.png", "ScreenshotCaption": "Telemetry showing powershell.exe establishing network connections over port 5985 and port 389."}]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d was generated when powershell.exe executed Invoke-WinRMSession to connect to remote host NewYork (10.0.0.4) with credentials for user MScott. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10672.png", "ScreenshotCaption": "Telemetry showing powershell executing invoke-winrmsession to NewYork (10.0.0.4). A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing invoke-winrmsession to connect to NewYork (10.0.0.4) with credentials for user MScott."}, {"ScreenshotName": "CrowdStrike-APT29-10678.png", "ScreenshotCaption": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing logging onto NewYork successfully with user MScott."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10679.png", "ScreenshotCaption": "Telemetry showing powershell connecting to NewYork (10.0.0.4) on port 5985. Telemetry showing a successful logon on NewYork as MScott."}, {"ScreenshotName": "CrowdStrike-APT29-10672.png", "ScreenshotCaption": "Telemetry showing powershell executing invoke-winrmsession to NewYork (10.0.0.4). A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing invoke-winrmsession to connect to NewYork (10.0.0.4) with credentials for user MScott."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cExecution via Windows Remote Management\u201d was generated for WinRM execution based on the WSMProvHost process on the remote host Scranton (10.0.1.4).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10753.png", "ScreenshotCaption": " A technique detection called \u201cExecution via Windows Remote Management\u201d for WinRM executing net.exe on Scranton."}]}, {"DetectionNote": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d was generated based on PowerShell executing the Enter-PSSession cmdlet to open a network connection to the remote host Scranton (10.0.1.4).", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10746.png", "ScreenshotCaption": "A Technique detection called \u201cGenericWinRMLateralMovement\u201d for powershell.exe executing Enter-PSSession to Scranton, then invoking a command."}]}, {"DetectionNote": "Telemetry showed PowerShell with an open network connection to the remote host Scranton (10.0.1.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10751.png", "ScreenshotCaption": "activity app network connections from powershell"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique alert detection (red hexagon indicator) for \"Credential Dumping\" was generated when powershell.exe injected into LSASS. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10389.png", "ScreenshotCaption": "Telemetry showing detections associated with powershell.exe dumping credentials from LSASS."}, {"ScreenshotName": "CrowdStrike-APT29-10386.png", "ScreenshotCaption": "Technique detection showing credential dump and access alerts correlated to the initial incident."}, {"ScreenshotName": "CrowdStrike-APT29-10395.png", "ScreenshotCaption": "Technique detection logic showing powershell.exe dumping credentials."}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated LSASS process was accessed by Mimikatz (m.exe). The detection was correlated to a parent alert for Execution via Powershell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10635.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe reading LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process."}, {"ScreenshotName": "CrowdStrike-APT29-10641.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files."}]}, {"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated when m.exe read LSASS memory. The detection was correlated to a parent alert for Execution via Powershell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10635.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe reading LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process."}]}, {"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated when Mimikatz (m.exe) launched. The detection was correlated to a parent alert for Execution via Powershell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10643.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) launching. A Technique detection called \u201cCredential Dumping\u201d for an encoded powershell payload script launching a mimikatz process (m.exe)."}]}, {"DetectionNote": "A Technique alert detection (red indicator) called \u201cCredential Dumping\u201d was generated when the encoded powershell payload script launched a mimikatz process (m.exe) . The detection was correlated to a parent alert for Execution via Powershell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10643.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) launching. A Technique detection called \u201cCredential Dumping\u201d for an encoded powershell payload script launching a mimikatz process (m.exe)."}]}, {"DetectionNote": "A General alert detection (red indicator) called \u201cMachine Learning via Sensor-based ML\u201d was generated when m.exe met machine learning-based on-sensor AV protection\u2019s high confidence threshold for malicious files. The detection was correlated to a parent alert for Execution via Powershell.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10641.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) accessing LSASS process. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files."}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when a remote thread was written to LSASS memory by m.exe (mimikatz).", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10687.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for a thread injecting into LSASS from a signed executable with untrusted root authority. A Technique detection called \u201cCredential Dumping\u201d for a remote thread was being written to LSASS memory by m.exe (mimikatz)."}]}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when a thread was injected into LSASS from a signed executable with untrusted root authority.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10687.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for a thread injecting into LSASS from a signed executable with untrusted root authority. A Technique detection called \u201cCredential Dumping\u201d for a remote thread was being written to LSASS memory by m.exe (mimikatz)."}]}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe allocated executable memory inside of LSASS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10686.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe accessing LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for m.exe injecting code into the LSASS process. A Technique detection called \u201cCredential Dumping\u201d for m.exe allocating executable memory inside of LSASS."}]}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe injected code into the LSASS process.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10686.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe accessing LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for m.exe injecting code into the LSASS process. A Technique detection called \u201cCredential Dumping\u201d for m.exe allocating executable memory inside of LSASS."}]}, {"DetectionNote": "A Technique alert detection  (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe (mimikatz) accessed LSASS memory.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10686.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe accessing LSASS memory. A Technique detection called \u201cCredential Dumping\u201d for m.exe injecting code into the LSASS process. A Technique detection called \u201cCredential Dumping\u201d for m.exe allocating executable memory inside of LSASS."}]}, {"DetectionNote": "A Technique alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated when m.exe read LSASS memory.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10685.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) read LSASS process memory. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files. A Technique detection called \u201cCredential Dumping\u201d for a signed executable with untrusted root authority accessing LSASS."}]}, {"DetectionNote": "A General alert detection (orange indicator) called \u201cCredential Dumping\u201d was generated identifying m.exe as Mimikatz.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10688.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for m.exe (mimikatz) was launching."}]}, {"DetectionNote": "A General alert detection (orange indicator) called \u201cMachine Learning via Sensor-based ML\u201d was generated when m.exe met machine learning-based on-sensor AV protection\u2019s high confidence threshold for malicious files.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10685.png", "ScreenshotCaption": "A Technique detection called \u201cCredential Dumping\u201d for mimikatz (m.exe) read LSASS process memory. A General detection called \u201cMachine Learning via Sensor-based ML\u201d for m.exe meeting on-sensor AV protection\u2019s high confidence threshold for malicious files. A Technique detection called \u201cCredential Dumping\u201d for a signed executable with untrusted root authority accessing LSASS."}]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed powershell.exe loading http libraries.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10589.png", "ScreenshotCaption": "Telemetry showing http module loads for powershell.exe process."}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class AntiVirusProduct. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}, {"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "A Technique detection called \"GenericSoftwareSystemDiscovery\" was generated when WMI was used to query information about firewall products. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-15008.png", "ScreenshotCaption": "4c8 - new vendor screenshot"}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}, {"DetectionNote": "Telemetry showed powershell.exe executing Get-WmiObject...\u200b -Class FireWallProduct. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}, {"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "A Technique detection called \u201cGenericSecuritySoftwareDiscovery\u201d was generated due to PowerShell gwmi query for AntiVirusProduct. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10603.png", "ScreenshotCaption": "A Technique detection called \u201cGenericSecuritySoftwareDiscovery\u201d on powershell.exe process when the detectav function is loaded."}]}, {"DetectionNote": "Telemetry showed PowerShell gwmi query for AntiVirusProduct. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10603.png", "ScreenshotCaption": "A Technique detection called \u201cGenericSecuritySoftwareDiscovery\u201d on powershell.exe process when the detectav function is loaded."}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetGroups API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10313.png", "ScreenshotCaption": "Telemetry showing the  invoke-netusergetgroups script block contents."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the NetUserGetLocalGroups API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10312.png", "ScreenshotCaption": "Telemetry showing the  invoke-netusergetlocalgroups script block contents."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10308.png", "ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process, correlated to the process tree."}, {"ScreenshotName": "CrowdStrike-APT29-10307.png", "ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process."}, {"ScreenshotName": "CrowdStrike-APT29-10313.png", "ScreenshotCaption": "Telemetry showing the  invoke-netusergetgroups script block contents."}]}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed Netapi32.dll loaded into powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10312.png", "ScreenshotCaption": "Telemetry showing the  invoke-netusergetlocalgroups script block contents."}, {"ScreenshotName": "CrowdStrike-APT29-10308.png", "ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process, correlated to the process tree."}, {"ScreenshotName": "CrowdStrike-APT29-10307.png", "ScreenshotCaption": "Telemetry showing netapi32.dll loading into the powershell.exe process."}]}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "Telemetry showed that PowerShell loaded Advapi32.dll in order to execute the ConvertSidToStringSid API function. The detection was correlated to a parent alert for PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10666.png", "ScreenshotCaption": "Telemetry showing ConvertSidToStringSid script block which calls ConvertSidToStringSid API."}, {"ScreenshotName": "CrowdStrike-APT29-10668.png", "ScreenshotCaption": "Telemetry showing advapi32.dll was loaded by powershell.exe."}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "Telemetry showed file opens of C:\\Users\\Pam\\*. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10221.png", "ScreenshotCaption": "Telemetry showing powershell.exe reading files from  C:\\Users\\Pam\\*."}]}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe reading files from C:\\Users\\pam\\Downloads. The detection was correlated to a parent alert for User Execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10433.png", "ScreenshotCaption": "Telemetry showing Powershell.exe reading files from C:\\Users\\pam\\Downloads."}, {"ScreenshotName": "CrowdStrike-APT29-10427.png", "ScreenshotCaption": "Telemetry showing the Invoke-Exfil script block contents."}]}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of OfficeSupplies.7z being copied over the network to a remote adversary WebDav network share (192.168.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10442.png", "ScreenshotCaption": "overwatch information"}]}, {"DetectionNote": "Telemetry showed PowerShell Copy-Item to a remote adversary WebDav network share (192.168.0.4). The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10426.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Exfil."}, {"ScreenshotName": "CrowdStrike-APT29-10427.png", "ScreenshotCaption": "Telemetry showing the Invoke-Exfil script block contents."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Copy-Item to exfiltrate data to a previously mapped OneDrive account. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10704.png", "ScreenshotCaption": "Telemetry from Scriptblock logging showing powershell.exe executing Copy-Item."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "Telemetry showed accesschk.exe reading the Chrome database file for credentials. Detection incurred a delay based on accesschk.exe executing in a malware detonation chamber where the results were later available to an analyst.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Processing)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10377.png", "ScreenshotCaption": "Telemetry from malware detonation chamber showing strings containing PDB pathways."}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "Telemetry showed script block with commands to timestomp kxwn.lock. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10598.png", "ScreenshotCaption": "Telemetry showing powershell executing timestomp to enumerate System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019)."}, {"ScreenshotName": "CrowdStrike-APT29-10599.png", "ScreenshotCaption": "Telemetry showing timestomp script block which enumerates System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019)."}]}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10569.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing schemas ADS via Get-Content and IEX."}, {"ScreenshotName": "CrowdStrike-APT29-10568.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing schemas ADS via Get-Content and IEX."}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "Telemetry showed scriptblock with registry query for installed software.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10605.png", "ScreenshotCaption": "Telemetry showing powershell.exe calling the software function."}, {"ScreenshotName": "CrowdStrike-APT29-10604.png", "ScreenshotCaption": "Telemetry showing the powershell script block for the software module."}]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "Telemetry showed script block with registry query for installed software. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10604.png", "ScreenshotCaption": "Telemetry showing the powershell script block for the software module."}, {"ScreenshotName": "CrowdStrike-APT29-10605.png", "ScreenshotCaption": "Telemetry showing powershell.exe calling the software function."}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10216.png", "ScreenshotCaption": "Telemetry showing powershell.exe compressing via Compress-Archive."}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "Telemetry showed the file write event for OfficeSupplies.7z. The event was correlated to a parent General detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10432.png", "ScreenshotCaption": "7zip compress and file open (7zipfilewritten)"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection (purple indicator) called \"Data Compressed\" was generated due to powershell.exe executing rar.exe with command-line arguments indicative of compression. The event was correlated to a parent Technique detection for Windows Admin Shares.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10493.png", "ScreenshotCaption": "A Technique detection showing powershell.exe creating the zip file using Rar.exe."}, {"ScreenshotName": "CrowdStrike-APT29-10491.png", "ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments."}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.The event was correlated to a parent Technique detection for Windows Admin Shares.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10491.png", "ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments."}, {"ScreenshotName": "CrowdStrike-APT29-10492.png", "ScreenshotCaption": "9.b.5/6/7 rar creating the rar file and being spawn from powershell in the activity app"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "Telemetry showed PowerShell compressing collection via ZipFile.CreateFromDirectory .NET method and the subsequent ZipFileWritten event. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10701.png", "ScreenshotCaption": "Telemetry showing ZipFileWritten event for powershell on WindowsParentalControlMigration. Telemetry showing PowerShell prepending the GIF file header to the compressed file."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "Telemetry showed file read event for Draft.zip and an existing C2 channel (192.168.0.5 over port 1234). The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10192.png", "ScreenshotCaption": "Telemetry showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234."}, {"ScreenshotName": "CrowdStrike-APT29-10254.png", "ScreenshotCaption": "Telemetry correlating the draft.zip file read to rcs.3aka3.doc."}]}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10298.png", "ScreenshotCaption": "Telemetry showing  powershell.exe executing Get-Process. "}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $PID. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}, {"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Get-Process.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10451.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing Invoke-Command and Ad-Search.  (no execution on the Scranton host yet?)"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the CreateToolhelp32Snapshot API.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10615.png", "ScreenshotCaption": "Telemetry showed the powershell script block calling the CreateToolhelp32Snapshot API."}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Get-Process. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10647.png", "ScreenshotCaption": "Telemetry showing PowerShell executing Get-Process. Telemetry showing PowerShell executing Get-WmiObject to read encoded content from Win32_AuditCode."}]}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "A Technique alert detection called \"Input Capture\" was generated when a process performed reads of the user key buffers. The event was correlated to a parent General detection for User Execution of rcs.3aka.doc.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10414.png", "ScreenshotCaption": "Telemetry showing the GetAsyncKeyStateEtwBatch caused the technique detection."}, {"ScreenshotName": "CrowdStrike-APT29-10408.png", "ScreenshotCaption": "A Technique detection for \"Input Capture\" showing powershell used GetAsyncKeyState API."}]}, {"DetectionNote": "Telemetry showed PowerShell calling the GetAsyncKeyState API. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10414.png", "ScreenshotCaption": "Telemetry showing the GetAsyncKeyStateEtwBatch caused the technique detection."}, {"ScreenshotName": "CrowdStrike-APT29-10413.png", "ScreenshotCaption": "Telemetry showing Get-Clipboard and Get-Keystrokes executing."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:USERNAME. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}, {"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the GetUserNameEx API. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10616.png", "ScreenshotCaption": "Telemetry showed the powershell script block calling the GetUserNameEx API."}, {"ScreenshotName": "CrowdStrike-APT29-10613.png", "ScreenshotCaption": "Telemetry showed powershell.exe calling the user function."}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "Telemetry showed PowerShell script block executing $env:UserName. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10656.png", "ScreenshotCaption": "Telemetry showing wmi script block which executes $env:Username."}, {"ScreenshotName": "CrowdStrike-APT29-10657.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing wmi function."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing the ConvertSidToStringSid API function. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10666.png", "ScreenshotCaption": "Telemetry showing ConvertSidToStringSid script block which calls ConvertSidToStringSid API."}, {"ScreenshotName": "CrowdStrike-APT29-10667.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing siduser function (which calls ConvertSidToStringSid function)."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10208.png", "ScreenshotCaption": "Telemetry showing the Powershell script that was executed.  View in process explorer allows you to see that the script was executed from the Powershell process."}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:TEMP. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}, {"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10490.png", "ScreenshotCaption": "Telemetry showing Powershell.exe executing Get-ChildItem\u200b."}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "Telemetry showed PowerShell enumeration of System32. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10598.png", "ScreenshotCaption": "Telemetry showing powershell executing timestomp to enumerate System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019)."}, {"ScreenshotName": "CrowdStrike-APT29-10599.png", "ScreenshotCaption": "Telemetry showing timestomp script block which enumerates System32: (gci ((gci env:windir).Value + \u2018\\system32\u2019)."}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"File Deletion\" was generated due to sdelete64.exe deleting rcs.3aka3.doc. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10360.png", "ScreenshotCaption": "4.b sdelete alert of the suspicious file"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename events. The detection was correlated to a parent alert for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10296.png", "ScreenshotCaption": "Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc."}, {"ScreenshotName": "CrowdStrike-APT29-10328.png", "ScreenshotCaption": "Telemetry showing the file rename and delete operations for rcs.3aka3.doc."}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. The detection was correlated to a parent alert for user execution of Draft.zip.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10296.png", "ScreenshotCaption": "Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc."}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "Telemetry showed file rename and delete operations from sdelete64.exe deleting SysinternalsSuite.zip. The detection was correlated to a parent alert for user execution of SysinternalsSuite.zip.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10296.png", "ScreenshotCaption": "Telemetry showing sdelete64.exe deleting SysinternalsSuite.zip, Draft.zip, and rcs.3aka.doc."}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete rar.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10511.png", "ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe."}, {"ScreenshotName": "CrowdStrike-APT29-10512.png", "ScreenshotCaption": "Telemetry showing cmd.exe spawning sdelete64.exe."}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Desktop\\working.zip. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10511.png", "ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe."}, {"ScreenshotName": "CrowdStrike-APT29-10512.png", "ScreenshotCaption": "Telemetry showing cmd.exe spawning sdelete64.exe."}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "Telemetry showed sdelete64.exe with command-line arguments to delete Roaming\\working.zip. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10511.png", "ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe."}, {"ScreenshotName": "CrowdStrike-APT29-10512.png", "ScreenshotCaption": "Telemetry showing cmd.exe spawning sdelete64.exe."}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed an ExecutableDeleted event for sdelete64.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10511.png", "ScreenshotCaption": "Telemetry showing delete64.exe deleting Rar.exe, working.zip, and %APPDATA%\\working.zip. Telemetry showing an ExecutableDeleted event for sdelete64.exe."}]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10694.png", "ScreenshotCaption": "Telemetry showing outlook.exe spawning from svchost.exe."}]}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "A Technique alert detection called \"Access Token Manipulation\" was generated for token stealing activity.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10557.png", "ScreenshotCaption": "Technique detection for access token manipulation tied to the powershell.exe in process tree."}]}, {"DetectionNote": "Telemetry showed powershell.exe executing with the same token (identified by the AuthenticationID) as explorer.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10562.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing with explorer.exe token."}]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "Telemetry showed PowerShell decompressing the ZIP via Expand-Archive and corresponding file writes. The event was correlated to a parent alert for Bypass User Account Control of control.exe spawning powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10293.png", "ScreenshotCaption": "Telemetry showing powershell.exe decompressing via Expand-Archive."}, {"ScreenshotName": "CrowdStrike-APT29-10295.png", "ScreenshotCaption": "Telemetry showing powershell.exe file write operations from decompressing via Expand-Archive."}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (high severity) called \u201cDeobfuscate/Decode Files or Information\u201d was generated when certutil.exe decoded a malicious payload.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10581.png", "ScreenshotCaption": "A technique detection called \u201cDeobfuscate/Decode Files or Information\u201d on the certutil.exe process."}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding PE file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10585.png", "ScreenshotCaption": "Telemetry showing certutil.exe decoding kwxn.lock. Telemetry showing powershell.exe making a network connection to 192.168.0.4 to port 443."}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell reading encoded content from the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10647.png", "ScreenshotCaption": "Telemetry showing PowerShell executing Get-Process. Telemetry showing PowerShell executing Get-WmiObject to read encoded content from Win32_AuditCode."}]}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique alert detection (purple hexagon) called \u201cCreate Account\u201d was generated for the addition of the new user Toby.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10748.png", "ScreenshotCaption": "A Technique detection called \u201cCreate Account\u201d for a user creating a new user account. A Technique detection called \u201cCreate Account\u201d for WinRM executing a file to create an account."}]}, {"DetectionNote": "A Technique detection called \u201cGenericCreateAccountPersistence\u201d was generated for the addition of the new user Toby.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10747.png", "ScreenshotCaption": "A Technique detection called \u201cGenericCreateAccountPersistence\u201d for account creation of Toby on Scranton via Invoke-Command."}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10752.png", "ScreenshotCaption": "Telemetry showing powershell.exe executing net.exe to add a user."}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "Telemetry showed file creation of Draft.zip.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10759.png", "ScreenshotCaption": "Telemetry showing the draft.zip file being written."}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "Telemetry showed a ZipFileWritten event for the creation of working.zip.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10496.png", "ScreenshotCaption": "Telemetry showing ZipFileWritten event."}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "A Technique detection for \"WmiFilterConsumerBind\" was generated due to the WindowsParentalControlMigration event filter creation. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-15451.png", "ScreenshotCaption": "15a2 - new vendor screen"}]}, {"DetectionNote": "Telemetry showed the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10655.png", "ScreenshotCaption": "Telemetry showing WMI filter command line."}, {"ScreenshotName": "CrowdStrike-APT29-10654.png", "ScreenshotCaption": "Telemetry showing WMI filter, consumer, and binding created in root/subscription."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Technique detection for \"WmiFilterConsumerBind\" was generated due to PowerShell being executed by WMI. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-15009.png", "ScreenshotCaption": "20a2 - new vendor screenshot"}]}, {"DetectionNote": "Telemetry showed wmiprvse.exe executing the PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10739.png", "ScreenshotCaption": "Telemetry showing WmiPrvSE.exe executing powershell.exe. Telemetry showing a SYSTEM-level PowerShell spawned from wmiprvse.exe."}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing $env:COMPUTERNAME. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}, {"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "Telemetry showed powershell.exe executing Gwmi Win32_OperatingSystem. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10306.png", "ScreenshotCaption": "Telemetry showing invoke-discovery function executing."}, {"ScreenshotName": "CrowdStrike-APT29-10305.png", "ScreenshotCaption": "Telemetry showing the invoke-discovery script block contents."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "Telemetry showed PowerShell calling the GetComputerNameEx API. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10608.png", "ScreenshotCaption": "Telemetry showed the powershell script block calling the GetComputerNameEx API."}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Windows Admin Shares\" was generated when python.exe was copied to Scranton via SMB.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10491.png", "ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments."}]}, {"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 135.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10491.png", "ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments."}, {"ScreenshotName": "CrowdStrike-APT29-10483.png", "ScreenshotCaption": "Telemetry showing connection from nashua to 10.0.1.4 over port 135."}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe. The detection was correlated to a parent alert for execution via PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10633.png", "ScreenshotCaption": "Telemetry showing WmiPrvSE.exe executed powershell.exe."}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (purple hexagon) called \"Bypass User Account Control\" was generated when control.exe spawned an elevated PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10265.png", "ScreenshotCaption": "Technique detection for \"Bypass User Account Control\" showing control.exe spawning an elevated powershell correlated with res.3aka3.doc."}]}, {"DetectionNote": "A Tactic alert detection (purple hexagon) called \"Defense Evasion\" was generated when a process reflectively loaded a DLL associated with meterpreter using the PowerShell payload. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10261.png", "ScreenshotCaption": "3.b.2 incident view mode for monkey file being read by Powershell to deobfuscate"}]}, {"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10272.png", "ScreenshotCaption": "Telemetry showing the integrity level of the elevated powershell process running."}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) called \u201cBypass User Account Control\u201d was generated when the parent powershell.exe process of sdclt.exe attempted to escalated privileges with UAC bypass or UAC elevation. The event was correlated to a parent Technique detection for PowerShell.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10625.png", "ScreenshotCaption": "A Technique detection called \u201cBypass User Account Control\u201d from the parent powershell.exe process of sdclt.exe attempting to escalated privileges with UAC bypass or UAC elevation."}]}, {"DetectionNote": "A Tactic alert detection (red indicator) called \u201cPrivilege Escalation \u2013 Access Token Manipulation\u201d was generated powershell.exe impersonated another user via access token manipulation. The event was correlated to a parent technique detection for PowerShell.", "DetectionType": "Tactic", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10620.png", "ScreenshotCaption": "Tactic detection for \u201cPrivilege Escalation \u2013 Access Token Manipulation\u201d from a powershell.exe process escalating privileges via UAC elevation or token theft. Tactic detection for \u201cPrivilege Escalation \u2013 Access Token Manipulation\u201d from powershell.exe impersonating another user via access token manipulation."}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe).  The event was correlated to a parent technique detection for PowerShell.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10629.png", "ScreenshotCaption": "Telemetry showing high integrity powershell spawned."}]}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "A Technique alert (high severity) was generated for PowerShell using obfuscation. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10259.png", "ScreenshotCaption": "3.b.1 Powershell executing against the obfuscated monkey.png in falcon activity app view"}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-15011.png", "ScreenshotCaption": "3a2 - new vendor screenshot"}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell writing encoded content into the WMI class. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10653.png", "ScreenshotCaption": "Telemetry showing PowerShell executing Set-WmiObject to write encoded content from Win32_AuditCode via the download cradle."}, {"ScreenshotName": "CrowdStrike-APT29-10649.png", "ScreenshotCaption": "Telemetry showing PowerShell executing Set-WmiObject to write encoded content from Win32_AuditCode."}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "Telemetry showed PowerShell appending the GIF file header to the compressed file. The detection was correlated to a parent grouping of malicious activity.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10701.png", "ScreenshotCaption": "Telemetry showing ZipFileWritten event for powershell on WindowsParentalControlMigration. Telemetry showing PowerShell prepending the GIF file header to the compressed file."}], "Footnotes": ["All activity associated with an alert is grouped and correlated via the relevant detection tree."]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "An MSSP detection was generated for rcs.3aka3.doc connecting to 192.168.0.5 on port 1234.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10190.png", "ScreenshotCaption": "MSSP alert showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234."}]}, {"DetectionNote": "Telemetry showed the rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10192.png", "ScreenshotCaption": "Telemetry showing rcs.3aka3.doc process connecting to 192.168.0.5 on TCP port 1234."}]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": [], "Footnotes": ["PowerShell script block content for this step was collected on sensor, but at execution time did not meet confidence threshold to be sent to cloud for further analysis."]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "A Technique alert detection (purple hexagon) called \"Automated Collection\" was generated when powershell.exe executed an automated search routine with Get-ChildItem. The event was correlated to a parent general detection for user execution of rcs.3aka.doc.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10205.png", "ScreenshotCaption": "A Technique detection called \"Automated Collection\" showing powershell executed an automated collection routine."}]}, {"DetectionNote": "An MSSP alert was generated when a portable executable file used a script to collected various filetypes found on the filesystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10262.png", "ScreenshotCaption": "An MSSP alert showing a powershell script collecting data for file types from the filesystem."}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10208.png", "ScreenshotCaption": "Telemetry showing the Powershell script that was executed.  View in process explorer allows you to see that the script was executed from the Powershell process."}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "A Technique alert detection (yellow indicator) called \"Automated Collection\" was generated when powershell.exe executed Get-ChildItem. The event was correlated to a parent Technique detection for Windows Admin Shares.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10491.png", "ScreenshotCaption": "A Technique detection called \"Windows Admin Shares\" created from an executable file being written via SMB.  A technique detection called \"Automated Collection\" created when powershell.exe ran an automated search routine. A technique detection called \"Data Compressed\" created when a Rar archive was written with suspicious command line arguments."}, {"ScreenshotName": "CrowdStrike-APT29-10493.png", "ScreenshotCaption": "A Technique detection showing powershell.exe creating the zip file using Rar.exe."}]}, {"DetectionNote": "Telemetry showed Powershell.exe executing ChildItem\u200b.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "CrowdStrike-APT29-10490.png", "ScreenshotCaption": "Telemetry showing Powershell.exe executing Get-ChildItem\u200b."}]}]}]}]}