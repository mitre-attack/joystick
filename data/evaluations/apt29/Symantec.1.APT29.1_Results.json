{"PublicRelease": "\u00a92020 The MITRE Corporation. ALL RIGHTS RESERVED. Approved for Public Release; Distribution Unlimited. Public Release Case Number 19-03607-4", "Techniques": [{"TechniqueId": "T1043", "TechniqueName": "Commonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.3", "Procedure": "Established C2 channel (192.168.0.5) via PowerShell payload over TCP port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell connected to 192.168.0.5 on port 443.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7402.png", "ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection."}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting to 192.168.0.5 on port 443.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7402.png", "ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection."}]}]}, {"SubStep": "11.A.13", "Procedure": "Established C2 channel (192.168.0.4) via PowerShell payload over port 443", "Criteria": "Established network channel over port 443", "Detections": [{"DetectionNote": "An MSSP detection for \"Commonly Used Port\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 over port 443. A detailed analysis of the script was also provided.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12954.png", "ScreenshotCaption": "MSSP Day 1: stager script explanation"}, {"ScreenshotName": "Symantec-APT29-12953.png", "ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to the C2 (192.168.0.4) over port 443. ", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9867.png", "ScreenshotCaption": "Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1140", "TechniqueName": "Deobfuscate/Decode Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.A.3", "Procedure": "Decompressed ZIP (SysinternalsSuite.zip) file using PowerShell", "Criteria": "powershell.exe executing Expand-Archive", "Detections": [{"DetectionNote": "A General alert detection was generated for \"PowerShell created a suspicious file\" on PowerShell writing the files that were decompressed from the ZIP. ", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17583.png", "ScreenshotCaption": "Gen alert 4a3"}]}, {"DetectionNote": "Telemetry showed PowerShell writing the files that were decompressed from the ZIP. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7411.png", "ScreenshotCaption": "List of file creations by powershell.exe"}]}]}, {"SubStep": "11.A.10", "Procedure": "Decoded an embedded DLL payload to disk using certutil.exe", "Criteria": "certutil.exe decoding kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection (red indicator) for \"Deobfuscate/Decode Files or Information\" was generated when certutil decoded data and created an executable file.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9709.png", "ScreenshotCaption": "Certutil execeution, created an executable file. Tagged with Deobfuscated File or Information"}, {"ScreenshotName": "Symantec-APT29-12850.png", "ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution"}, {"ScreenshotName": "Symantec-APT29-12902.png", "ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution"}]}, {"DetectionNote": "An MSSP detection for \"Deobfuscate/Decode Files or Information\" was received that included details on execution of certutil.exe by the adversary and explained that it was used to decode a fake certificate file into a DLL.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12950.png", "ScreenshotCaption": "MSSP Day 1: Deobfuscate"}, {"ScreenshotName": "Symantec-APT29-12951.png", "ScreenshotCaption": "MSSP Day 1: Deobfuscate description"}]}, {"DetectionNote": "Telemetry showed the certutil.exe process and corresponding file write of the kxwn.lock payload.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12850.png", "ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution"}, {"ScreenshotName": "Symantec-APT29-12902.png", "ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution"}, {"ScreenshotName": "Symantec-APT29-9709.png", "ScreenshotCaption": "Certutil execeution, created an executable file. Tagged with Deobfuscated File or Information"}]}]}, {"SubStep": "14.B.6", "Procedure": "Read and decoded Mimikatz output from a WMI class property using PowerShell", "Criteria": "powershell.exe executing Get-WmiInstance", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1122", "TechniqueName": "Component Object Model Hijacking", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.B.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of\u00a0the DelegateExecute\u00a0\u200bsubkey in\u00a0\u200bHKCU\\Software\\Classes\\Folder\\shell\\open\\\u200b\u200bcommand\u200b\u200b", "Detections": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry Value.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9910.png", "ScreenshotCaption": "powershell.exe creating DelegateExecute registry key"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}, {"SubStep": "14.A.1", "Procedure": "Modified the Registry to enable COM hijacking of sdclt.exe using PowerShell", "Criteria": "Addition of the DelegateExecute subkey in HKCU\\Software\\Classes\\Folder\\shell\\open\\command", "Detections": [{"DetectionNote": "Telemetry showed the addition of the DelegateExecute Registry value. ", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9870.png", "ScreenshotCaption": "powershell.exe set DelegateExecute registry value"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1016", "TechniqueName": "System Network Configuration Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.4", "Procedure": "Enumerated the current domain name using PowerShell", "Criteria": "powershell.exe executing $env:USERDOMAIN", "Detections": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the user's domain name.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}, {"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}]}]}, {"SubStep": "11.A.7", "Procedure": "Checked that the computer is joined to a domain using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system's network configuration.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12948.png", "ScreenshotCaption": "MSSP Day 1: Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12949.png", "ScreenshotCaption": "MSSP Day 1: Discovery description"}]}]}, {"SubStep": "13.B.1", "Procedure": "Enumerated the domain name using the NetWkstaGetInfo API", "Criteria": "powershell.exe executing the NetWkstaGetInfo API", "Detections": [{"DetectionNote": "An MSSP detection for \"System Network Configuration Discovery\" occurred containing evidence of PowerShell calling the NetWkstaGetInfo API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12961.png", "ScreenshotCaption": "MSSP Day 1: Discovery script details"}, {"ScreenshotName": "Symantec-APT29-12960.png", "ScreenshotCaption": "MSSP Day 1: Discovery techniques"}]}]}]}, {"TechniqueId": "T1005", "TechniqueName": "Data from Local System", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.3", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "7.B.1", "Procedure": "Read data in the user's Downloads directory using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\pam\\Downloads\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.4", "Procedure": "Recursively collected files found in C:\\Users\\Pam\\ using PowerShell", "Criteria": "powershell.exe reading files in C:\\Users\\Pam\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "17.B.1", "Procedure": "Read and collected a local file using PowerShell", "Criteria": "powershell.exe reading the file MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1136", "TechniqueName": "Create Account", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "20.B.3", "Procedure": "Added a new user to the remote host Scranton (10.0.1.4) using net.exe", "Criteria": "net.exe adding the user Toby ", "Detections": [{"DetectionNote": "A Technique detection for \"Create Account\" was generated for wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9862.png", "ScreenshotCaption": "wsmprovhost.exe executed net.exe on scranton to add user toby"}]}, {"DetectionNote": "Telemetry showed wsmprovhost.exe spawning net.exe with the command-line arguments to add the new user Toby.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9862.png", "ScreenshotCaption": "wsmprovhost.exe executed net.exe on scranton to add user toby"}]}]}]}, {"TechniqueId": "T1012", "TechniqueName": "Query Registry", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "12.C.1", "Procedure": "Enumerated installed software via the Registry (Wow6432 Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection for \"Query Registry\" occurred that containing registry query for installed software.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12959.png", "ScreenshotCaption": "MSSP Day 1: Query Registry description"}, {"ScreenshotName": "Symantec-APT29-12958.png", "ScreenshotCaption": "MSSP Day 1: Query Registry technique"}]}]}, {"SubStep": "12.C.2", "Procedure": "Enumerated installed software via the Registry (Uninstall key) using PowerShell", "Criteria": "powershell.exe executing a Registry query for HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall", "Detections": [{"DetectionNote": "An MSSP detection for \"Query Registry\" occurred that containing registry query for installed software.", "DetectionType": "MSSP", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12959.png", "ScreenshotCaption": "MSSP Day 1: Query Registry description"}, {"ScreenshotName": "Symantec-APT29-12958.png", "ScreenshotCaption": "MSSP Day 1: Query Registry technique"}]}]}]}, {"TechniqueId": "T1060", "TechniqueName": "Registry Run Keys / Startup Folder", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.B.1", "Procedure": "Created a LNK file (hostui.lnk) in the Startup folder that executes on login", "Criteria": "powershell.exe creating the file hostui.lnk in the Startup folder", "Detections": [{"DetectionNote": "A Technique detection for \"Registry Run Keys / Startup Folder\" was generated due to powershell.exe creating the hostui.lnk file.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7433.png", "ScreenshotCaption": "File creation of hostui.lnk in startup folder, tagged with \"Registry Run Keys / Startup Folder\"."}]}, {"DetectionNote": "Telemetry showed creation of hostui.lnk in the Startup folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7433.png", "ScreenshotCaption": "File creation of hostui.lnk in startup folder, tagged with \"Registry Run Keys / Startup Folder\"."}]}]}, {"SubStep": "10.B.1", "Procedure": "Executed LNK payload (hostui.lnk) in Startup Folder on user login", "Criteria": "Evidence that the file hostui.lnk (which executes hostui.bat as a byproduct) was executed from the Startup Folder", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though execution of hostui.bat was observed.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7495.png", "ScreenshotCaption": "explorer launched cmd.exe to run hostui.bat"}]}]}, {"SubStep": "11.A.11", "Procedure": "Established Registry Run key persistence using PowerShell", "Criteria": "Addition of the Webcache subkey in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", "Detections": [{"DetectionNote": "A Technique detection for \"Registry Run Keys / Startup Folder\" was generated for powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9714.png", "ScreenshotCaption": "powershell.exe setting registry key, tagged with Registry Run Key persistence."}, {"ScreenshotName": "Symantec-APT29-9713.png", "ScreenshotCaption": "Details of registry key creation event."}]}, {"DetectionNote": "An MSSP detection for \"Registry Run Keys / Startup Folder\" was received that included a PowerShell command executed by the adversary and explained that it was used to set a Registry Run Key. A detailed analysis of the malicious payload was also provided. [SE: see comment]", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12952.png", "ScreenshotCaption": "MSSP Day 1: Registry Run Keys"}]}, {"DetectionNote": "Telemetry showed powershell.exe adding Run key persistence into the Registry.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9714.png", "ScreenshotCaption": "powershell.exe setting registry key, tagged with Registry Run Key persistence."}, {"ScreenshotName": "Symantec-APT29-9716.png", "ScreenshotCaption": "powershel.exe setting registry value for persistence with kxwn.lock file, tagged with Registry Run Keys / Startup Folder"}]}]}]}, {"TechniqueId": "T1097", "TechniqueName": "Pass the Ticket", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "20.B.1", "Procedure": "Created Kerberos Golden Ticket using\u00a0Invoke-Mimikatz", "Criteria": "powershell.exe executing Invoke-Mimikatz with command-line arguments to create a golden ticket", "Detections": [{"DetectionNote": "Telemetry showed WinRM activity as MScott from Scranton (10.0.1.4) to Utica (10.0.1.5) with a Kerberos ticket in memory for MScott on Scranton (10.0.1.4). ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17735.png", "ScreenshotCaption": "20b1 - multiple telemetry bundled up"}]}]}]}, {"TechniqueId": "T1099", "TechniqueName": "Timestomp", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "12.A.2", "Procedure": "Modified the time attributes of the kxwn.lock persistence payload using PowerShell", "Criteria": "powershell.exe modifying the creation, last access, and last write times of kxwn.lock", "Detections": [{"DetectionNote": "An MSSP detection for \"Timestomp\" occurred containing evidence of timestamp modifications of kxwn.lock.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12956.png", "ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp explanations"}, {"ScreenshotName": "Symantec-APT29-12955.png", "ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp techniques"}]}, {"DetectionNote": "Telemetry showed powershell.exe setting the file attributes of kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9869.png", "ScreenshotCaption": "powershell.exe set attributes of kxwn.lock file"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1057", "TechniqueName": "Process Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.B.1", "Procedure": "Enumerated current running processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of powershell.exe executing Get-Process.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12911.png", "ScreenshotCaption": "MSSP Day 1: Process Discovery name"}, {"ScreenshotName": "Symantec-APT29-12910.png", "ScreenshotCaption": "MSSP Day 1: Process Discovery description"}]}]}, {"SubStep": "4.C.5", "Procedure": "Enumerated the current process ID using PowerShell", "Criteria": "powershell.exe executing $PID", "Detections": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected the current PID.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}, {"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}]}]}, {"SubStep": "8.A.3", "Procedure": "Enumerated processes on remote host Scranton (10.0.1.4) using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included PowerShell commands run by the adversary and explained that they were used to enumerate running processes on remote host Scranton (10.0.1.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12975.png", "ScreenshotCaption": "MSSP Day 1: remote process discovery"}]}]}, {"SubStep": "11.A.8", "Procedure": "Checked that processes such as procexp.exe, taskmgr.exe, or wireshark.exe are not running using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_Process", "Detections": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate running processes on the local system.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12948.png", "ScreenshotCaption": "MSSP Day 1: Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12949.png", "ScreenshotCaption": "MSSP Day 1: Discovery description"}]}]}, {"SubStep": "13.D.1", "Procedure": "Enumerated running processes using the CreateToolhelp32Snapshot API", "Criteria": "powershell.exe executing the CreateToolhelp32Snapshot API", "Detections": [{"DetectionNote": "An MSSP detection for \"Process Discovery\" occurred containing evidence of an executed PowerShell command used to enumerate running processes on the local machine.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12965.png", "ScreenshotCaption": "MSSP Day 1: Process Discovery"}, {"ScreenshotName": "Symantec-APT29-12962.png", "ScreenshotCaption": "MSSP Day 1: wmidump"}]}]}, {"SubStep": "14.B.2", "Procedure": "Enumerated and tracked PowerShell processes using PowerShell", "Criteria": "powershell.exe executing Get-Process", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1033", "TechniqueName": "System Owner/User Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.2", "Procedure": "Enumerated the current username using PowerShell", "Criteria": "powershell.exe executing $env:USERNAME", "Detections": [{"DetectionNote": "A MSSP detection for \"System Owner/User Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the User Name.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}]}]}, {"SubStep": "11.A.6", "Procedure": "Checked that the username is not related to admin or a generic value (ex: user) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to query the system owner.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12948.png", "ScreenshotCaption": "MSSP Day 1: Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12949.png", "ScreenshotCaption": "MSSP Day 1: Discovery description"}]}]}, {"SubStep": "13.C.1", "Procedure": "Enumerated the current username using the GetUserNameEx API", "Criteria": "powershell.exe executing the GetUserNameEx API", "Detections": [{"DetectionNote": "An MSSP detection for \"System Owner/User Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to obtain the username.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12960.png", "ScreenshotCaption": "MSSP Day 1: Discovery techniques"}, {"ScreenshotName": "Symantec-APT29-12961.png", "ScreenshotCaption": "MSSP Day 1: Discovery script details"}]}]}, {"SubStep": "15.A.1", "Procedure": "Enumerated logged on users using PowerShell", "Criteria": "powershell.exe executing $env:UserName", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "16.B.1", "Procedure": "Enumerated the domain SID (from current user SID) using\u00a0the ConvertSidToStringSid API", "Criteria": "powershell.exe executing the ConvertSidToStringSid API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1041", "TechniqueName": "Exfiltration Over Command and Control Channel", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.B.1", "Procedure": "Read and downloaded ZIP (Draft.zip) over C2 channel (192.168.0.5 over TCP port 1234)", "Criteria": "The rcs.3aka3.doc process reading the file draft.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "9.B.8", "Procedure": "Read and downloaded ZIP (working.zip on Desktop) over C2 channel (192.168.0.5 over TCP port 8443)", "Criteria": "python.exe\u00a0reading the file working.zip while connected to the C2 channel", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1134", "TechniqueName": "Access Token Manipulation", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "10.B.3", "Procedure": "Manipulated the token of the PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe manipulating the token of powershell.exe via the CreateProcessWithToken API OR \npowershell.exe executing with the stolen token of explorer.exe", "Detections": [{"DetectionNote": "Telemetry shows powershell.exe's security_descriptor obtaining the same value as explorer.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17702.png", "ScreenshotCaption": "10b3 - telemetry on powershell security descriptor manipulation"}]}]}]}, {"TechniqueId": "T1069", "TechniqueName": "Permission Groups Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.9", "Procedure": "Enumerated user's domain group membership via the NetUserGetGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetGroups\u00a0API", "Detections": [{"DetectionNote": "A MSSP detection for \"Permissions Groups Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of global groups.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}, {"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}]}]}, {"SubStep": "4.C.11", "Procedure": "Enumerated user's local group membership via\u00a0the NetUserGetLocalGroups API", "Criteria": "powershell.exe\u00a0executing the NetUserGetLocalGroups\u00a0API", "Detections": [{"DetectionNote": "A MSSP detection for \"Permissions Groups Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected a list of local groups.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}]}]}]}, {"TechniqueId": "T1028", "TechniqueName": "Windows Remote Management", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}, {"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.A.2", "Procedure": "Established WinRM connection to remote host Scranton (10.0.1.4)", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "Telemetry showed a connection to Scranton (10.0.1.4) over port 5985 via HTTP.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9931.png", "ScreenshotCaption": "powershell.exe connected to scranton on port 5985, via service HTTP (WinRM)"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}, {"SubStep": "16.C.1", "Procedure": "Established a WinRM connection to the domain controller host NewYork (10.0.0.4) ", "Criteria": "Network connection to NewYork (10.0.0.4) over port 5985", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of WinRM usage via invoke-winrmsession with command-line arguments.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17722.png", "ScreenshotCaption": "16c1 - mssp - winrm"}]}, {"DetectionNote": "Telemetry showed powershell.exe making a network connection to remote host NewYork (10.0.0.4) over port 5985.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9872.png", "ScreenshotCaption": "powershell.exe connected to 10.0.0.4 over port 5985 via HTTP (WinRM)"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}, {"SubStep": "20.B.2", "Procedure": "Established a WinRM connection to the remote host Scranton (10.0.1.4) using the Golden Ticket as credentials", "Criteria": "Network connection to Scranton (10.0.1.4) over port 5985", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1056", "TechniqueName": "Input Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.3", "Procedure": "Captured user keystrokes using the GetAsyncKeyState API", "Criteria": "powershell.exe executing the GetAsyncKeyState API", "Detections": [{"DetectionNote": "An MSSP detection for \"Input Capture\" occurred containing evidence of Get-Keystrokes function execution from psversion.ps1.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17628.png", "ScreenshotCaption": "MSSP - get keystrokes"}]}]}]}, {"TechniqueId": "T1115", "TechniqueName": "Clipboard Data", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.2", "Procedure": "Captured clipboard contents using PowerShell", "Criteria": "powershell.exe executing Get-Clipboard", "Detections": [{"DetectionNote": "An MSSP detection for \"Clipboard Data\" was received for PowerShell executing \"Get-Clipboard\" to retrieve clipboard contents.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12933.png", "ScreenshotCaption": "MSSP Day 1: Clipboard Data"}]}]}]}, {"TechniqueId": "T1018", "TechniqueName": "Remote System Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "8.A.1", "Procedure": "Enumerated remote systems using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 to the Domain Controller (10.0.0.4)", "Detections": [{"DetectionNote": "An MSSP detection for \"Remote System Discovery\" was received that included PowerShell commands run by the adversary and an explanation of those commands.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12941.png", "ScreenshotCaption": "MSSP Day 1: Remote System Discovery"}]}, {"DetectionNote": "Telemetry showed powershell.exe establishing a connection identified as LDAP over port 389 to NewYork (10.0.0.4).", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9930.png", "ScreenshotCaption": "powershell.exe connecting to DC via LDAP. Also, registry value creation and set events for LDAP queries"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}, {"SubStep": "16.A.1", "Procedure": "Enumerated the domain controller host NewYork (10.0.0.4) using LDAP queries", "Criteria": "powershell.exe making LDAP queries over port 389 via functions from System.DirectoryServices.dll", "Detections": [{"DetectionNote": "Telemetry showed PowerShell making a network connection to the domain controller NewYork (10.0.0.4) over LDAP port 389. Additionally, Oscar's Kerberos ticket was seen in memory on NewYork. ", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17718.png", "ScreenshotCaption": "16a1 - telem - delayed search query"}, {"ScreenshotName": "Symantec-APT29-17717.png", "ScreenshotCaption": "16a1 - telem - delayed forensic report "}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1102", "TechniqueName": "Web Service", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "18.A.1", "Procedure": "Mapped a network drive to an online OneDrive account using PowerShell", "Criteria": "net.exe with command-line arguments then making a network connection to a public IP over port 443", "Detections": [{"DetectionNote": "An MSSP detection for \"Web Service\" was received that included a PowerShell command executed by the adversary and explained that it was used to exfiltrate locally staged data to a remote WebDav share.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12973.png", "ScreenshotCaption": "MSSP Day 1: Exfil using Web Service"}]}, {"DetectionNote": "Telemetry showed net.exe with command-line arguments to connect to a OneDrive URL as well as net.exe subsequently making a network connection to public IPs over port 443.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9839.png", "ScreenshotCaption": "powershell.exe executed net.exe to map the OneDrive share"}, {"ScreenshotName": "Symantec-APT29-9885.png", "ScreenshotCaption": "net.exe connection to internet, followed by transfer of data via TLS"}, {"ScreenshotName": "Symantec-APT29-9838.png", "ScreenshotCaption": "Shows lineage of events related to mapping the network drive from the WebDav share on OneDrive"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1048", "TechniqueName": "Exfiltration Over Alternative Protocol", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.4", "Procedure": "Exfiltrated collection (OfficeSupplies.7z) to WebDAV network share using PowerShell", "Criteria": "powershell executing Copy-Item pointing to an attack-controlled WebDav\u00a0network share (192.168.0.4:80)", "Detections": [{"DetectionNote": "An MSSP detection for \"Exfiltration over Alternative Protocol\" occurred containing evidence of exfiltration to remote WebDav network share (192.168.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12936.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Exfil execution"}, {"ScreenshotName": "Symantec-APT29-12937.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Exfil details"}, {"ScreenshotName": "Symantec-APT29-12935.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Exfil"}]}, {"DetectionNote": "Telemetry showed a .7z file creation to a remove file share.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17654.png", "ScreenshotCaption": "telem - file write of .7z to fileshare"}]}]}, {"SubStep": "18.A.2", "Procedure": "Exfiltrated staged collection to an online OneDrive account using PowerShell", "Criteria": "powershell.exe executing Copy-Item pointing to drive mapped to an attack-controlled OneDrive account", "Detections": [{"DetectionNote": "An MSSP detection for \"Exfiltration Over Alternative Protocol\" was received that included a PowerShell command executed by the adversary and explained that it was used to copy a file to a drive mapped to a WebDav share.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12973.png", "ScreenshotCaption": "MSSP Day 1: Exfil using Web Service"}]}]}]}, {"TechniqueId": "T1036", "TechniqueName": "Masquerading", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "1.A.2", "Procedure": "Used unicode right-to-left override (RTLO) character to obfuscate file name rcs.3aka3.doc (originally cod.3aka.scr)", "Criteria": "Evidence of the right-to-left override character (U+202E) in the rcs.3aka.doc process \u200bOR the original filename (cod.3aka.scr)", "Detections": [{"DetectionNote": "A General detection was generated for \"Suspicious File Detected rcs.3aka3.doc\" due to machine learning identifying the payload as a PE32 executable and analyzing it.", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17521.png", "ScreenshotCaption": "1a2 - Suspicious File Detected rcs.3aka3.doc"}]}, {"DetectionNote": "Telemetry showed original filename of cod.3aka.scr and it was a Windows PE file.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9896.png", "ScreenshotCaption": "In Incident Report, report of a malicious file with the RTL override showing up as unknown Unicode characters."}, {"ScreenshotName": "Symantec-APT29-9898.png", "ScreenshotCaption": "File details assumed it was PE file, and stated attributes of it."}]}]}, {"SubStep": "6.A.3", "Procedure": "Masqueraded a Chrome password dump tool as accesscheck.exe, a legitimate Sysinternals tool", "Criteria": "Evidence that accesscheck.exe is not the legitimate Sysinternals tool", "Detections": [{"DetectionNote": "A General alert detection was generated for \"Potential risk found\" on accesschk.exe receiving a reputation report that indicated it was known to be an untrusted file with the maximum suspicion rating, which indicates it is not a legitimate Sysinternals tool.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7437.png", "ScreenshotCaption": "hid_level 500 showing that accesschk.exe is very suspicious. Essentially a score, which triggers can be based on."}, {"ScreenshotName": "Symantec-APT29-7436.png", "ScreenshotCaption": "Reputation request for accesschck.exe showing low reputation, indicative of not being the correct file"}, {"ScreenshotName": "Symantec-APT29-7438.png", "ScreenshotCaption": "context for accesschck.exe"}]}]}]}, {"TechniqueId": "T1082", "TechniqueName": "System Information Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.3", "Procedure": "Enumerated the computer hostname using PowerShell", "Criteria": "powershell.exe executing $env:COMPUTERNAME", "Detections": [{"DetectionNote": "A MSSP detection for \"System Information Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the Computer Name.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}]}]}, {"SubStep": "4.C.6", "Procedure": "Enumerated the OS version using PowerShell", "Criteria": "powershell.exe executing\u200b Gwmi Win32_OperatingSystem", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "11.A.4", "Procedure": "Enumerated computer manufacturer, model, and version information using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject gwmi queries for Win32_BIOS and Win32_ComputerSystem", "Detections": [{"DetectionNote": "An MSSP detection for \"System Information Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to collect information about the local system.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12948.png", "ScreenshotCaption": "MSSP Day 1: Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12949.png", "ScreenshotCaption": "MSSP Day 1: Discovery description"}]}]}, {"SubStep": "13.A.1", "Procedure": "Enumerated the computer name using the GetComputerNameEx API", "Criteria": "powershell.exe executing the GetComputerNameEx API", "Detections": [{"DetectionNote": "An MSSP detection for \"System Information Discovery\" occurred containg evidence of PowerShell calling the GetComputerNameEx API.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12960.png", "ScreenshotCaption": "MSSP Day 1: Discovery techniques"}, {"ScreenshotName": "Symantec-APT29-12961.png", "ScreenshotCaption": "MSSP Day 1: Discovery script details"}]}]}]}, {"TechniqueId": "T1022", "TechniqueName": "Data Encrypted", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "7.B.3", "Procedure": "Encrypted data from the user's Downloads directory using PowerShell", "Criteria": "powershell.exe executing Compress-7Zip with the password argument used for encryption", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence that data was compressed and password encrypted for exfiltration.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12936.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Exfil execution"}, {"ScreenshotName": "Symantec-APT29-12935.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Exfil"}, {"ScreenshotName": "Symantec-APT29-12937.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Exfil details"}]}]}, {"SubStep": "9.B.6", "Procedure": "Encrypted staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe with the -a parameter for a password to use for encryption", "Detections": [{"DetectionNote": "A Tactic detection for \"Exfiltration\" was generated when rar.exe executed with command-line arguments creating working.zip.", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17694.png", "ScreenshotCaption": "9b6 - tactic"}]}, {"DetectionNote": "A MSSP detection for \"Data Encrypted\" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress data into an encrypted ZIP file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12945.png", "ScreenshotCaption": "MSSP Day 1: PowerShell Collection (2)"}, {"ScreenshotName": "Symantec-APT29-12946.png", "ScreenshotCaption": "MSSP Day 1: PowerShell Collection (1)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7479.png", "ScreenshotCaption": "powershell.exe executing rar.exe with arguments"}]}]}]}, {"TechniqueId": "T1086", "TechniqueName": "PowerShell", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u00a0spawning from cmd.exe", "Detections": [{"DetectionNote": "A Technique detection for \"PowerShell\" was generated when cmd.exe spawned powershell.exe. The event was correlated to a parent detection cod.3aka.scr as a suspicious file.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7357.png", "ScreenshotCaption": "list of execution events related to doc execution"}, {"ScreenshotName": "Symantec-APT29-12868.png", "ScreenshotCaption": "Incident Report showing correlation of powershell execution with cod.3aka.scr"}]}, {"DetectionNote": "An MSSP detection for \"PowerShell\" was received that included a description of the PowerShell commands executed by the adversary.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-13030.png", "ScreenshotCaption": "MSSP Day 1: automated file collection script"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawning from cmd.exe. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12868.png", "ScreenshotCaption": "Incident Report showing correlation of powershell execution with cod.3aka.scr"}, {"ScreenshotName": "Symantec-APT29-7357.png", "ScreenshotCaption": "list of execution events related to doc execution"}]}]}, {"SubStep": "4.A.2", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe spawning from powershell.exe", "Detections": [{"DetectionNote": "A Technique detection for \"PowerShell\" was generated when powershell.exe spawned powershell.exe.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7421.png", "ScreenshotCaption": "powershell spawning powershell, with PIDs"}]}, {"DetectionNote": "An MSSP detection occurred containing evidence of a new powershell.exe spawning from powershell.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12909.png", "ScreenshotCaption": "MSSP Day 1: Remote File Copy of sysinternals tools"}]}]}, {"SubStep": "9.B.1", "Procedure": "Spawned interactive powershell.exe", "Criteria": "powershell.exe\u200b spawning from python.exe", "Detections": [{"DetectionNote": "A Technique detection for PowerShell was generated when python.exe spawned powershell.exe.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7475.png", "ScreenshotCaption": "python.exe executing powershell.exe"}, {"ScreenshotName": "Symantec-APT29-7472.png", "ScreenshotCaption": "Execution of powershell.exe, tagged with PowerShell"}]}, {"DetectionNote": "Telemetry showed python.exe executing powershell.exe. The telemetry was correlated to a parent detection python.exe as a suspicious file.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17683.png", "ScreenshotCaption": "9b1 - telemetry + correlation"}]}]}, {"SubStep": "11.A.12", "Procedure": "Executed PowerShell stager payload", "Criteria": "powershell.exe spawning from from the schemas ADS (powershell.exe)", "Detections": [{"DetectionNote": "A Technique alert detection (medium severity) for \"Powershell\" was generated for powershell.exe spawned from a PowerShell stager.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9706.png", "ScreenshotCaption": "Incident report for execution of suspicious powershell.exe usage"}, {"ScreenshotName": "Symantec-APT29-9705.png", "ScreenshotCaption": "powershell.exe launching powershell.exe stager."}, {"ScreenshotName": "Symantec-APT29-12850.png", "ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution"}, {"ScreenshotName": "Symantec-APT29-9700.png", "ScreenshotCaption": "powershell.exe executing ADS"}]}, {"DetectionNote": "An MSSP detection for \"PowerShell\" was received that included a PowerShell command executed by the adversary and explained that it was used to download and execute a PoshC2 stager located on a remote server.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12954.png", "ScreenshotCaption": "MSSP Day 1: stager script explanation"}, {"ScreenshotName": "Symantec-APT29-12953.png", "ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques"}]}, {"DetectionNote": "Telemetry showed powershell.exe spawned from a PowerShell stager.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9700.png", "ScreenshotCaption": "powershell.exe executing ADS"}, {"ScreenshotName": "Symantec-APT29-12850.png", "ScreenshotCaption": "Incident Report showing events related to explorer.exe executing powershell.exe from initial execution"}, {"ScreenshotName": "Symantec-APT29-9706.png", "ScreenshotCaption": "Incident report for execution of suspicious powershell.exe usage"}, {"ScreenshotName": "Symantec-APT29-9705.png", "ScreenshotCaption": "powershell.exe launching powershell.exe stager."}]}]}, {"SubStep": "20.A.3", "Procedure": "Executed PowerShell payload from WMI event subscription persistence", "Criteria": "SYSTEM-level powershell.exe spawned from the powershell.exe", "Detections": [{"DetectionNote": "A Technique detection for \"PowerShell\" was generated due to wmiprvse.exe spawning powershell.exe.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17733.png", "ScreenshotCaption": "20A3 - technique"}]}, {"DetectionNote": "A General detection called \"powershell.exe contains suspicious argument\" was generated on a SYSTEM-level powershell.exe spawning from wmiprvse.exe.", "DetectionType": "General", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9859.png", "ScreenshotCaption": "Forensics Report with process tree of wmiprvse.exe resulting in powershell callback as SYSTEM"}]}]}]}, {"TechniqueId": "T1081", "TechniqueName": "Credentials in Files", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.1", "Procedure": "Read the Chrome SQL database file to extract encrypted credentials", "Criteria": "accesscheck.exe reading files within %APPDATALOCAL%\\Google\\chrome\\user data\\default\\", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1145", "TechniqueName": "Private Keys", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.B.1", "Procedure": "Exported a local certificate to a PFX file using PowerShell", "Criteria": "powershell.exe creating a certificate file exported from the system", "Detections": [{"DetectionNote": "An MSSP detection for \"Private Keys\" occurred containing evidence of readme.ps1 analysis indicating Get-PrivateKeys execution writing a .pfx file.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17593.png", "ScreenshotCaption": "MSSP - 6B1"}]}, {"DetectionNote": "Telemetry showed file create event for a $RandomFileName.pfx file by powershell.exe.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9927.png", "ScreenshotCaption": "6B1 - powershell creating PFX file"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1035", "TechniqueName": "Service Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "8.C.3", "Procedure": "Executed python.exe using PSExec", "Criteria": "python.exe spawned by PSEXESVC.exe", "Detections": [{"DetectionNote": "A Technique alert detection for \"PsExec interacted with services - SONAR.PsExeSvc!gen1\" was generated on PsExecSvc targeting python.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7458.png", "ScreenshotCaption": "PSExec executing python.exe on scranton"}]}, {"DetectionNote": "An MSSP detection for \"Service Execution\" occurred containing evidence of PSEXECSVC.exe executing python.exe.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12942.png", "ScreenshotCaption": "MSSP Day 1: PSExec for lateral movement"}]}, {"DetectionNote": "Telemetry showed PSEXECSVC.exe executing python.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7466.png", "ScreenshotCaption": "python.exe running as pam, and psexec64.exe running as pam with command line arguments"}]}]}, {"SubStep": "10.A.1", "Procedure": "Executed persistent service (javamtsup) on system startup", "Criteria": "javamtsup.exe spawning from services.exe", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}]}, {"TechniqueId": "T1027", "TechniqueName": "Obfuscated Files or Information", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.A.2", "Procedure": "Embedded PowerShell payload in monkey.png using steganography", "Criteria": "Evidence that a PowerShell payload was within\u00a0monkey.png", "Detections": [{"DetectionNote": "A Technique alert detection for Obfuscated Files or Information was generated for PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file. Detection incurred a delay based on machine learning processing.", "DetectionType": "Technique", "Modifiers": ["Alert", "Delayed (Processing)", "Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17553.png", "ScreenshotCaption": "tech + delayed + corr"}]}, {"DetectionNote": "An MSSP detection for \"Data Obfuscation\" occurred containing evidence of the PowerShell script contained within monkey.png.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9908.png", "ScreenshotCaption": "MEDR Report: Contains the powershell scriptblock log for deobfuscating the powershell script in monkey.png. Human analysis explains the script and use of steganography."}]}, {"DetectionNote": "Telemetry showed PowerShell extracting and executing the code embedded within monkey.png. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17553.png", "ScreenshotCaption": "tech + delayed + corr"}]}]}, {"SubStep": "14.B.5", "Procedure": "Encoded and wrote Mimikatz output to a WMI class property using PowerShell", "Criteria": "powershell.exe executing Set-WmiInstance", "Detections": [{"DetectionNote": "Telemetry showed PowerShell executing Set-WmiInstance to write encoded content to Win32_AuditCode.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17711.png", "ScreenshotCaption": "14b5 - telemetry for win_audit code"}]}]}, {"SubStep": "17.C.2", "Procedure": "Prepended the GIF file header to a compressed staging file using PowerShell", "Criteria": "powershell.exe executing Set-Content", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure. PowerShell was seen modifying WindowsParentalControlMigration.tmp and increasing the file size by 6 bytes but there is no indication addition is for obfuscation.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9884.png", "ScreenshotCaption": "powershell.exe modified tmp file, adding 6 bytes"}]}]}]}, {"TechniqueId": "T1084", "TechniqueName": "Windows Management Instrumentation Event Subscription", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "15.A.2", "Procedure": "Established WMI event subscription persistence using PowerShell", "Criteria": "powershell.exe creating the WindowsParentalControlMigration WMI filter, consumer, and binding created in root/subscription", "Detections": [{"DetectionNote": "A Technique detection called \"WMI Event Subscriptionmodule WindowsParentalControlMigration contains suspicious argument\" was generated on WMIProcessCreationEvent and WMIConsumerEvent being created in root/subscription. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17713.png", "ScreenshotCaption": "15a2 - technique "}]}, {"DetectionNote": "A General alert detection called \"SEP detected: CLDownloader!gen1\" was generated on subscription:CommandLineEventConsumer.Name=WindowsParentalControlMigration.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17715.png", "ScreenshotCaption": "15a2 - General"}]}, {"DetectionNote": "An MSSP detection for \"WMI Event Subscription\" was received that included a PowerShell command executed by the adversary and explained that it was used to establish persistence through a WMI Event Subscription that executes upon user logon.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12966.png", "ScreenshotCaption": "MSSP Day 1: WMI Event Subscription"}]}]}, {"SubStep": "20.A.2", "Procedure": "Executed WMI persistence on user login", "Criteria": "The WMI process (wmiprvse.exe) executing powershell.exe", "Detections": [{"DetectionNote": "Telemetry showed wmiprvse.exe executing PowerShell.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9856.png", "ScreenshotCaption": "Shows wmiprvse.exe executing powershell.exe, which then executes the powershell stager."}]}]}]}, {"TechniqueId": "T1096", "TechniqueName": "NTFS File Attributes", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "11.A.2", "Procedure": "Executed an alternate data stream (ADS) using PowerShell", "Criteria": "powershell.exe executing the schemas ADS via Get-Content and IEX", "Detections": [{"DetectionNote": "An MSSP detection for \"NTFS File Attributes\"  was received that included the PowerShell command used by the adversary and explained that it was used to retrieve the PowerShell script from the schemas Alternate Data Stream and execute it.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12947.png", "ScreenshotCaption": "MSSP Day 1: NTFS File Attributes"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing the schemas ADS with Get-Content and IEX.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9697.png", "ScreenshotCaption": "powershell.exe obtaining the script from the Alternate Data Stream and executing it."}]}]}]}, {"TechniqueId": "T1071", "TechniqueName": "Standard Application Layer Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.B.4", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is HTTPS", "Detections": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7402.png", "ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection."}]}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7402.png", "ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection."}]}]}, {"SubStep": "11.A.14", "Procedure": "Used HTTPS to transport\u00a0C2 (192.168.0.4) traffic", "Criteria": "Established network channel over the HTTPS protocol", "Detections": [{"DetectionNote": "A MSSP detection for \"Standard Application Layer Protocol\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12954.png", "ScreenshotCaption": "MSSP Day 1: stager script explanation"}, {"ScreenshotName": "Symantec-APT29-12953.png", "ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques"}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9867.png", "ScreenshotCaption": "Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1497", "TechniqueName": "Virtualization/Sandbox Evasion", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.3", "Procedure": "Checked that the BIOS version and serial number are not associated with VirtualBox or VMware using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject\nquery for Win32_BIOS", "Detections": [{"DetectionNote": "An MSSP detection for \"Virtualization/Sandbox Evasion\" was received that included a PowerShell command executed by the adversary and explained that it was used to query BIOS information.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12948.png", "ScreenshotCaption": "MSSP Day 1: Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12949.png", "ScreenshotCaption": "MSSP Day 1: Discovery description"}]}]}]}, {"TechniqueId": "T1002", "TechniqueName": "Data Compressed", "Tactics": [{"TacticName": "Exfiltration", "TacticId": "TA0010"}], "Steps": [{"SubStep": "2.A.4", "Procedure": "Compressed and stored files into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe executing\u00a0Compress-Archive", "Detections": [{"DetectionNote": "A Technique detection for \"Data Compressed\" was generated when Draft.zip was identified as compressed. The event was correlated to a parent detection cod.3aka.scr as a malicious file.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17539.png", "ScreenshotCaption": "A Technique detection + correlation"}]}, {"DetectionNote": "An MSSP detection for \"Data Compressed \"was received that included an explanation of the PowerShell script used to compress files and store the results in Draft.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9903.png", "ScreenshotCaption": "Powershell Scriptblock log for all commands used in 2.A. Human generated mappings based on the evidence included in the report."}]}, {"DetectionNote": "Telemetry showed powershell.exe compressing via Compress-Archive. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9905.png", "ScreenshotCaption": "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]"}]}]}, {"SubStep": "7.B.2", "Procedure": "Compressed\u00a0data from the user's Downloads directory into a ZIP file (OfficeSupplies.7z) using PowerShell", "Criteria": "powershell.exe creating the file OfficeSupplies.7z", "Detections": [{"DetectionNote": "A Technique detection for \"Data Compressed\" was generated when powershell.exe created OfficeSupplies.7z.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7447.png", "ScreenshotCaption": "temporary zip created, 7ZIP installation"}]}, {"DetectionNote": "An MSSP detection occurred for \"Data Compressed\" containing evidence of Invoke-Exfil function using 7-zip with password \"lolol\" to compressed downloads directory into OfficeSupplies.7z.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17645.png", "ScreenshotCaption": "MSSP - data compression"}]}, {"DetectionNote": "Telemetry showed the creation of OfficeSupplies.7z.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7447.png", "ScreenshotCaption": "temporary zip created, 7ZIP installation"}]}]}, {"SubStep": "9.B.7", "Procedure": "Compressed staged ZIP (working.zip in AppData directory) into working.zip (on Desktop) using rar.exe", "Criteria": "powershell.exe executing rar.exe", "Detections": [{"DetectionNote": "A Technique detection for Data Compressed was generated when rar.exe created working.zip.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7479.png", "ScreenshotCaption": "powershell.exe executing rar.exe with arguments"}]}, {"DetectionNote": "A MSSP detection for \"Data Staged\" was received included the command used by the adversary to execute Rar.exe and explained that it was used to compress compress data into working.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12945.png", "ScreenshotCaption": "MSSP Day 1: PowerShell Collection (2)"}, {"ScreenshotName": "Symantec-APT29-12946.png", "ScreenshotCaption": "MSSP Day 1: PowerShell Collection (1)"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing rar.exe with command-line arguments.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7479.png", "ScreenshotCaption": "powershell.exe executing rar.exe with arguments"}]}]}, {"SubStep": "17.C.1", "Procedure": "Compressed a staging directory using PowerShell", "Criteria": "powershell.exe executing the ZipFile.CreateFromDirectory .NET method", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of commands used to copy and compress data.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12972.png", "ScreenshotCaption": "MSSP Day 1: zip function"}]}]}]}, {"TechniqueId": "T1003", "TechniqueName": "Credential Dumping", "Tactics": [{"TacticName": "Credential Access", "TacticId": "TA0006"}], "Steps": [{"SubStep": "6.A.2", "Procedure": "Executed the CryptUnprotectedData API call to decrypt Chrome passwords", "Criteria": "accesscheck.exe executing the CryptUnprotectedData API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "6.C.1", "Procedure": "Dumped password hashes from the Windows Registry by injecting a malicious DLL into Lsass.exe", "Criteria": "powershell.exe injecting into lsass.exe OR lsass.exe\u00a0reading Registry keys under HKLM:\\SAM\\SAM\\Domains\\Account\\Users\\", "Detections": [{"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when PowerShell attempted injection into lsass.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17862.png", "ScreenshotCaption": "6c1 - tech alert for inject lsass"}]}, {"DetectionNote": "A General alert detection for \"Process Injection\" was generated on \"PowerShell injected into Microsoft signed process\".", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7446.png", "ScreenshotCaption": "Powershell injecting into lsass.exe tagged with Tactic and Technique."}]}, {"DetectionNote": "Telemetry showed powershell.exe injecting into lsass.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7446.png", "ScreenshotCaption": "Powershell injecting into lsass.exe tagged with Tactic and Technique."}]}]}, {"SubStep": "14.B.4", "Procedure": "Dumped plaintext credentials using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when m.exe read Lsass memory. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17709.png", "ScreenshotCaption": "14b4 - technique - reading of lsass"}]}, {"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when powershell.exe loaded cryptography DLLs and attempted to inject into lsass.exe, and again when powershell.exe successfully injected into lsass.exe. The detection was correlated to a parent alert for wmiprvse.exe executing powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9762.png", "ScreenshotCaption": "Incident report including triggering event of execution of mimikatx, preceded by file execution"}]}, {"DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that included a PowerShell command executed by the adversary to download Mimikatz and execute it with a sequence of commands.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12962.png", "ScreenshotCaption": "MSSP Day 1: wmidump"}]}]}, {"SubStep": "16.D.2", "Procedure": "Dumped the KRBTGT hash on the domain controller host NewYork (10.0.0.4) using Mimikatz (m.exe)", "Criteria": "m.exe injecting into lsass.exe to dump credentials", "Detections": [{"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated for a suspicious injection into LSASS.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9775.png", "ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe"}]}, {"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when a suspicious process loaded a cryptographic DLL and accessed LSASS memory.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9775.png", "ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe"}]}, {"DetectionNote": "A Technique alert detection for \"Credential Dumping\" was generated when a suspicious process opened LSASS and wrote to a file.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9775.png", "ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe"}]}, {"DetectionNote": "A Technique detection for \"Credential Dumping\" was generated when m.exe injected into lsass.exe.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9735.png", "ScreenshotCaption": "Incident Report for Credential Dumping, including execution of m.exe. Done from HI  powershell.exe process"}, {"ScreenshotName": "Symantec-APT29-9787.png", "ScreenshotCaption": "m.exe injected into lsass.exe, tagged with Credential Dumping"}]}, {"DetectionNote": "A General alert detection for \"Process Injection\" was generated on \"Untrusted process attempted to open a thread in a Microsoft process\".", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17724.png", "ScreenshotCaption": "16d2 - general + correlation -  suspected mimikatz credential theft"}]}, {"DetectionNote": "A General detection was generated for a \"Suspected Mimikatz credential theft activity\". The event was correlated to a parent General detection on m.exe.", "DetectionType": "General", "Modifiers": ["Alert", "Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17724.png", "ScreenshotCaption": "16d2 - general + correlation -  suspected mimikatz credential theft"}]}, {"DetectionNote": "An MSSP detection for \"Credential Dumping\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute mimikatz to retrieve the krbtgt hash from host NewYork (10.0.0.4).", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12969.png", "ScreenshotCaption": "MSSP Day 1: remote mimikatz copy techniques"}, {"ScreenshotName": "Symantec-APT29-12970.png", "ScreenshotCaption": "MSSP Day 1: remote mimikatz copy description"}]}, {"DetectionNote": "Telemetry showed m.exe injecting into lsass.exe", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9775.png", "ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe"}]}]}]}, {"TechniqueId": "T1085", "TechniqueName": "Rundll32", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "20.A.1", "Procedure": "Executed Run key persistence payload on user login using RunDll32", "Criteria": "rundll32.exe executing kxwn.lock", "Detections": [{"DetectionNote": "A Technique alert detection called \"Rundll32\" was generated on \"malicious file kxwn.lock with heuristic signature SONAR.Module!gen3\".", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17729.png", "ScreenshotCaption": "20a1 - technique detection on SONAR TRIGGERING EVENT"}]}, {"DetectionNote": "A Technique alert detection called \"SONAR - RunDLL32 loaded a suspicious DLL\" was generated due to rundll32.exe executing kxwn.lock.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9853.png", "ScreenshotCaption": "Rundll32 loaded a suspicious DLL alert, tagged with Rundll32"}]}, {"DetectionNote": "Telemetry showed rundll32.exe executing kxwn.lock.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9853.png", "ScreenshotCaption": "Rundll32 loaded a suspicious DLL alert, tagged with Rundll32"}]}]}]}, {"TechniqueId": "T1059", "TechniqueName": "Command-Line Interface", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.B.1", "Procedure": "Spawned interactive cmd.exe", "Criteria": "cmd.exe\u00a0spawning from the rcs.3aka3.doc\u200b process", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc executing cmd.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7357.png", "ScreenshotCaption": "list of execution events related to doc execution"}]}]}]}, {"TechniqueId": "T1088", "TechniqueName": "Bypass User Account Control", "Tactics": [{"TacticName": "Privilege Escalation", "TacticId": "TA0004"}], "Steps": [{"SubStep": "3.B.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powershell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "Telemetry showed control.exe creating a high integrity powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7397.png", "ScreenshotCaption": "control.exe executing powershell.exe to decode script from monkey.png"}, {"ScreenshotName": "Symantec-APT29-7400.png", "ScreenshotCaption": "Decoder event with columns for user, integrity evel, pid, and command-line arguments showing the stager"}]}]}, {"SubStep": "14.A.2", "Procedure": "Executed elevated PowerShell payload", "Criteria": "High integrity powrshell.exe spawning from\u00a0control.exe\u200b\u200b (spawned from sdclt.exe)", "Detections": [{"DetectionNote": "A Technique alert detection for \"UAC Bypass\" was generated when the setting of registry values associated with COM Hijacking was followed by execution of a program known to be associated with UAC bypasses. The event was correlated to a parent Tactic detection called \"Execution\" that was generated when explorer.exe executed powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Correlated", "Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9737.png", "ScreenshotCaption": "Suspected UAC Bypass, with execution of powershell.exe"}, {"ScreenshotName": "Symantec-APT29-9740.png", "ScreenshotCaption": "Suspected UAC bypass in the context of an Incident Report. Detection is based on COM Hijacking followed by execution of UAC \"bypassable\" executables"}]}, {"DetectionNote": "Telemetry showed a new High Integrity PowerShell callback spawned from control.exe (spawned from sdclt.exe). ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9752.png", "ScreenshotCaption": "Shows lineage of processes, with change in integrity levels, and command-line arguments showing the stager."}]}]}]}, {"TechniqueId": "T1047", "TechniqueName": "Windows Management Instrumentation", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "14.B.1", "Procedure": "Created and executed a WMI class using PowerShell", "Criteria": "WMI Process (WmiPrvSE.exe) executing powershell.exe", "Detections": [{"DetectionNote": "A Tactic detection called \"Execution\" was generated when wmiprvse.exe launched powershell.exe.", "DetectionType": "Tactic", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17707.png", "ScreenshotCaption": "14b1 - tactic execution"}]}, {"DetectionNote": "An MSSP detection for \"WMI\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute PowerShel through WMI that downloads and executes mimikatz.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12962.png", "ScreenshotCaption": "MSSP Day 1: wmidump"}]}, {"DetectionNote": "Telemetry showed WmiPrvSE.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9755.png", "ScreenshotCaption": "wmiprvse.exe executing powershell.exe stager"}]}]}]}, {"TechniqueId": "T1114", "TechniqueName": "Email Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "17.A.1", "Procedure": "Dumped messages from the local Outlook inbox using PowerShell", "Criteria": "outlook.exe spawning from svchost.exe or powershell.exe", "Detections": [{"DetectionNote": "An MSSP detection for \"Email Collection\" was generated containing evidence of email collection.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12971.png", "ScreenshotCaption": "MSSP Day 1: Email Collection"}]}, {"DetectionNote": "Telemetry showed outlook.exe spawning from svchost.exe, which is indicative of programmatic access to Outlook emails.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9835.png", "ScreenshotCaption": "svchost.exe executed outlook.exe"}]}]}]}, {"TechniqueId": "T1032", "TechniqueName": "Standard Cryptographic Protocol", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.4", "Procedure": "Used RC4 stream cipher to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "3.B.5", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.5) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when PowerShell process exchanged data with 192.168.0.5 over HTTPS due to network traffic analysis.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7402.png", "ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection."}]}, {"DetectionNote": "Telemetry showed PowerShell process exchanging data with 192.168.0.5 over HTTPS.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7402.png", "ScreenshotCaption": "Connection from Meterpreter back to redirector with IP and port. Identified as HTTPs by protocol inspection."}]}]}, {"SubStep": "11.A.15", "Procedure": "Used HTTPS to encrypt C2 (192.168.0.4) traffic", "Criteria": "Evidence that the network data sent over the C2 channel is encrypted", "Detections": [{"DetectionNote": "An MSSP detection for \"Standard Application Layer Protocol\" was received that included a description of PowerShell script downloaded and executed by the adversary and explained that it was used to establish a connection to 192.168.0.4 using HTTPS. A detailed analysis of the script was also provided.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12954.png", "ScreenshotCaption": "MSSP Day 1: stager script explanation"}, {"ScreenshotName": "Symantec-APT29-12953.png", "ScreenshotCaption": "MSSP Day 1: PowerShell & C2 techniques"}]}, {"DetectionNote": "Telemetry showed powershell.exe connecting and sending data to 192.168.0.4 via TLS.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9867.png", "ScreenshotCaption": "Powershell.exe connected to 192.168.04 on port 443 using TLS (inspection of the data)"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1106", "TechniqueName": "Execution through API", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "4.C.10", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetGroups API function loaded into powershell.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "4.C.12", "Procedure": "Executed API call by reflectively loading Netapi32.dll", "Criteria": "The NetUserGetLocalGroups API function loaded into powershelle.exe from Netapi32.dll", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure.", "DetectionType": "None", "Modifiers": []}]}, {"SubStep": "10.B.2", "Procedure": "Executed PowerShell payload via the CreateProcessWithToken API", "Criteria": "hostui.exe executing the\nCreateProcessWithToken API", "Detections": [{"DetectionNote": "No detection capability demonstrated for this procedure, though data showed svchost.exe with -seclogon flag spawning before PowerShell.", "DetectionType": "None", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7499.png", "ScreenshotCaption": "sequence of process creation."}, {"ScreenshotName": "Symantec-APT29-7498.png", "ScreenshotCaption": "services.exe launched svchost.exe with seclogon command line parameters"}]}]}, {"SubStep": "16.B.2", "Procedure": "Executed the ConvertSidToStringSid API call by reflectively loading Advapi32.dll", "Criteria": "powershell.exe executing the ConvertSidToStringSid API function by loading Advapi32.dll", "Detections": [{"DetectionNote": "An MSSP detection for \"Execution through API\" was received that included a PowerShell command executed by the adversary and explained that it was used to execute the GetTokenInformation API call from Advapi32.dll.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12967.png", "ScreenshotCaption": "MSSP Day 1: siduser techniques"}, {"ScreenshotName": "Symantec-APT29-12968.png", "ScreenshotCaption": "MSSP Day 1: siduser description"}]}]}]}, {"TechniqueId": "T1074", "TechniqueName": "Data Staged", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.5", "Procedure": "Staged files for exfiltration into ZIP (Draft.zip) using PowerShell", "Criteria": "powershell.exe creating the file draft.zip", "Detections": [{"DetectionNote": "Telemetry showed the creation of Draft.Zip. The telemetry was correlated to a parent detection cod.3aka.scr as a suspicious file.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17539.png", "ScreenshotCaption": "A Technique detection + correlation"}]}]}, {"SubStep": "9.B.5", "Procedure": "Staged files for exfiltration into ZIP (working.zip in AppData directory) using PowerShell", "Criteria": "powershell.exe creating the file working.zip", "Detections": [{"DetectionNote": "Telemetry showed a Created File event for powershell.exe creating working.zip. The event was correlated to a parent General detection for a suspicious PowerShell process.", "DetectionType": "Telemetry", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17692.png", "ScreenshotCaption": "9b5 - telem + correlation"}, {"ScreenshotName": "Symantec-APT29-7473.png", "ScreenshotCaption": "powershell.exe created working.zip"}]}]}, {"SubStep": "17.B.2", "Procedure": "Staged collected file into directory using PowerShell", "Criteria": "powershell.exe creating the file \\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Telemetry showed the file create event for MITRE-ATTACK-EVALS.HTML.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9874.png", "ScreenshotCaption": "powershell.exe created and modified html file"}]}]}]}, {"TechniqueId": "T1083", "TechniqueName": "File and Directory Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "2.A.1", "Procedure": "Searched filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection for \"Data from Local System\" contained evidence of PowerShell executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12974.png", "ScreenshotCaption": "MSSP Day 1: automated file collection script"}]}, {"DetectionNote": "Telemetry showed PowerShell execution of ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9905.png", "ScreenshotCaption": "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]"}]}]}, {"SubStep": "4.C.1", "Procedure": "Enumerated user's temporary directory path using PowerShell", "Criteria": "powershell.exe executing\u00a0$env:TEMP", "Detections": [{"DetectionNote": "A MSSP detection for \"File and Directory Discovery\" was received that included details about a PowerShell script used for Discovery and mentioned that it collected the TempDirectory.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}, {"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}]}]}, {"SubStep": "9.B.2", "Procedure": "Searched filesystem for document and media files using PowerShell", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "An MSSP detection for \"Collection\" was received that included ChildItem command execution searching for document and media files.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17686.png", "ScreenshotCaption": "9b2 - MSSP"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17689.png", "ScreenshotCaption": "9b2 - telemetry"}]}]}, {"SubStep": "11.A.9", "Procedure": "Checked that the payload is not inside a folder path that contains \"sample\" or is the length of a hash value using PowerShell", "Criteria": "powershell.exe executing (Get-Item -Path \".\\\" -Verbose).FullName", "Detections": [{"DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to perform discovery of the file and directory list from the local filesystem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12948.png", "ScreenshotCaption": "MSSP Day 1: Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12949.png", "ScreenshotCaption": "MSSP Day 1: Discovery description"}]}]}, {"SubStep": "12.A.1", "Procedure": "Enumerated the System32 directory using PowerShell", "Criteria": "powershell.exe executing (gci ((gci env:windir).Value + '\\system32')", "Detections": [{"DetectionNote": "An MSSP detection for \"File and Directory Discovery\" was received that noted a PowerShell command was used to find a random file in the System32 folder.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12956.png", "ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp explanations"}, {"ScreenshotName": "Symantec-APT29-12955.png", "ScreenshotCaption": "MSSP Day 1: File discovery and Timestomp techniques"}]}]}]}, {"TechniqueId": "T1119", "TechniqueName": "Automated Collection", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "2.A.2", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem", "Detections": [{"DetectionNote": "An MSSP detection for \"Data from Local System\" contained evidence of PowerShell executing ChildItem.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12974.png", "ScreenshotCaption": "MSSP Day 1: automated file collection script"}]}, {"DetectionNote": "Telemetry showed PowerShell execution of ChildItem. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9905.png", "ScreenshotCaption": "TDAD: Not managed, shows scriptblock logs for 2.A [SE: Don't forget to sanitize the red team setup activity, particularly the WinDefend reg key!]"}]}]}, {"SubStep": "9.B.3", "Procedure": "Scripted search of filesystem for document and media files using PowerShell\u00a0", "Criteria": "powershell.exe executing (Get-)ChildItem\u200b", "Detections": [{"DetectionNote": "An MSSP detection for \"Collection\" was received that included ChildItem command execution searching for document and media files.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17686.png", "ScreenshotCaption": "9b2 - MSSP"}]}, {"DetectionNote": "Telemetry showed powershell.exe executing ChildItem.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17689.png", "ScreenshotCaption": "9b2 - telemetry"}]}]}]}, {"TechniqueId": "T1113", "TechniqueName": "Screen Capture", "Tactics": [{"TacticName": "Collection", "TacticId": "TA0009"}], "Steps": [{"SubStep": "7.A.1", "Procedure": "Captured and saved screenshots using PowerShell", "Criteria": "powershell.exe executing the CopyFromScreen function from System.Drawing.dll", "Detections": [{"DetectionNote": "An MSSP detection for \"Screen Capture\" was received that included details about a PowerShell script used to collect screenshots.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12930.png", "ScreenshotCaption": "MSSP Day 1: psversion.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12932.png", "ScreenshotCaption": "MSSP Day 1: Screen Capture description"}, {"ScreenshotName": "Symantec-APT29-12931.png", "ScreenshotCaption": "MSSP Day 1: Screen Capture Technique"}]}]}]}, {"TechniqueId": "T1055", "TechniqueName": "Process Injection", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "19.A.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.2", "Procedure": "Reflectively injected SDelete binary into PowerShell", "Criteria": "Injection into PowerShell via Invoke-ReflectivePEInjection", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1105", "TechniqueName": "Remote File Copy", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "3.A.1", "Procedure": "Dropped stage 2 payload (monkey.png) to disk", "Criteria": "The rcs.3aka3.doc process creating the file monkey.png", "Detections": [{"DetectionNote": "Telemetry showed rcs.3aka3.doc creating monkey.png, with the file path reversed due to the Unicode right-to-left override character.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9907.png", "ScreenshotCaption": "File creation for monkey.png"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}, {"SubStep": "4.A.1", "Procedure": "Dropped additional tools (SysinternalsSuite.zip) to disk over C2 channel (192.168.0.5)", "Criteria": "powershell.exe creating the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "Telemetry showed the file write of the ZIP by PowerShell. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7416.png", "ScreenshotCaption": ""}, {"ScreenshotName": "Symantec-APT29-7419.png", "ScreenshotCaption": "MITRE tagged file creation event for sysinternal.zip file"}]}]}, {"SubStep": "8.B.1", "Procedure": "Copied python.exe payload from a WebDAV share (192.168.0.4) to remote host Scranton (10.0.1.4)", "Criteria": "The file python.exe created on Scranton (10.0.1.4)", "Detections": [{"DetectionNote": "A Technique detection for \"Remote File Copy\" was generated data being sent over SMB2 to Scranton (10.0.1.4) creating a .exe file.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17664.png", "ScreenshotCaption": "8b1 - technique remote file copy"}]}, {"DetectionNote": "A General alert detection for \"Malicious file detected python.exe\" was generated on sandbox detection evaluation of python.exe. Detection incurred a delay based on sandbox detonation processing.", "DetectionType": "General", "Modifiers": ["Delayed (Processing)", "Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17662.png", "ScreenshotCaption": "8b1-general delayed sandbox detonation"}]}]}, {"SubStep": "9.A.1", "Procedure": "Dropped rar.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file rar.exe", "Detections": [{"DetectionNote": "A Technique alert detection for \"Remote File Copy - Suspicious N-Gram\" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created rar.exe.", "DetectionType": "Technique", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17864.png", "ScreenshotCaption": "9a1 - ngram + technique"}, {"ScreenshotName": "Symantec-APT29-17864.png", "ScreenshotCaption": "9a1 - ngram + technique"}]}, {"DetectionNote": "Telemetry showed python.exe creating rar.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7468.png", "ScreenshotCaption": "list of rar.exe creations and python.exe connected, with remote file copy"}]}]}, {"SubStep": "9.A.2", "Procedure": "Dropped sdelete.exe to disk on remote host Scranton (10.0.1.4)\u00a0", "Criteria": "python.exe creating the file sdelete64.exe", "Detections": [{"DetectionNote": "A General alert detection for \"Suspicious N-Gram\" was generated when python.exe connected to 192.168.0.4 port 8443 and then immediately created sdelete64.exe.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17867.png", "ScreenshotCaption": "9a2 - ngram + general"}]}, {"DetectionNote": "Telemetry showed Created File event for python.exe connecting to 192.168.0.4 port 8443 and then immediately creating sdelete64.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7471.png", "ScreenshotCaption": "python.exe created file sdelete.exe"}]}]}, {"SubStep": "14.B.3", "Procedure": "Downloaded and dropped Mimikatz (m.exe) to disk", "Criteria": "powershell.exe downloading and/or the file write of m.exe", "Detections": [{"DetectionNote": "A Technique detection for \"Remote File Copy\" was generated when powershell.exe generated network traffic immediately followed by creation of an executable file. The event was correlated to a previous event showing wmiprvse.exe executing powershell.exe.", "DetectionType": "Technique", "Modifiers": ["Correlated"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9759.png", "ScreenshotCaption": "Shows sequence of network connection and file creation of m.exe"}, {"ScreenshotName": "Symantec-APT29-9758.png", "ScreenshotCaption": "Highlighted text indicates that Remote File Copy tag was due to network traffic immediately followed by file creation."}, {"ScreenshotName": "Symantec-APT29-12906.png", "ScreenshotCaption": "Incident report showing events correlated to wmiprvse.exe executing powershell.exe"}]}, {"DetectionNote": "An MSSP detection for \"Remote File Copy\" was received that included a PowerShell command executed by the adversary and explained that it was used to download m.exe from a remote server.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12962.png", "ScreenshotCaption": "MSSP Day 1: wmidump"}]}, {"DetectionNote": "Telemetry showed the file create event for m.exe into the System32 folder.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9757.png", "ScreenshotCaption": "reputation request and file creation event for m.exe, tagged with Remote File Copy"}, {"ScreenshotName": "Symantec-APT29-9759.png", "ScreenshotCaption": "Shows sequence of network connection and file creation of m.exe"}]}]}, {"SubStep": "16.D.1", "Procedure": "Dropped Mimikatz (m.exe) to disk on the domain controller host NewYork (10.0.0.4) over a WinRM connection", "Criteria": "File write of m.exe by the WinRM process (wsmprovhost.exe)", "Detections": [{"DetectionNote": "A Technique detection for \"Remote File Copy\" was generated when SMB traffic from another host was received and then immediately followed by a file write for m.exe by wsmprovhost.exe.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9735.png", "ScreenshotCaption": "Incident Report for Credential Dumping, including execution of m.exe. Done from HI  powershell.exe process"}, {"ScreenshotName": "Symantec-APT29-9774.png", "ScreenshotCaption": "Remote File Copy event, and network connection from utice > newyork. File Copy tag is based on network connection followed by file creation by wsmprovhost."}, {"ScreenshotName": "Symantec-APT29-9775.png", "ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe"}]}, {"DetectionNote": "A General alert detection called \"Malicious file detected\" was generated on sandbox detection analysis of m.exe. Detection incurred a delay based on sandbox detonation processing.", "DetectionType": "General", "Modifiers": ["Delayed (Processing)", "Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17725.png", "ScreenshotCaption": "16d1 - general - sandbox detection"}]}, {"DetectionNote": "An MSSP detection for \"Remote File Copy\" was received that included a PowerShell command executed by the adversary and explained that it was used to copy mimikatz to a remote PowerShell session.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12970.png", "ScreenshotCaption": "MSSP Day 1: remote mimikatz copy description"}, {"ScreenshotName": "Symantec-APT29-12969.png", "ScreenshotCaption": "MSSP Day 1: remote mimikatz copy techniques"}]}, {"DetectionNote": "Telemetry showed a file create event for m.exe in the System32 directory by \"Host process for WinRM plug-ins\".", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9775.png", "ScreenshotCaption": "Chain of events for network connection then file copy. Inferable that it was through a WinRM session because the file creation was by wsmprovhost.exe"}]}]}]}, {"TechniqueId": "T1078", "TechniqueName": "Valid Accounts", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.C.1", "Procedure": "Logged on to remote host Scranton (10.0.1.4) using\u00a0valid credentials for user Pam", "Criteria": "Successful logon as user Pam on\u00a0Scranton (10.0.1.4) ", "Detections": [{"DetectionNote": "An MSSP detection occurred containing evidence of a valid logon on Scranton (10.0.1.4) as user Pam.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12942.png", "ScreenshotCaption": "MSSP Day 1: PSExec for lateral movement"}]}, {"DetectionNote": "Telemetry showed PsExec64.exe executing python.exe with pam's login credentials on Scranton. A Kerberos ticket was generated on Scranton for pam.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17670.png", "ScreenshotCaption": "8c1 - telemetry of pam login"}]}]}, {"SubStep": "16.C.2", "Procedure": "Logged on to the domain controller host NewYork (10.0.0.4) using\u00a0valid credentials for user MScott\u00a0", "Criteria": "Successful logon as user MScott on NewYork (10.0.0.4) ", "Detections": [{"DetectionNote": "Telemetry showed wsmprovhost.exe successfully executing a program as user MScott, indicating that a valid user session was created through WinRM.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9778.png", "ScreenshotCaption": "Shows the user context for the file copy and execution of m.exe using mscott"}, {"ScreenshotName": "Symantec-APT29-9787.png", "ScreenshotCaption": "m.exe injected into lsass.exe, tagged with Credential Dumping"}]}]}]}, {"TechniqueId": "T1063", "TechniqueName": "Security Software Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "4.C.7", "Procedure": "Enumerated anti-virus software using PowerShell", "Criteria": "powershell.exe\u00a0executing\u200b Get-WmiObject ...\u200b -Class\u00a0AntiVirusProduct", "Detections": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}]}]}, {"SubStep": "4.C.8", "Procedure": "Enumerated firewall software using PowerShell", "Criteria": "powershell.exe\u00a0executing Get-WmiObject\u00a0...\u200b\u200b -Class\u00a0FireWallProduct", "Detections": [{"DetectionNote": "A MSSP detection was received that included details about a PowerShell script used for Discovery and mentioned that it collected information about installed antivirus and firewall products.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12919.png", "ScreenshotCaption": "MSSP Day 1: readme.ps1 script contents (2)"}, {"ScreenshotName": "Symantec-APT29-12922.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery execution"}, {"ScreenshotName": "Symantec-APT29-12921.png", "ScreenshotCaption": "MSSP Day 1: Invoke-Discovery Techniques"}]}]}, {"SubStep": "12.B.1", "Procedure": "Enumerated registered AV products using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for AntiVirusProduct", "Detections": [{"DetectionNote": "An MSSP detection for \"Security Software Discovery\" was occurred containing evidence WMI was used to enumerate installed AntiVirus products.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12957.png", "ScreenshotCaption": "MSSP Day 1: Security Software Discovery"}]}]}]}, {"TechniqueId": "T1112", "TechniqueName": "Modify Registry", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "3.C.1", "Procedure": "Modified the Registry to remove artifacts of COM hijacking", "Criteria": "Deletion of of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command subkey", "Detections": [{"DetectionNote": "Telemetry showed the deletion of the command subkey.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9919.png", "ScreenshotCaption": "powershell.exe deleting registry key. Event in question is at the top"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}, {"SubStep": "14.A.3", "Procedure": "Modified the Registry to remove artifacts of COM hijacking using PowerShell", "Criteria": "Deletion of\u00a0the HKCU\\Software\\Classes\\Folder\\shell\\Open\\command\u00a0subkey", "Detections": [{"DetectionNote": "An MSSP detection for \"Modify Registry\" was received that included a PowerShell command executed by the adversary and explained that it was used to delete the Registry Key.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12963.png", "ScreenshotCaption": "MSSP Day 1: UAC Bypass techniques and description"}, {"ScreenshotName": "Symantec-APT29-12964.png", "ScreenshotCaption": "MSSP Day 1: UAC Bypass details"}]}, {"DetectionNote": "Telemetry showed the deletion of the Registry value.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9871.png", "ScreenshotCaption": "powershell.exe deleted registry key"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}]}, {"TechniqueId": "T1120", "TechniqueName": "Peripheral Device Discovery", "Tactics": [{"TacticName": "Discovery", "TacticId": "TA0007"}], "Steps": [{"SubStep": "11.A.5", "Procedure": "Enumerated devices/adapters to check for presence of VirtualBox driver(s) using PowerShell", "Criteria": "powershell.exe executing a Get-WmiObject query for Win32_PnPEntity", "Detections": [{"DetectionNote": "An MSSP detection for \"Peripheral Device Discovery\" was received that included a PowerShell command executed by the adversary and explained that it was used to enumerate Plug and Play devices.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12948.png", "ScreenshotCaption": "MSSP Day 1: Discovery Techniques"}, {"ScreenshotName": "Symantec-APT29-12949.png", "ScreenshotCaption": "MSSP Day 1: Discovery description"}]}]}]}, {"TechniqueId": "T1045", "TechniqueName": "Software Packing", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "8.B.2", "Procedure": "python.exe payload was packed with UPX", "Criteria": "Evidence that the file python.exe is packed", "Detections": [{"DetectionNote": "A Technique detection for \"Software Packing\" was generated when python.exe was executed by PSExec.", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7457.png", "ScreenshotCaption": "Software packing tag for python.exe"}]}, {"DetectionNote": "Telemetry from automated file analysis showed python.exe was UPX packed. Detection incurred a delay based on additional data processing of python.exe to determine it was UPX packed.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Processing)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7488.png", "ScreenshotCaption": "identification of python.exe as UPX packed"}]}]}]}, {"TechniqueId": "T1050", "TechniqueName": "New Service", "Tactics": [{"TacticName": "Persistence", "TacticId": "TA0003"}], "Steps": [{"SubStep": "5.A.1", "Procedure": "Created a new service (javamtsup) that executes a service binary (javamtsup.exe) at system startup", "Criteria": "powershell.exe creating the Javamtsup service", "Detections": [{"DetectionNote": "A Technique detection for \"New Service\" was generated due to services.exe creating javamtsup. ", "DetectionType": "Technique", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7432.png", "ScreenshotCaption": "Registry creation events for javamtsup.exe tagged with New Service"}]}, {"DetectionNote": "Telemetry showed a registry event for the creation of javamtsup service.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7432.png", "ScreenshotCaption": "Registry creation events for javamtsup.exe tagged with New Service"}]}]}]}, {"TechniqueId": "T1077", "TechniqueName": "Windows Admin Shares", "Tactics": [{"TacticName": "Lateral Movement", "TacticId": "TA0008"}], "Steps": [{"SubStep": "8.C.2", "Procedure": "Established SMB session to remote host Scranton's (10.0.1.4) IPC$ share using PsExec", "Criteria": "SMB session to Scanton (10.0.1.4) over TCP port 445/135 OR evidence of usage of a Windows share", "Detections": [{"DetectionNote": "Telemetry showed an SMB session from Nashua (10.0.1.6) to Scranton (10.0.1.4) over TCP port 445.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7461.png", "ScreenshotCaption": "network connections from nashua showing PSExec connection to scranon on port 445 and connection to domain controller on port 389"}]}]}]}, {"TechniqueId": "T1065", "TechniqueName": "Uncommonly Used Port", "Tactics": [{"TacticName": "Command and Control", "TacticId": "TA0011"}], "Steps": [{"SubStep": "1.A.3", "Procedure": "Established C2 channel (192.168.0.5) via rcs.3aka3.doc payload over TCP port 1234", "Criteria": "Established network channel over port 1234", "Detections": [{"DetectionNote": "A General alert detection for \"Attack, Backdoor\" was generated when rcs.3aka3.doc connected to 192.168.0.5 on port 1234.", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7338.png", "ScreenshotCaption": "1.A.1 details of pupy execution"}]}, {"DetectionNote": "Telemetry showed the rcs.3aka.doc connected to 192.168.0.5 on port 1234.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7338.png", "ScreenshotCaption": "1.A.1 details of pupy execution"}]}]}]}, {"TechniqueId": "T1107", "TechniqueName": "File Deletion", "Tactics": [{"TacticName": "Defense Evasion", "TacticId": "TA0005"}], "Steps": [{"SubStep": "4.B.2", "Procedure": "Deleted rcs.3aka3.doc on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rcs.3aka3.doc", "Detections": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete rcs.3aka3.doc.", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7427.png", "ScreenshotCaption": "Sdelete execution for the doc file"}, {"ScreenshotName": "Symantec-APT29-7428.png", "ScreenshotCaption": "Sdelete execution for all files"}]}, {"DetectionNote": "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting rcs.3aka3.doc.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12912.png", "ScreenshotCaption": "MSSP Day 1: File Deletion name"}, {"ScreenshotName": "Symantec-APT29-12913.png", "ScreenshotCaption": "MSSP Day 1: File Deletion description"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7427.png", "ScreenshotCaption": "Sdelete execution for the doc file"}, {"ScreenshotName": "Symantec-APT29-9921.png", "ScreenshotCaption": "File deletion events for zip files and pupy payload"}, {"ScreenshotName": "Symantec-APT29-7428.png", "ScreenshotCaption": "Sdelete execution for all files"}]}]}, {"SubStep": "4.B.3", "Procedure": "Deleted Draft.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file draft.zip", "Detections": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\Draft.Zip.", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7428.png", "ScreenshotCaption": "Sdelete execution for all files"}]}, {"DetectionNote": "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting Draft.Zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12913.png", "ScreenshotCaption": "MSSP Day 1: File Deletion description"}, {"ScreenshotName": "Symantec-APT29-12912.png", "ScreenshotCaption": "MSSP Day 1: File Deletion name"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9921.png", "ScreenshotCaption": "File deletion events for zip files and pupy payload"}, {"ScreenshotName": "Symantec-APT29-7428.png", "ScreenshotCaption": "Sdelete execution for all files"}]}]}, {"SubStep": "4.B.4", "Procedure": "Deleted SysinternalsSuite.zip on disk using SDelete", "Criteria": "sdelete64.exe deleting the file SysinternalsSuite.zip", "Detections": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete SysinternalsSuite.zip.", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7428.png", "ScreenshotCaption": "Sdelete execution for all files"}]}, {"DetectionNote": "An MSSP detection for \"File Deletion\" occurred containing evidence of sdelete64.exe deleting SysinternalsSuite.zip.", "DetectionType": "MSSP", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-12913.png", "ScreenshotCaption": "MSSP Day 1: File Deletion description"}, {"ScreenshotName": "Symantec-APT29-12912.png", "ScreenshotCaption": "MSSP Day 1: File Deletion name"}]}, {"DetectionNote": "Telemetry showed sdelete.exe running with command-line arguments to delete the file and the subsequent file rename and delete events.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7428.png", "ScreenshotCaption": "Sdelete execution for all files"}, {"ScreenshotName": "Symantec-APT29-9921.png", "ScreenshotCaption": "File deletion events for zip files and pupy payload"}]}]}, {"SubStep": "9.C.1", "Procedure": "Deleted rar.exe on disk using SDelete", "Criteria": "sdelete64.exe deleting the file rar.exe", "Detections": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Rar.exe. ", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17696.png", "ScreenshotCaption": "9c1/2/3 - tactic/technique "}]}, {"DetectionNote": "Telemetry showed sdelete64.exe executing with command-line arguments to delete Rar.exe. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17696.png", "ScreenshotCaption": "9c1/2/3 - tactic/technique "}]}]}, {"SubStep": "9.C.2", "Procedure": "Deleted working.zip (from Desktop) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\Desktop\\working.zip", "Detections": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Desktop\\working.zip. ", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17696.png", "ScreenshotCaption": "9c1/2/3 - tactic/technique "}]}, {"DetectionNote": "Telemetry showed sdelete64.exe executing with command-line arguments to delete Desktop\\working.zip. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17696.png", "ScreenshotCaption": "9c1/2/3 - tactic/technique "}]}]}, {"SubStep": "9.C.3", "Procedure": "Deleted working.zip (from AppData directory) on disk using SDelete", "Criteria": "sdelete64.exe deleting the file \\AppData\\Roaming\\working.zip", "Detections": [{"DetectionNote": "A Tactic detection called \"Defense Evasion\" was generated when sdelete64.exe with command-line arguments was used to delete Roaming\\working.zip. ", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17696.png", "ScreenshotCaption": "9c1/2/3 - tactic/technique "}]}, {"DetectionNote": "Telemetry showed sdelete64.exe executing with command-line arguments to delete Roaming\\working.zip. ", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17696.png", "ScreenshotCaption": "9c1/2/3 - tactic/technique "}]}]}, {"SubStep": "9.C.4", "Procedure": "Deleted SDelete on disk using cmd.exe del command", "Criteria": "cmd.exe deleting the file sdelete64.exe", "Detections": [{"DetectionNote": "Telemetry showed cmd.exe deleting sdelete64.exe. Processing was triggered by human action and not initiated automatically.", "DetectionType": "Telemetry", "Modifiers": ["Delayed (Manual)"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17698.png", "ScreenshotCaption": "9c4 - telem - delayed"}], "Footnotes": ["The telemetry was acquired by manually initiating an export of endpoint-stored event data that was not automatically sent to the analysis system, which caused this detection to receive Delayed (Manual)."]}]}, {"SubStep": "19.A.1", "Procedure": "Deleted Mimikatz (m.exe) on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\System32\\m.exe", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.B.1", "Procedure": "Deleted exfiltrated data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration.tmp", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}, {"SubStep": "19.C.1", "Procedure": "Deleted staged data on disk using SDelete", "Criteria": "File delete event for C:\\Windows\\Temp\\WindowsParentalControlMigration\\MITRE-ATTACK-EVALS.HTML", "Detections": [{"DetectionNote": "Due to execution inconsistencies Step 19 has been omitted from the evaluation results.", "DetectionType": "N/A", "Modifiers": []}]}]}, {"TechniqueId": "T1204", "TechniqueName": "User Execution", "Tactics": [{"TacticName": "Execution", "TacticId": "TA0002"}], "Steps": [{"SubStep": "1.A.1", "Procedure": "User Pam executed payload rcs.3aka3.doc", "Criteria": "The rcs.3aka3.doc process spawning from explorer.exe", "Detections": [{"DetectionNote": "A General alert detection was generated for \"malicious file ???.cod.3aka3.scr with heuristic signature SONAR.ProcHijack!g31\".", "DetectionType": "General", "Modifiers": ["Alert"], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17516.png", "ScreenshotCaption": "1a1 - malicious file ???.cod.3aka3.scr with heuristic signature SONAR.ProcHijack!g31"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing rcs.3aka3.doc.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-7346.png", "ScreenshotCaption": "Forensics Report for rcs.3aka3.doc"}, {"ScreenshotName": "Symantec-APT29-7342.png", "ScreenshotCaption": "List of events related to rcs.3aka3.doc"}], "Footnotes": ["Vendor stated a protection capability would have blocked execution of the malicious file."]}]}, {"SubStep": "11.A.1", "Procedure": "User Oscar executed payload 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk", "Criteria": "powershell.exe spawning from explorer.exe", "Detections": [{"DetectionNote": "A Tactic detection called \"Execution\" was generated when explorer.exe executed powershell.exe.", "DetectionType": "Tactic", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-17704.png", "ScreenshotCaption": "11a1- better tactic SS"}]}, {"DetectionNote": "Telemetry showed explorer.exe executing powershell.exe.", "DetectionType": "Telemetry", "Modifiers": [], "Screenshots": [{"ScreenshotName": "Symantec-APT29-9704.png", "ScreenshotCaption": "explorer.exe launched powershell.exe with ADS reader. Shows the decoded output."}]}]}]}]}